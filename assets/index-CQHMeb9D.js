(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();function Qr(e){const t=Object.create(null);for(const s of e.split(","))t[s]=1;return s=>s in t}const ce={},ks=[],kt=()=>{},Ao=()=>!1,Vn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Gr=e=>e.startsWith("onUpdate:"),Le=Object.assign,Yr=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},Fa=Object.prototype.hasOwnProperty,oe=(e,t)=>Fa.call(e,t),Q=Array.isArray,Es=e=>an(e)==="[object Map]",Wn=e=>an(e)==="[object Set]",Mi=e=>an(e)==="[object Date]",z=e=>typeof e=="function",ye=e=>typeof e=="string",Et=e=>typeof e=="symbol",de=e=>e!==null&&typeof e=="object",To=e=>(de(e)||z(e))&&z(e.then)&&z(e.catch),Mo=Object.prototype.toString,an=e=>Mo.call(e),qa=e=>an(e).slice(8,-1),Oo=e=>an(e)==="[object Object]",zr=e=>ye(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Us=Qr(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Qn=e=>{const t=Object.create(null);return(s=>t[s]||(t[s]=e(s)))},Da=/-\w/g,Xt=Qn(e=>e.replace(Da,t=>t.slice(1).toUpperCase())),Ka=/\B([A-Z])/g,bs=Qn(e=>e.replace(Ka,"-$1").toLowerCase()),Io=Qn(e=>e.charAt(0).toUpperCase()+e.slice(1)),rr=Qn(e=>e?`on${Io(e)}`:""),Zt=(e,t)=>!Object.is(e,t),En=(e,...t)=>{for(let s=0;s<e.length;s++)e[s](...t)},$o=(e,t,s,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:s})},No=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Oi;const Gn=()=>Oi||(Oi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Zr(e){if(Q(e)){const t={};for(let s=0;s<e.length;s++){const n=e[s],r=ye(n)?Ua(n):Zr(n);if(r)for(const i in r)t[i]=r[i]}return t}else if(ye(e)||de(e))return e}const ja=/;(?![^(]*\))/g,Ba=/:([^]+)/,Ha=/\/\*[^]*?\*\//g;function Ua(e){const t={};return e.replace(Ha,"").split(ja).forEach(s=>{if(s){const n=s.split(Ba);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function cn(e){let t="";if(ye(e))t=e;else if(Q(e))for(let s=0;s<e.length;s++){const n=cn(e[s]);n&&(t+=n+" ")}else if(de(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}const Va="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Wa=Qr(Va);function Ro(e){return!!e||e===""}function Qa(e,t){if(e.length!==t.length)return!1;let s=!0;for(let n=0;s&&n<e.length;n++)s=Yn(e[n],t[n]);return s}function Yn(e,t){if(e===t)return!0;let s=Mi(e),n=Mi(t);if(s||n)return s&&n?e.getTime()===t.getTime():!1;if(s=Et(e),n=Et(t),s||n)return e===t;if(s=Q(e),n=Q(t),s||n)return s&&n?Qa(e,t):!1;if(s=de(e),n=de(t),s||n){if(!s||!n)return!1;const r=Object.keys(e).length,i=Object.keys(t).length;if(r!==i)return!1;for(const o in e){const l=e.hasOwnProperty(o),a=t.hasOwnProperty(o);if(l&&!a||!l&&a||!Yn(e[o],t[o]))return!1}}return String(e)===String(t)}function Ga(e,t){return e.findIndex(s=>Yn(s,t))}const Lo=e=>!!(e&&e.__v_isRef===!0),Ks=e=>ye(e)?e:e==null?"":Q(e)||de(e)&&(e.toString===Mo||!z(e.toString))?Lo(e)?Ks(e.value):JSON.stringify(e,Fo,2):String(e),Fo=(e,t)=>Lo(t)?Fo(e,t.value):Es(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((s,[n,r],i)=>(s[ir(n,i)+" =>"]=r,s),{})}:Wn(t)?{[`Set(${t.size})`]:[...t.values()].map(s=>ir(s))}:Et(t)?ir(t):de(t)&&!Q(t)&&!Oo(t)?String(t):t,ir=(e,t="")=>{var s;return Et(e)?`Symbol(${(s=e.description)!=null?s:t})`:e};let Ve;class Ya{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ve,!t&&Ve&&(this.index=(Ve.scopes||(Ve.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,s;if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].pause();for(t=0,s=this.effects.length;t<s;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,s;if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].resume();for(t=0,s=this.effects.length;t<s;t++)this.effects[t].resume()}}run(t){if(this._active){const s=Ve;try{return Ve=this,t()}finally{Ve=s}}}on(){++this._on===1&&(this.prevScope=Ve,Ve=this)}off(){this._on>0&&--this._on===0&&(Ve=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let s,n;for(s=0,n=this.effects.length;s<n;s++)this.effects[s].stop();for(this.effects.length=0,s=0,n=this.cleanups.length;s<n;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,n=this.scopes.length;s<n;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function za(){return Ve}let he;const or=new WeakSet;class qo{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ve&&Ve.active&&Ve.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,or.has(this)&&(or.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ko(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ii(this),jo(this);const t=he,s=mt;he=this,mt=!0;try{return this.fn()}finally{Bo(this),he=t,mt=s,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)ei(t);this.deps=this.depsTail=void 0,Ii(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?or.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Ar(this)&&this.run()}get dirty(){return Ar(this)}}let Do=0,Vs,Ws;function Ko(e,t=!1){if(e.flags|=8,t){e.next=Ws,Ws=e;return}e.next=Vs,Vs=e}function Jr(){Do++}function Xr(){if(--Do>0)return;if(Ws){let t=Ws;for(Ws=void 0;t;){const s=t.next;t.next=void 0,t.flags&=-9,t=s}}let e;for(;Vs;){let t=Vs;for(Vs=void 0;t;){const s=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=s}}if(e)throw e}function jo(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Bo(e){let t,s=e.depsTail,n=s;for(;n;){const r=n.prevDep;n.version===-1?(n===s&&(s=r),ei(n),Za(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=r}e.deps=t,e.depsTail=s}function Ar(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Ho(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Ho(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Js)||(e.globalVersion=Js,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Ar(e))))return;e.flags|=2;const t=e.dep,s=he,n=mt;he=e,mt=!0;try{jo(e);const r=e.fn(e._value);(t.version===0||Zt(r,e._value))&&(e.flags|=128,e._value=r,t.version++)}catch(r){throw t.version++,r}finally{he=s,mt=n,Bo(e),e.flags&=-3}}function ei(e,t=!1){const{dep:s,prevSub:n,nextSub:r}=e;if(n&&(n.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=n,e.nextSub=void 0),s.subs===e&&(s.subs=n,!n&&s.computed)){s.computed.flags&=-5;for(let i=s.computed.deps;i;i=i.nextDep)ei(i,!0)}!t&&!--s.sc&&s.map&&s.map.delete(s.key)}function Za(e){const{prevDep:t,nextDep:s}=e;t&&(t.nextDep=s,e.prevDep=void 0),s&&(s.prevDep=t,e.nextDep=void 0)}let mt=!0;const Uo=[];function Lt(){Uo.push(mt),mt=!1}function Ft(){const e=Uo.pop();mt=e===void 0?!0:e}function Ii(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const s=he;he=void 0;try{t()}finally{he=s}}}let Js=0;class Ja{constructor(t,s){this.sub=t,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class ti{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!he||!mt||he===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==he)s=this.activeLink=new Ja(he,this),he.deps?(s.prevDep=he.depsTail,he.depsTail.nextDep=s,he.depsTail=s):he.deps=he.depsTail=s,Vo(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const n=s.nextDep;n.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=n),s.prevDep=he.depsTail,s.nextDep=void 0,he.depsTail.nextDep=s,he.depsTail=s,he.deps===s&&(he.deps=n)}return s}trigger(t){this.version++,Js++,this.notify(t)}notify(t){Jr();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{Xr()}}}function Vo(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)Vo(n)}const s=e.dep.subs;s!==e&&(e.prevSub=s,s&&(s.nextSub=e)),e.dep.subs=e}}const Tr=new WeakMap,hs=Symbol(""),Mr=Symbol(""),Xs=Symbol("");function Ne(e,t,s){if(mt&&he){let n=Tr.get(e);n||Tr.set(e,n=new Map);let r=n.get(s);r||(n.set(s,r=new ti),r.map=n,r.key=s),r.track()}}function It(e,t,s,n,r,i){const o=Tr.get(e);if(!o){Js++;return}const l=a=>{a&&a.trigger()};if(Jr(),t==="clear")o.forEach(l);else{const a=Q(e),c=a&&zr(s);if(a&&s==="length"){const f=Number(n);o.forEach((d,h)=>{(h==="length"||h===Xs||!Et(h)&&h>=f)&&l(d)})}else switch((s!==void 0||o.has(void 0))&&l(o.get(s)),c&&l(o.get(Xs)),t){case"add":a?c&&l(o.get("length")):(l(o.get(hs)),Es(e)&&l(o.get(Mr)));break;case"delete":a||(l(o.get(hs)),Es(e)&&l(o.get(Mr)));break;case"set":Es(e)&&l(o.get(hs));break}}Xr()}function ws(e){const t=ie(e);return t===e?t:(Ne(t,"iterate",Xs),ct(e)?t:t.map(bt))}function zn(e){return Ne(e=ie(e),"iterate",Xs),e}function Wt(e,t){return qt(e)?ds(e)?As(bt(t)):As(t):bt(t)}const Xa={__proto__:null,[Symbol.iterator](){return lr(this,Symbol.iterator,e=>Wt(this,e))},concat(...e){return ws(this).concat(...e.map(t=>Q(t)?ws(t):t))},entries(){return lr(this,"entries",e=>(e[1]=Wt(this,e[1]),e))},every(e,t){return Tt(this,"every",e,t,void 0,arguments)},filter(e,t){return Tt(this,"filter",e,t,s=>s.map(n=>Wt(this,n)),arguments)},find(e,t){return Tt(this,"find",e,t,s=>Wt(this,s),arguments)},findIndex(e,t){return Tt(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Tt(this,"findLast",e,t,s=>Wt(this,s),arguments)},findLastIndex(e,t){return Tt(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Tt(this,"forEach",e,t,void 0,arguments)},includes(...e){return ar(this,"includes",e)},indexOf(...e){return ar(this,"indexOf",e)},join(e){return ws(this).join(e)},lastIndexOf(...e){return ar(this,"lastIndexOf",e)},map(e,t){return Tt(this,"map",e,t,void 0,arguments)},pop(){return Ns(this,"pop")},push(...e){return Ns(this,"push",e)},reduce(e,...t){return $i(this,"reduce",e,t)},reduceRight(e,...t){return $i(this,"reduceRight",e,t)},shift(){return Ns(this,"shift")},some(e,t){return Tt(this,"some",e,t,void 0,arguments)},splice(...e){return Ns(this,"splice",e)},toReversed(){return ws(this).toReversed()},toSorted(e){return ws(this).toSorted(e)},toSpliced(...e){return ws(this).toSpliced(...e)},unshift(...e){return Ns(this,"unshift",e)},values(){return lr(this,"values",e=>Wt(this,e))}};function lr(e,t,s){const n=zn(e),r=n[t]();return n!==e&&!ct(e)&&(r._next=r.next,r.next=()=>{const i=r._next();return i.done||(i.value=s(i.value)),i}),r}const ec=Array.prototype;function Tt(e,t,s,n,r,i){const o=zn(e),l=o!==e&&!ct(e),a=o[t];if(a!==ec[t]){const d=a.apply(e,i);return l?bt(d):d}let c=s;o!==e&&(l?c=function(d,h){return s.call(this,Wt(e,d),h,e)}:s.length>2&&(c=function(d,h){return s.call(this,d,h,e)}));const f=a.call(o,c,n);return l&&r?r(f):f}function $i(e,t,s,n){const r=zn(e);let i=s;return r!==e&&(ct(e)?s.length>3&&(i=function(o,l,a){return s.call(this,o,l,a,e)}):i=function(o,l,a){return s.call(this,o,Wt(e,l),a,e)}),r[t](i,...n)}function ar(e,t,s){const n=ie(e);Ne(n,"iterate",Xs);const r=n[t](...s);return(r===-1||r===!1)&&ri(s[0])?(s[0]=ie(s[0]),n[t](...s)):r}function Ns(e,t,s=[]){Lt(),Jr();const n=ie(e)[t].apply(e,s);return Xr(),Ft(),n}const tc=Qr("__proto__,__v_isRef,__isVue"),Wo=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Et));function sc(e){Et(e)||(e=String(e));const t=ie(this);return Ne(t,"has",e),t.hasOwnProperty(e)}class Qo{constructor(t=!1,s=!1){this._isReadonly=t,this._isShallow=s}get(t,s,n){if(s==="__v_skip")return t.__v_skip;const r=this._isReadonly,i=this._isShallow;if(s==="__v_isReactive")return!r;if(s==="__v_isReadonly")return r;if(s==="__v_isShallow")return i;if(s==="__v_raw")return n===(r?i?hc:Zo:i?zo:Yo).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const o=Q(t);if(!r){let a;if(o&&(a=Xa[s]))return a;if(s==="hasOwnProperty")return sc}const l=Reflect.get(t,s,Re(t)?t:n);if((Et(s)?Wo.has(s):tc(s))||(r||Ne(t,"get",s),i))return l;if(Re(l)){const a=o&&zr(s)?l:l.value;return r&&de(a)?Ir(a):a}return de(l)?r?Ir(l):Jt(l):l}}class Go extends Qo{constructor(t=!1){super(!1,t)}set(t,s,n,r){let i=t[s];const o=Q(t)&&zr(s);if(!this._isShallow){const c=qt(i);if(!ct(n)&&!qt(n)&&(i=ie(i),n=ie(n)),!o&&Re(i)&&!Re(n))return c||(i.value=n),!0}const l=o?Number(s)<t.length:oe(t,s),a=Reflect.set(t,s,n,Re(t)?t:r);return t===ie(r)&&(l?Zt(n,i)&&It(t,"set",s,n):It(t,"add",s,n)),a}deleteProperty(t,s){const n=oe(t,s);t[s];const r=Reflect.deleteProperty(t,s);return r&&n&&It(t,"delete",s,void 0),r}has(t,s){const n=Reflect.has(t,s);return(!Et(s)||!Wo.has(s))&&Ne(t,"has",s),n}ownKeys(t){return Ne(t,"iterate",Q(t)?"length":hs),Reflect.ownKeys(t)}}class nc extends Qo{constructor(t=!1){super(!0,t)}set(t,s){return!0}deleteProperty(t,s){return!0}}const rc=new Go,ic=new nc,oc=new Go(!0);const Or=e=>e,bn=e=>Reflect.getPrototypeOf(e);function lc(e,t,s){return function(...n){const r=this.__v_raw,i=ie(r),o=Es(i),l=e==="entries"||e===Symbol.iterator&&o,a=e==="keys"&&o,c=r[e](...n),f=s?Or:t?As:bt;return!t&&Ne(i,"iterate",a?Mr:hs),{next(){const{value:d,done:h}=c.next();return h?{value:d,done:h}:{value:l?[f(d[0]),f(d[1])]:f(d),done:h}},[Symbol.iterator](){return this}}}}function _n(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function ac(e,t){const s={get(r){const i=this.__v_raw,o=ie(i),l=ie(r);e||(Zt(r,l)&&Ne(o,"get",r),Ne(o,"get",l));const{has:a}=bn(o),c=t?Or:e?As:bt;if(a.call(o,r))return c(i.get(r));if(a.call(o,l))return c(i.get(l));i!==o&&i.get(r)},get size(){const r=this.__v_raw;return!e&&Ne(ie(r),"iterate",hs),r.size},has(r){const i=this.__v_raw,o=ie(i),l=ie(r);return e||(Zt(r,l)&&Ne(o,"has",r),Ne(o,"has",l)),r===l?i.has(r):i.has(r)||i.has(l)},forEach(r,i){const o=this,l=o.__v_raw,a=ie(l),c=t?Or:e?As:bt;return!e&&Ne(a,"iterate",hs),l.forEach((f,d)=>r.call(i,c(f),c(d),o))}};return Le(s,e?{add:_n("add"),set:_n("set"),delete:_n("delete"),clear:_n("clear")}:{add(r){!t&&!ct(r)&&!qt(r)&&(r=ie(r));const i=ie(this);return bn(i).has.call(i,r)||(i.add(r),It(i,"add",r,r)),this},set(r,i){!t&&!ct(i)&&!qt(i)&&(i=ie(i));const o=ie(this),{has:l,get:a}=bn(o);let c=l.call(o,r);c||(r=ie(r),c=l.call(o,r));const f=a.call(o,r);return o.set(r,i),c?Zt(i,f)&&It(o,"set",r,i):It(o,"add",r,i),this},delete(r){const i=ie(this),{has:o,get:l}=bn(i);let a=o.call(i,r);a||(r=ie(r),a=o.call(i,r)),l&&l.call(i,r);const c=i.delete(r);return a&&It(i,"delete",r,void 0),c},clear(){const r=ie(this),i=r.size!==0,o=r.clear();return i&&It(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{s[r]=lc(r,e,t)}),s}function si(e,t){const s=ac(e,t);return(n,r,i)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?n:Reflect.get(oe(s,r)&&r in n?s:n,r,i)}const cc={get:si(!1,!1)},fc={get:si(!1,!0)},uc={get:si(!0,!1)};const Yo=new WeakMap,zo=new WeakMap,Zo=new WeakMap,hc=new WeakMap;function dc(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function pc(e){return e.__v_skip||!Object.isExtensible(e)?0:dc(qa(e))}function Jt(e){return qt(e)?e:ni(e,!1,rc,cc,Yo)}function gc(e){return ni(e,!1,oc,fc,zo)}function Ir(e){return ni(e,!0,ic,uc,Zo)}function ni(e,t,s,n,r){if(!de(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=pc(e);if(i===0)return e;const o=r.get(e);if(o)return o;const l=new Proxy(e,i===2?n:s);return r.set(e,l),l}function ds(e){return qt(e)?ds(e.__v_raw):!!(e&&e.__v_isReactive)}function qt(e){return!!(e&&e.__v_isReadonly)}function ct(e){return!!(e&&e.__v_isShallow)}function ri(e){return e?!!e.__v_raw:!1}function ie(e){const t=e&&e.__v_raw;return t?ie(t):e}function mc(e){return!oe(e,"__v_skip")&&Object.isExtensible(e)&&$o(e,"__v_skip",!0),e}const bt=e=>de(e)?Jt(e):e,As=e=>de(e)?Ir(e):e;function Re(e){return e?e.__v_isRef===!0:!1}function Ye(e){return bc(e,!1)}function bc(e,t){return Re(e)?e:new _c(e,t)}class _c{constructor(t,s){this.dep=new ti,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?t:ie(t),this._value=s?t:bt(t),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(t){const s=this._rawValue,n=this.__v_isShallow||ct(t)||qt(t);t=n?t:ie(t),Zt(t,s)&&(this._rawValue=t,this._value=n?t:bt(t),this.dep.trigger())}}function $r(e){return Re(e)?e.value:e}const vc={get:(e,t,s)=>t==="__v_raw"?e:$r(Reflect.get(e,t,s)),set:(e,t,s,n)=>{const r=e[t];return Re(r)&&!Re(s)?(r.value=s,!0):Reflect.set(e,t,s,n)}};function Jo(e){return ds(e)?e:new Proxy(e,vc)}class yc{constructor(t,s,n){this.fn=t,this.setter=s,this._value=void 0,this.dep=new ti(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Js-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&he!==this)return Ko(this,!0),!0}get value(){const t=this.dep.track();return Ho(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function wc(e,t,s=!1){let n,r;return z(e)?n=e:(n=e.get,r=e.set),new yc(n,r,s)}const vn={},$n=new WeakMap;let fs;function Sc(e,t=!1,s=fs){if(s){let n=$n.get(s);n||$n.set(s,n=[]),n.push(e)}}function Cc(e,t,s=ce){const{immediate:n,deep:r,once:i,scheduler:o,augmentJob:l,call:a}=s,c=L=>r?L:ct(L)||r===!1||r===0?$t(L,1):$t(L);let f,d,h,g,b=!1,k=!1;if(Re(e)?(d=()=>e.value,b=ct(e)):ds(e)?(d=()=>c(e),b=!0):Q(e)?(k=!0,b=e.some(L=>ds(L)||ct(L)),d=()=>e.map(L=>{if(Re(L))return L.value;if(ds(L))return c(L);if(z(L))return a?a(L,2):L()})):z(e)?t?d=a?()=>a(e,2):e:d=()=>{if(h){Lt();try{h()}finally{Ft()}}const L=fs;fs=f;try{return a?a(e,3,[g]):e(g)}finally{fs=L}}:d=kt,t&&r){const L=d,Z=r===!0?1/0:r;d=()=>$t(L(),Z)}const R=za(),D=()=>{f.stop(),R&&R.active&&Yr(R.effects,f)};if(i&&t){const L=t;t=(...Z)=>{L(...Z),D()}}let O=k?new Array(e.length).fill(vn):vn;const G=L=>{if(!(!(f.flags&1)||!f.dirty&&!L))if(t){const Z=f.run();if(r||b||(k?Z.some((_e,te)=>Zt(_e,O[te])):Zt(Z,O))){h&&h();const _e=fs;fs=f;try{const te=[Z,O===vn?void 0:k&&O[0]===vn?[]:O,g];O=Z,a?a(t,3,te):t(...te)}finally{fs=_e}}}else f.run()};return l&&l(G),f=new qo(d),f.scheduler=o?()=>o(G,!1):G,g=L=>Sc(L,!1,f),h=f.onStop=()=>{const L=$n.get(f);if(L){if(a)a(L,4);else for(const Z of L)Z();$n.delete(f)}},t?n?G(!0):O=f.run():o?o(G.bind(null,!0),!0):f.run(),D.pause=f.pause.bind(f),D.resume=f.resume.bind(f),D.stop=D,D}function $t(e,t=1/0,s){if(t<=0||!de(e)||e.__v_skip||(s=s||new Map,(s.get(e)||0)>=t))return e;if(s.set(e,t),t--,Re(e))$t(e.value,t,s);else if(Q(e))for(let n=0;n<e.length;n++)$t(e[n],t,s);else if(Wn(e)||Es(e))e.forEach(n=>{$t(n,t,s)});else if(Oo(e)){for(const n in e)$t(e[n],t,s);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&$t(e[n],t,s)}return e}function fn(e,t,s,n){try{return n?e(...n):e()}catch(r){Zn(r,t,s)}}function xt(e,t,s,n){if(z(e)){const r=fn(e,t,s,n);return r&&To(r)&&r.catch(i=>{Zn(i,t,s)}),r}if(Q(e)){const r=[];for(let i=0;i<e.length;i++)r.push(xt(e[i],t,s,n));return r}}function Zn(e,t,s,n=!0){const r=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||ce;if(t){let l=t.parent;const a=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${s}`;for(;l;){const f=l.ec;if(f){for(let d=0;d<f.length;d++)if(f[d](e,a,c)===!1)return}l=l.parent}if(i){Lt(),fn(i,null,10,[e,a,c]),Ft();return}}kc(e,s,r,n,o)}function kc(e,t,s,n=!0,r=!1){if(r)throw e;console.error(e)}const je=[];let wt=-1;const xs=[];let Qt=null,Ss=0;const Xo=Promise.resolve();let Nn=null;function ii(e){const t=Nn||Xo;return e?t.then(this?e.bind(this):e):t}function Ec(e){let t=wt+1,s=je.length;for(;t<s;){const n=t+s>>>1,r=je[n],i=en(r);i<e||i===e&&r.flags&2?t=n+1:s=n}return t}function oi(e){if(!(e.flags&1)){const t=en(e),s=je[je.length-1];!s||!(e.flags&2)&&t>=en(s)?je.push(e):je.splice(Ec(t),0,e),e.flags|=1,el()}}function el(){Nn||(Nn=Xo.then(sl))}function xc(e){Q(e)?xs.push(...e):Qt&&e.id===-1?Qt.splice(Ss+1,0,e):e.flags&1||(xs.push(e),e.flags|=1),el()}function Ni(e,t,s=wt+1){for(;s<je.length;s++){const n=je[s];if(n&&n.flags&2){if(e&&n.id!==e.uid)continue;je.splice(s,1),s--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function tl(e){if(xs.length){const t=[...new Set(xs)].sort((s,n)=>en(s)-en(n));if(xs.length=0,Qt){Qt.push(...t);return}for(Qt=t,Ss=0;Ss<Qt.length;Ss++){const s=Qt[Ss];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}Qt=null,Ss=0}}const en=e=>e.id==null?e.flags&2?-1:1/0:e.id;function sl(e){try{for(wt=0;wt<je.length;wt++){const t=je[wt];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),fn(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;wt<je.length;wt++){const t=je[wt];t&&(t.flags&=-2)}wt=-1,je.length=0,tl(),Nn=null,(je.length||xs.length)&&sl()}}let at=null,nl=null;function Rn(e){const t=at;return at=e,nl=e&&e.type.__scopeId||null,t}function Pc(e,t=at,s){if(!t||e._n)return e;const n=(...r)=>{n._d&&Vi(-1);const i=Rn(t);let o;try{o=e(...r)}finally{Rn(i),n._d&&Vi(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function Ri(e,t){if(at===null)return e;const s=tr(at),n=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[i,o,l,a=ce]=t[r];i&&(z(i)&&(i={mounted:i,updated:i}),i.deep&&$t(o),n.push({dir:i,instance:s,value:o,oldValue:void 0,arg:l,modifiers:a}))}return e}function ls(e,t,s,n){const r=e.dirs,i=t&&t.dirs;for(let o=0;o<r.length;o++){const l=r[o];i&&(l.oldValue=i[o].value);let a=l.dir[n];a&&(Lt(),xt(a,s,8,[e.el,l,e,t]),Ft())}}const Ac=Symbol("_vte"),Tc=e=>e.__isTeleport,Mc=Symbol("_leaveCb");function li(e,t){e.shapeFlag&6&&e.component?(e.transition=t,li(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function rl(e,t){return z(e)?Le({name:e.name},t,{setup:e}):e}function il(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Ln=new WeakMap;function Qs(e,t,s,n,r=!1){if(Q(e)){e.forEach((b,k)=>Qs(b,t&&(Q(t)?t[k]:t),s,n,r));return}if(Gs(n)&&!r){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Qs(e,t,s,n.component.subTree);return}const i=n.shapeFlag&4?tr(n.component):n.el,o=r?null:i,{i:l,r:a}=e,c=t&&t.r,f=l.refs===ce?l.refs={}:l.refs,d=l.setupState,h=ie(d),g=d===ce?Ao:b=>oe(h,b);if(c!=null&&c!==a){if(Li(t),ye(c))f[c]=null,g(c)&&(d[c]=null);else if(Re(c)){c.value=null;const b=t;b.k&&(f[b.k]=null)}}if(z(a))fn(a,l,12,[o,f]);else{const b=ye(a),k=Re(a);if(b||k){const R=()=>{if(e.f){const D=b?g(a)?d[a]:f[a]:a.value;if(r)Q(D)&&Yr(D,i);else if(Q(D))D.includes(i)||D.push(i);else if(b)f[a]=[i],g(a)&&(d[a]=f[a]);else{const O=[i];a.value=O,e.k&&(f[e.k]=O)}}else b?(f[a]=o,g(a)&&(d[a]=o)):k&&(a.value=o,e.k&&(f[e.k]=o))};if(o){const D=()=>{R(),Ln.delete(e)};D.id=-1,Ln.set(e,D),Ze(D,s)}else Li(e),R()}}}function Li(e){const t=Ln.get(e);t&&(t.flags|=8,Ln.delete(e))}Gn().requestIdleCallback;Gn().cancelIdleCallback;const Gs=e=>!!e.type.__asyncLoader,ol=e=>e.type.__isKeepAlive;function Oc(e,t){ll(e,"a",t)}function Ic(e,t){ll(e,"da",t)}function ll(e,t,s=Be){const n=e.__wdc||(e.__wdc=()=>{let r=s;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(Jn(t,n,s),s){let r=s.parent;for(;r&&r.parent;)ol(r.parent.vnode)&&$c(n,t,s,r),r=r.parent}}function $c(e,t,s,n){const r=Jn(t,e,n,!0);cl(()=>{Yr(n[t],r)},s)}function Jn(e,t,s=Be,n=!1){if(s){const r=s[e]||(s[e]=[]),i=t.__weh||(t.__weh=(...o)=>{Lt();const l=un(s),a=xt(t,s,e,o);return l(),Ft(),a});return n?r.unshift(i):r.push(i),i}}const Dt=e=>(t,s=Be)=>{(!sn||e==="sp")&&Jn(e,(...n)=>t(...n),s)},Nc=Dt("bm"),al=Dt("m"),Rc=Dt("bu"),Lc=Dt("u"),Fc=Dt("bum"),cl=Dt("um"),qc=Dt("sp"),Dc=Dt("rtg"),Kc=Dt("rtc");function jc(e,t=Be){Jn("ec",e,t)}const Bc=Symbol.for("v-ndc");function fl(e,t,s,n){let r;const i=s,o=Q(e);if(o||ye(e)){const l=o&&ds(e);let a=!1,c=!1;l&&(a=!ct(e),c=qt(e),e=zn(e)),r=new Array(e.length);for(let f=0,d=e.length;f<d;f++)r[f]=t(a?c?As(bt(e[f])):bt(e[f]):e[f],f,void 0,i)}else if(typeof e=="number"){r=new Array(e);for(let l=0;l<e;l++)r[l]=t(l+1,l,void 0,i)}else if(de(e))if(e[Symbol.iterator])r=Array.from(e,(l,a)=>t(l,a,void 0,i));else{const l=Object.keys(e);r=new Array(l.length);for(let a=0,c=l.length;a<c;a++){const f=l[a];r[a]=t(e[f],f,a,i)}}else r=[];return r}const Nr=e=>e?Ol(e)?tr(e):Nr(e.parent):null,Ys=Le(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Nr(e.parent),$root:e=>Nr(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>hl(e),$forceUpdate:e=>e.f||(e.f=()=>{oi(e.update)}),$nextTick:e=>e.n||(e.n=ii.bind(e.proxy)),$watch:e=>ef.bind(e)}),cr=(e,t)=>e!==ce&&!e.__isScriptSetup&&oe(e,t),Hc={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:s,setupState:n,data:r,props:i,accessCache:o,type:l,appContext:a}=e;if(t[0]!=="$"){const h=o[t];if(h!==void 0)switch(h){case 1:return n[t];case 2:return r[t];case 4:return s[t];case 3:return i[t]}else{if(cr(n,t))return o[t]=1,n[t];if(r!==ce&&oe(r,t))return o[t]=2,r[t];if(oe(i,t))return o[t]=3,i[t];if(s!==ce&&oe(s,t))return o[t]=4,s[t];Rr&&(o[t]=0)}}const c=Ys[t];let f,d;if(c)return t==="$attrs"&&Ne(e.attrs,"get",""),c(e);if((f=l.__cssModules)&&(f=f[t]))return f;if(s!==ce&&oe(s,t))return o[t]=4,s[t];if(d=a.config.globalProperties,oe(d,t))return d[t]},set({_:e},t,s){const{data:n,setupState:r,ctx:i}=e;return cr(r,t)?(r[t]=s,!0):n!==ce&&oe(n,t)?(n[t]=s,!0):oe(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=s,!0)},has({_:{data:e,setupState:t,accessCache:s,ctx:n,appContext:r,props:i,type:o}},l){let a;return!!(s[l]||e!==ce&&l[0]!=="$"&&oe(e,l)||cr(t,l)||oe(i,l)||oe(n,l)||oe(Ys,l)||oe(r.config.globalProperties,l)||(a=o.__cssModules)&&a[l])},defineProperty(e,t,s){return s.get!=null?e._.accessCache[t]=0:oe(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};function Fi(e){return Q(e)?e.reduce((t,s)=>(t[s]=null,t),{}):e}let Rr=!0;function Uc(e){const t=hl(e),s=e.proxy,n=e.ctx;Rr=!1,t.beforeCreate&&qi(t.beforeCreate,e,"bc");const{data:r,computed:i,methods:o,watch:l,provide:a,inject:c,created:f,beforeMount:d,mounted:h,beforeUpdate:g,updated:b,activated:k,deactivated:R,beforeDestroy:D,beforeUnmount:O,destroyed:G,unmounted:L,render:Z,renderTracked:_e,renderTriggered:te,errorCaptured:J,serverPrefetch:Ae,expose:fe,inheritAttrs:me,components:Ue,directives:Kt,filters:Pt}=t;if(c&&Vc(c,n,null),o)for(const ae in o){const se=o[ae];z(se)&&(n[ae]=se.bind(s))}if(r){const ae=r.call(s,s);de(ae)&&(e.data=Jt(ae))}if(Rr=!0,i)for(const ae in i){const se=i[ae],ut=z(se)?se.bind(s,s):z(se.get)?se.get.bind(s,s):kt,At=!z(se)&&z(se.set)?se.set.bind(s):kt,et=An({get:ut,set:At});Object.defineProperty(n,ae,{enumerable:!0,configurable:!0,get:()=>et.value,set:Fe=>et.value=Fe})}if(l)for(const ae in l)ul(l[ae],n,s,ae);if(a){const ae=z(a)?a.call(s):a;Reflect.ownKeys(ae).forEach(se=>{Zc(se,ae[se])})}f&&qi(f,e,"c");function be(ae,se){Q(se)?se.forEach(ut=>ae(ut.bind(s))):se&&ae(se.bind(s))}if(be(Nc,d),be(al,h),be(Rc,g),be(Lc,b),be(Oc,k),be(Ic,R),be(jc,J),be(Kc,_e),be(Dc,te),be(Fc,O),be(cl,L),be(qc,Ae),Q(fe))if(fe.length){const ae=e.exposed||(e.exposed={});fe.forEach(se=>{Object.defineProperty(ae,se,{get:()=>s[se],set:ut=>s[se]=ut,enumerable:!0})})}else e.exposed||(e.exposed={});Z&&e.render===kt&&(e.render=Z),me!=null&&(e.inheritAttrs=me),Ue&&(e.components=Ue),Kt&&(e.directives=Kt),Ae&&il(e)}function Vc(e,t,s=kt){Q(e)&&(e=Lr(e));for(const n in e){const r=e[n];let i;de(r)?"default"in r?i=xn(r.from||n,r.default,!0):i=xn(r.from||n):i=xn(r),Re(i)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):t[n]=i}}function qi(e,t,s){xt(Q(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,s)}function ul(e,t,s,n){let r=n.includes(".")?gl(s,n):()=>s[n];if(ye(e)){const i=t[e];z(i)&&zs(r,i)}else if(z(e))zs(r,e.bind(s));else if(de(e))if(Q(e))e.forEach(i=>ul(i,t,s,n));else{const i=z(e.handler)?e.handler.bind(s):t[e.handler];z(i)&&zs(r,i,e)}}function hl(e){const t=e.type,{mixins:s,extends:n}=t,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=e.appContext,l=i.get(t);let a;return l?a=l:!r.length&&!s&&!n?a=t:(a={},r.length&&r.forEach(c=>Fn(a,c,o,!0)),Fn(a,t,o)),de(t)&&i.set(t,a),a}function Fn(e,t,s,n=!1){const{mixins:r,extends:i}=t;i&&Fn(e,i,s,!0),r&&r.forEach(o=>Fn(e,o,s,!0));for(const o in t)if(!(n&&o==="expose")){const l=Wc[o]||s&&s[o];e[o]=l?l(e[o],t[o]):t[o]}return e}const Wc={data:Di,props:Ki,emits:Ki,methods:js,computed:js,beforeCreate:Ke,created:Ke,beforeMount:Ke,mounted:Ke,beforeUpdate:Ke,updated:Ke,beforeDestroy:Ke,beforeUnmount:Ke,destroyed:Ke,unmounted:Ke,activated:Ke,deactivated:Ke,errorCaptured:Ke,serverPrefetch:Ke,components:js,directives:js,watch:Gc,provide:Di,inject:Qc};function Di(e,t){return t?e?function(){return Le(z(e)?e.call(this,this):e,z(t)?t.call(this,this):t)}:t:e}function Qc(e,t){return js(Lr(e),Lr(t))}function Lr(e){if(Q(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function Ke(e,t){return e?[...new Set([].concat(e,t))]:t}function js(e,t){return e?Le(Object.create(null),e,t):t}function Ki(e,t){return e?Q(e)&&Q(t)?[...new Set([...e,...t])]:Le(Object.create(null),Fi(e),Fi(t??{})):t}function Gc(e,t){if(!e)return t;if(!t)return e;const s=Le(Object.create(null),e);for(const n in t)s[n]=Ke(e[n],t[n]);return s}function dl(){return{app:null,config:{isNativeTag:Ao,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Yc=0;function zc(e,t){return function(n,r=null){z(n)||(n=Le({},n)),r!=null&&!de(r)&&(r=null);const i=dl(),o=new WeakSet,l=[];let a=!1;const c=i.app={_uid:Yc++,_component:n,_props:r,_container:null,_context:i,_instance:null,version:Nf,get config(){return i.config},set config(f){},use(f,...d){return o.has(f)||(f&&z(f.install)?(o.add(f),f.install(c,...d)):z(f)&&(o.add(f),f(c,...d))),c},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),c},component(f,d){return d?(i.components[f]=d,c):i.components[f]},directive(f,d){return d?(i.directives[f]=d,c):i.directives[f]},mount(f,d,h){if(!a){const g=c._ceVNode||Rt(n,r);return g.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),e(g,f,h),a=!0,c._container=f,f.__vue_app__=c,tr(g.component)}},onUnmount(f){l.push(f)},unmount(){a&&(xt(l,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(f,d){return i.provides[f]=d,c},runWithContext(f){const d=Ps;Ps=c;try{return f()}finally{Ps=d}}};return c}}let Ps=null;function Zc(e,t){if(Be){let s=Be.provides;const n=Be.parent&&Be.parent.provides;n===s&&(s=Be.provides=Object.create(n)),s[e]=t}}function xn(e,t,s=!1){const n=Af();if(n||Ps){let r=Ps?Ps._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(r&&e in r)return r[e];if(arguments.length>1)return s&&z(t)?t.call(n&&n.proxy):t}}const Jc=Symbol.for("v-scx"),Xc=()=>xn(Jc);function zs(e,t,s){return pl(e,t,s)}function pl(e,t,s=ce){const{immediate:n,deep:r,flush:i,once:o}=s,l=Le({},s),a=t&&n||!t&&i!=="post";let c;if(sn){if(i==="sync"){const g=Xc();c=g.__watcherHandles||(g.__watcherHandles=[])}else if(!a){const g=()=>{};return g.stop=kt,g.resume=kt,g.pause=kt,g}}const f=Be;l.call=(g,b,k)=>xt(g,f,b,k);let d=!1;i==="post"?l.scheduler=g=>{Ze(g,f&&f.suspense)}:i!=="sync"&&(d=!0,l.scheduler=(g,b)=>{b?g():oi(g)}),l.augmentJob=g=>{t&&(g.flags|=4),d&&(g.flags|=2,f&&(g.id=f.uid,g.i=f))};const h=Cc(e,t,l);return sn&&(c?c.push(h):a&&h()),h}function ef(e,t,s){const n=this.proxy,r=ye(e)?e.includes(".")?gl(n,e):()=>n[e]:e.bind(n,n);let i;z(t)?i=t:(i=t.handler,s=t);const o=un(this),l=pl(r,i.bind(n),s);return o(),l}function gl(e,t){const s=t.split(".");return()=>{let n=e;for(let r=0;r<s.length&&n;r++)n=n[s[r]];return n}}const tf=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Xt(t)}Modifiers`]||e[`${bs(t)}Modifiers`];function sf(e,t,...s){if(e.isUnmounted)return;const n=e.vnode.props||ce;let r=s;const i=t.startsWith("update:"),o=i&&tf(n,t.slice(7));o&&(o.trim&&(r=s.map(f=>ye(f)?f.trim():f)),o.number&&(r=s.map(No)));let l,a=n[l=rr(t)]||n[l=rr(Xt(t))];!a&&i&&(a=n[l=rr(bs(t))]),a&&xt(a,e,6,r);const c=n[l+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,xt(c,e,6,r)}}const nf=new WeakMap;function ml(e,t,s=!1){const n=s?nf:t.emitsCache,r=n.get(e);if(r!==void 0)return r;const i=e.emits;let o={},l=!1;if(!z(e)){const a=c=>{const f=ml(c,t,!0);f&&(l=!0,Le(o,f))};!s&&t.mixins.length&&t.mixins.forEach(a),e.extends&&a(e.extends),e.mixins&&e.mixins.forEach(a)}return!i&&!l?(de(e)&&n.set(e,null),null):(Q(i)?i.forEach(a=>o[a]=null):Le(o,i),de(e)&&n.set(e,o),o)}function Xn(e,t){return!e||!Vn(t)?!1:(t=t.slice(2).replace(/Once$/,""),oe(e,t[0].toLowerCase()+t.slice(1))||oe(e,bs(t))||oe(e,t))}function ji(e){const{type:t,vnode:s,proxy:n,withProxy:r,propsOptions:[i],slots:o,attrs:l,emit:a,render:c,renderCache:f,props:d,data:h,setupState:g,ctx:b,inheritAttrs:k}=e,R=Rn(e);let D,O;try{if(s.shapeFlag&4){const L=r||n,Z=L;D=Ct(c.call(Z,L,f,d,g,h,b)),O=l}else{const L=t;D=Ct(L.length>1?L(d,{attrs:l,slots:o,emit:a}):L(d,null)),O=t.props?l:rf(l)}}catch(L){Zs.length=0,Zn(L,e,1),D=Rt(es)}let G=D;if(O&&k!==!1){const L=Object.keys(O),{shapeFlag:Z}=G;L.length&&Z&7&&(i&&L.some(Gr)&&(O=of(O,i)),G=Ts(G,O,!1,!0))}return s.dirs&&(G=Ts(G,null,!1,!0),G.dirs=G.dirs?G.dirs.concat(s.dirs):s.dirs),s.transition&&li(G,s.transition),D=G,Rn(R),D}const rf=e=>{let t;for(const s in e)(s==="class"||s==="style"||Vn(s))&&((t||(t={}))[s]=e[s]);return t},of=(e,t)=>{const s={};for(const n in e)(!Gr(n)||!(n.slice(9)in t))&&(s[n]=e[n]);return s};function lf(e,t,s){const{props:n,children:r,component:i}=e,{props:o,children:l,patchFlag:a}=t,c=i.emitsOptions;if(t.dirs||t.transition)return!0;if(s&&a>=0){if(a&1024)return!0;if(a&16)return n?Bi(n,o,c):!!o;if(a&8){const f=t.dynamicProps;for(let d=0;d<f.length;d++){const h=f[d];if(o[h]!==n[h]&&!Xn(c,h))return!0}}}else return(r||l)&&(!l||!l.$stable)?!0:n===o?!1:n?o?Bi(n,o,c):!0:!!o;return!1}function Bi(e,t,s){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let r=0;r<n.length;r++){const i=n[r];if(t[i]!==e[i]&&!Xn(s,i))return!0}return!1}function af({vnode:e,parent:t},s){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n===e)(e=t.vnode).el=s,t=t.parent;else break}}const bl={},_l=()=>Object.create(bl),vl=e=>Object.getPrototypeOf(e)===bl;function cf(e,t,s,n=!1){const r={},i=_l();e.propsDefaults=Object.create(null),yl(e,t,r,i);for(const o in e.propsOptions[0])o in r||(r[o]=void 0);s?e.props=n?r:gc(r):e.type.props?e.props=r:e.props=i,e.attrs=i}function ff(e,t,s,n){const{props:r,attrs:i,vnode:{patchFlag:o}}=e,l=ie(r),[a]=e.propsOptions;let c=!1;if((n||o>0)&&!(o&16)){if(o&8){const f=e.vnode.dynamicProps;for(let d=0;d<f.length;d++){let h=f[d];if(Xn(e.emitsOptions,h))continue;const g=t[h];if(a)if(oe(i,h))g!==i[h]&&(i[h]=g,c=!0);else{const b=Xt(h);r[b]=Fr(a,l,b,g,e,!1)}else g!==i[h]&&(i[h]=g,c=!0)}}}else{yl(e,t,r,i)&&(c=!0);let f;for(const d in l)(!t||!oe(t,d)&&((f=bs(d))===d||!oe(t,f)))&&(a?s&&(s[d]!==void 0||s[f]!==void 0)&&(r[d]=Fr(a,l,d,void 0,e,!0)):delete r[d]);if(i!==l)for(const d in i)(!t||!oe(t,d))&&(delete i[d],c=!0)}c&&It(e.attrs,"set","")}function yl(e,t,s,n){const[r,i]=e.propsOptions;let o=!1,l;if(t)for(let a in t){if(Us(a))continue;const c=t[a];let f;r&&oe(r,f=Xt(a))?!i||!i.includes(f)?s[f]=c:(l||(l={}))[f]=c:Xn(e.emitsOptions,a)||(!(a in n)||c!==n[a])&&(n[a]=c,o=!0)}if(i){const a=ie(s),c=l||ce;for(let f=0;f<i.length;f++){const d=i[f];s[d]=Fr(r,a,d,c[d],e,!oe(c,d))}}return o}function Fr(e,t,s,n,r,i){const o=e[s];if(o!=null){const l=oe(o,"default");if(l&&n===void 0){const a=o.default;if(o.type!==Function&&!o.skipFactory&&z(a)){const{propsDefaults:c}=r;if(s in c)n=c[s];else{const f=un(r);n=c[s]=a.call(null,t),f()}}else n=a;r.ce&&r.ce._setProp(s,n)}o[0]&&(i&&!l?n=!1:o[1]&&(n===""||n===bs(s))&&(n=!0))}return n}const uf=new WeakMap;function wl(e,t,s=!1){const n=s?uf:t.propsCache,r=n.get(e);if(r)return r;const i=e.props,o={},l=[];let a=!1;if(!z(e)){const f=d=>{a=!0;const[h,g]=wl(d,t,!0);Le(o,h),g&&l.push(...g)};!s&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!i&&!a)return de(e)&&n.set(e,ks),ks;if(Q(i))for(let f=0;f<i.length;f++){const d=Xt(i[f]);Hi(d)&&(o[d]=ce)}else if(i)for(const f in i){const d=Xt(f);if(Hi(d)){const h=i[f],g=o[d]=Q(h)||z(h)?{type:h}:Le({},h),b=g.type;let k=!1,R=!0;if(Q(b))for(let D=0;D<b.length;++D){const O=b[D],G=z(O)&&O.name;if(G==="Boolean"){k=!0;break}else G==="String"&&(R=!1)}else k=z(b)&&b.name==="Boolean";g[0]=k,g[1]=R,(k||oe(g,"default"))&&l.push(d)}}const c=[o,l];return de(e)&&n.set(e,c),c}function Hi(e){return e[0]!=="$"&&!Us(e)}const ai=e=>e==="_"||e==="_ctx"||e==="$stable",ci=e=>Q(e)?e.map(Ct):[Ct(e)],hf=(e,t,s)=>{if(t._n)return t;const n=Pc((...r)=>ci(t(...r)),s);return n._c=!1,n},Sl=(e,t,s)=>{const n=e._ctx;for(const r in e){if(ai(r))continue;const i=e[r];if(z(i))t[r]=hf(r,i,n);else if(i!=null){const o=ci(i);t[r]=()=>o}}},Cl=(e,t)=>{const s=ci(t);e.slots.default=()=>s},kl=(e,t,s)=>{for(const n in t)(s||!ai(n))&&(e[n]=t[n])},df=(e,t,s)=>{const n=e.slots=_l();if(e.vnode.shapeFlag&32){const r=t._;r?(kl(n,t,s),s&&$o(n,"_",r,!0)):Sl(t,n)}else t&&Cl(e,t)},pf=(e,t,s)=>{const{vnode:n,slots:r}=e;let i=!0,o=ce;if(n.shapeFlag&32){const l=t._;l?s&&l===1?i=!1:kl(r,t,s):(i=!t.$stable,Sl(t,r)),o=t}else t&&(Cl(e,t),o={default:1});if(i)for(const l in r)!ai(l)&&o[l]==null&&delete r[l]},Ze=vf;function gf(e){return mf(e)}function mf(e,t){const s=Gn();s.__VUE__=!0;const{insert:n,remove:r,patchProp:i,createElement:o,createText:l,createComment:a,setText:c,setElementText:f,parentNode:d,nextSibling:h,setScopeId:g=kt,insertStaticContent:b}=e,k=(u,p,_,v=null,w=null,E=null,T=void 0,P=null,A=!!p.dynamicChildren)=>{if(u===p)return;u&&!Rs(u,p)&&(v=dt(u),Fe(u,w,E,!0),u=null),p.patchFlag===-2&&(A=!1,p.dynamicChildren=null);const{type:x,ref:F,shapeFlag:M}=p;switch(x){case er:R(u,p,_,v);break;case es:D(u,p,_,v);break;case ur:u==null&&O(p,_,v,T);break;case gt:Ue(u,p,_,v,w,E,T,P,A);break;default:M&1?Z(u,p,_,v,w,E,T,P,A):M&6?Kt(u,p,_,v,w,E,T,P,A):(M&64||M&128)&&x.process(u,p,_,v,w,E,T,P,A,j)}F!=null&&w?Qs(F,u&&u.ref,E,p||u,!p):F==null&&u&&u.ref!=null&&Qs(u.ref,null,E,u,!0)},R=(u,p,_,v)=>{if(u==null)n(p.el=l(p.children),_,v);else{const w=p.el=u.el;p.children!==u.children&&c(w,p.children)}},D=(u,p,_,v)=>{u==null?n(p.el=a(p.children||""),_,v):p.el=u.el},O=(u,p,_,v)=>{[u.el,u.anchor]=b(u.children,p,_,v,u.el,u.anchor)},G=({el:u,anchor:p},_,v)=>{let w;for(;u&&u!==p;)w=h(u),n(u,_,v),u=w;n(p,_,v)},L=({el:u,anchor:p})=>{let _;for(;u&&u!==p;)_=h(u),r(u),u=_;r(p)},Z=(u,p,_,v,w,E,T,P,A)=>{if(p.type==="svg"?T="svg":p.type==="math"&&(T="mathml"),u==null)_e(p,_,v,w,E,T,P,A);else{const x=u.el&&u.el._isVueCE?u.el:null;try{x&&x._beginPatch(),Ae(u,p,w,E,T,P,A)}finally{x&&x._endPatch()}}},_e=(u,p,_,v,w,E,T,P)=>{let A,x;const{props:F,shapeFlag:M,transition:q,dirs:H}=u;if(A=u.el=o(u.type,E,F&&F.is,F),M&8?f(A,u.children):M&16&&J(u.children,A,null,v,w,fr(u,E),T,P),H&&ls(u,null,v,"created"),te(A,u,u.scopeId,T,v),F){for(const ne in F)ne!=="value"&&!Us(ne)&&i(A,ne,null,F[ne],E,v);"value"in F&&i(A,"value",null,F.value,E),(x=F.onVnodeBeforeMount)&&yt(x,v,u)}H&&ls(u,null,v,"beforeMount");const ee=bf(w,q);ee&&q.beforeEnter(A),n(A,p,_),((x=F&&F.onVnodeMounted)||ee||H)&&Ze(()=>{x&&yt(x,v,u),ee&&q.enter(A),H&&ls(u,null,v,"mounted")},w)},te=(u,p,_,v,w)=>{if(_&&g(u,_),v)for(let E=0;E<v.length;E++)g(u,v[E]);if(w){let E=w.subTree;if(p===E||Pl(E.type)&&(E.ssContent===p||E.ssFallback===p)){const T=w.vnode;te(u,T,T.scopeId,T.slotScopeIds,w.parent)}}},J=(u,p,_,v,w,E,T,P,A=0)=>{for(let x=A;x<u.length;x++){const F=u[x]=P?Gt(u[x]):Ct(u[x]);k(null,F,p,_,v,w,E,T,P)}},Ae=(u,p,_,v,w,E,T)=>{const P=p.el=u.el;let{patchFlag:A,dynamicChildren:x,dirs:F}=p;A|=u.patchFlag&16;const M=u.props||ce,q=p.props||ce;let H;if(_&&as(_,!1),(H=q.onVnodeBeforeUpdate)&&yt(H,_,p,u),F&&ls(p,u,_,"beforeUpdate"),_&&as(_,!0),(M.innerHTML&&q.innerHTML==null||M.textContent&&q.textContent==null)&&f(P,""),x?fe(u.dynamicChildren,x,P,_,v,fr(p,w),E):T||se(u,p,P,null,_,v,fr(p,w),E,!1),A>0){if(A&16)me(P,M,q,_,w);else if(A&2&&M.class!==q.class&&i(P,"class",null,q.class,w),A&4&&i(P,"style",M.style,q.style,w),A&8){const ee=p.dynamicProps;for(let ne=0;ne<ee.length;ne++){const re=ee[ne],Te=M[re],Me=q[re];(Me!==Te||re==="value")&&i(P,re,Te,Me,w,_)}}A&1&&u.children!==p.children&&f(P,p.children)}else!T&&x==null&&me(P,M,q,_,w);((H=q.onVnodeUpdated)||F)&&Ze(()=>{H&&yt(H,_,p,u),F&&ls(p,u,_,"updated")},v)},fe=(u,p,_,v,w,E,T)=>{for(let P=0;P<p.length;P++){const A=u[P],x=p[P],F=A.el&&(A.type===gt||!Rs(A,x)||A.shapeFlag&198)?d(A.el):_;k(A,x,F,null,v,w,E,T,!0)}},me=(u,p,_,v,w)=>{if(p!==_){if(p!==ce)for(const E in p)!Us(E)&&!(E in _)&&i(u,E,p[E],null,w,v);for(const E in _){if(Us(E))continue;const T=_[E],P=p[E];T!==P&&E!=="value"&&i(u,E,P,T,w,v)}"value"in _&&i(u,"value",p.value,_.value,w)}},Ue=(u,p,_,v,w,E,T,P,A)=>{const x=p.el=u?u.el:l(""),F=p.anchor=u?u.anchor:l("");let{patchFlag:M,dynamicChildren:q,slotScopeIds:H}=p;H&&(P=P?P.concat(H):H),u==null?(n(x,_,v),n(F,_,v),J(p.children||[],_,F,w,E,T,P,A)):M>0&&M&64&&q&&u.dynamicChildren?(fe(u.dynamicChildren,q,_,w,E,T,P),(p.key!=null||w&&p===w.subTree)&&El(u,p,!0)):se(u,p,_,F,w,E,T,P,A)},Kt=(u,p,_,v,w,E,T,P,A)=>{p.slotScopeIds=P,u==null?p.shapeFlag&512?w.ctx.activate(p,_,v,T,A):Pt(p,_,v,w,E,T,A):ns(u,p,A)},Pt=(u,p,_,v,w,E,T)=>{const P=u.component=Pf(u,v,w);if(ol(u)&&(P.ctx.renderer=j),Tf(P,!1,T),P.asyncDep){if(w&&w.registerDep(P,be,T),!u.el){const A=P.subTree=Rt(es);D(null,A,p,_),u.placeholder=A.el}}else be(P,u,p,_,w,E,T)},ns=(u,p,_)=>{const v=p.component=u.component;if(lf(u,p,_))if(v.asyncDep&&!v.asyncResolved){ae(v,p,_);return}else v.next=p,v.update();else p.el=u.el,v.vnode=p},be=(u,p,_,v,w,E,T)=>{const P=()=>{if(u.isMounted){let{next:M,bu:q,u:H,parent:ee,vnode:ne}=u;{const st=xl(u);if(st){M&&(M.el=ne.el,ae(u,M,T)),st.asyncDep.then(()=>{u.isUnmounted||P()});return}}let re=M,Te;as(u,!1),M?(M.el=ne.el,ae(u,M,T)):M=ne,q&&En(q),(Te=M.props&&M.props.onVnodeBeforeUpdate)&&yt(Te,ee,M,ne),as(u,!0);const Me=ji(u),tt=u.subTree;u.subTree=Me,k(tt,Me,d(tt.el),dt(tt),u,w,E),M.el=Me.el,re===null&&af(u,Me.el),H&&Ze(H,w),(Te=M.props&&M.props.onVnodeUpdated)&&Ze(()=>yt(Te,ee,M,ne),w)}else{let M;const{el:q,props:H}=p,{bm:ee,m:ne,parent:re,root:Te,type:Me}=u,tt=Gs(p);as(u,!1),ee&&En(ee),!tt&&(M=H&&H.onVnodeBeforeMount)&&yt(M,re,p),as(u,!0);{Te.ce&&Te.ce._def.shadowRoot!==!1&&Te.ce._injectChildStyle(Me);const st=u.subTree=ji(u);k(null,st,_,v,u,w,E),p.el=st.el}if(ne&&Ze(ne,w),!tt&&(M=H&&H.onVnodeMounted)){const st=p;Ze(()=>yt(M,re,st),w)}(p.shapeFlag&256||re&&Gs(re.vnode)&&re.vnode.shapeFlag&256)&&u.a&&Ze(u.a,w),u.isMounted=!0,p=_=v=null}};u.scope.on();const A=u.effect=new qo(P);u.scope.off();const x=u.update=A.run.bind(A),F=u.job=A.runIfDirty.bind(A);F.i=u,F.id=u.uid,A.scheduler=()=>oi(F),as(u,!0),x()},ae=(u,p,_)=>{p.component=u;const v=u.vnode.props;u.vnode=p,u.next=null,ff(u,p.props,v,_),pf(u,p.children,_),Lt(),Ni(u),Ft()},se=(u,p,_,v,w,E,T,P,A=!1)=>{const x=u&&u.children,F=u?u.shapeFlag:0,M=p.children,{patchFlag:q,shapeFlag:H}=p;if(q>0){if(q&128){At(x,M,_,v,w,E,T,P,A);return}else if(q&256){ut(x,M,_,v,w,E,T,P,A);return}}H&8?(F&16&&_t(x,w,E),M!==x&&f(_,M)):F&16?H&16?At(x,M,_,v,w,E,T,P,A):_t(x,w,E,!0):(F&8&&f(_,""),H&16&&J(M,_,v,w,E,T,P,A))},ut=(u,p,_,v,w,E,T,P,A)=>{u=u||ks,p=p||ks;const x=u.length,F=p.length,M=Math.min(x,F);let q;for(q=0;q<M;q++){const H=p[q]=A?Gt(p[q]):Ct(p[q]);k(u[q],H,_,null,w,E,T,P,A)}x>F?_t(u,w,E,!0,!1,M):J(p,_,v,w,E,T,P,A,M)},At=(u,p,_,v,w,E,T,P,A)=>{let x=0;const F=p.length;let M=u.length-1,q=F-1;for(;x<=M&&x<=q;){const H=u[x],ee=p[x]=A?Gt(p[x]):Ct(p[x]);if(Rs(H,ee))k(H,ee,_,null,w,E,T,P,A);else break;x++}for(;x<=M&&x<=q;){const H=u[M],ee=p[q]=A?Gt(p[q]):Ct(p[q]);if(Rs(H,ee))k(H,ee,_,null,w,E,T,P,A);else break;M--,q--}if(x>M){if(x<=q){const H=q+1,ee=H<F?p[H].el:v;for(;x<=q;)k(null,p[x]=A?Gt(p[x]):Ct(p[x]),_,ee,w,E,T,P,A),x++}}else if(x>q)for(;x<=M;)Fe(u[x],w,E,!0),x++;else{const H=x,ee=x,ne=new Map;for(x=ee;x<=q;x++){const qe=p[x]=A?Gt(p[x]):Ct(p[x]);qe.key!=null&&ne.set(qe.key,x)}let re,Te=0;const Me=q-ee+1;let tt=!1,st=0;const is=new Array(Me);for(x=0;x<Me;x++)is[x]=0;for(x=H;x<=M;x++){const qe=u[x];if(Te>=Me){Fe(qe,w,E,!0);continue}let nt;if(qe.key!=null)nt=ne.get(qe.key);else for(re=ee;re<=q;re++)if(is[re-ee]===0&&Rs(qe,p[re])){nt=re;break}nt===void 0?Fe(qe,w,E,!0):(is[nt-ee]=x+1,nt>=st?st=nt:tt=!0,k(qe,p[nt],_,null,w,E,T,P,A),Te++)}const dn=tt?_f(is):ks;for(re=dn.length-1,x=Me-1;x>=0;x--){const qe=ee+x,nt=p[qe],Is=p[qe+1],pn=qe+1<F?Is.el||Is.placeholder:v;is[x]===0?k(null,nt,_,pn,w,E,T,P,A):tt&&(re<0||x!==dn[re]?et(nt,_,pn,2):re--)}}},et=(u,p,_,v,w=null)=>{const{el:E,type:T,transition:P,children:A,shapeFlag:x}=u;if(x&6){et(u.component.subTree,p,_,v);return}if(x&128){u.suspense.move(p,_,v);return}if(x&64){T.move(u,p,_,j);return}if(T===gt){n(E,p,_);for(let M=0;M<A.length;M++)et(A[M],p,_,v);n(u.anchor,p,_);return}if(T===ur){G(u,p,_);return}if(v!==2&&x&1&&P)if(v===0)P.beforeEnter(E),n(E,p,_),Ze(()=>P.enter(E),w);else{const{leave:M,delayLeave:q,afterLeave:H}=P,ee=()=>{u.ctx.isUnmounted?r(E):n(E,p,_)},ne=()=>{E._isLeaving&&E[Mc](!0),M(E,()=>{ee(),H&&H()})};q?q(E,ee,ne):ne()}else n(E,p,_)},Fe=(u,p,_,v=!1,w=!1)=>{const{type:E,props:T,ref:P,children:A,dynamicChildren:x,shapeFlag:F,patchFlag:M,dirs:q,cacheIndex:H}=u;if(M===-2&&(w=!1),P!=null&&(Lt(),Qs(P,null,_,u,!0),Ft()),H!=null&&(p.renderCache[H]=void 0),F&256){p.ctx.deactivate(u);return}const ee=F&1&&q,ne=!Gs(u);let re;if(ne&&(re=T&&T.onVnodeBeforeUnmount)&&yt(re,p,u),F&6)rs(u.component,_,v);else{if(F&128){u.suspense.unmount(_,v);return}ee&&ls(u,null,p,"beforeUnmount"),F&64?u.type.remove(u,p,_,j,v):x&&!x.hasOnce&&(E!==gt||M>0&&M&64)?_t(x,p,_,!1,!0):(E===gt&&M&384||!w&&F&16)&&_t(A,p,_),v&&ht(u)}(ne&&(re=T&&T.onVnodeUnmounted)||ee)&&Ze(()=>{re&&yt(re,p,u),ee&&ls(u,null,p,"unmounted")},_)},ht=u=>{const{type:p,el:_,anchor:v,transition:w}=u;if(p===gt){Os(_,v);return}if(p===ur){L(u);return}const E=()=>{r(_),w&&!w.persisted&&w.afterLeave&&w.afterLeave()};if(u.shapeFlag&1&&w&&!w.persisted){const{leave:T,delayLeave:P}=w,A=()=>T(_,E);P?P(u.el,E,A):A()}else E()},Os=(u,p)=>{let _;for(;u!==p;)_=h(u),r(u),u=_;r(p)},rs=(u,p,_)=>{const{bum:v,scope:w,job:E,subTree:T,um:P,m:A,a:x}=u;Ui(A),Ui(x),v&&En(v),w.stop(),E&&(E.flags|=8,Fe(T,u,p,_)),P&&Ze(P,p),Ze(()=>{u.isUnmounted=!0},p)},_t=(u,p,_,v=!1,w=!1,E=0)=>{for(let T=E;T<u.length;T++)Fe(u[T],p,_,v,w)},dt=u=>{if(u.shapeFlag&6)return dt(u.component.subTree);if(u.shapeFlag&128)return u.suspense.next();const p=h(u.anchor||u.el),_=p&&p[Ac];return _?h(_):p};let N=!1;const I=(u,p,_)=>{u==null?p._vnode&&Fe(p._vnode,null,null,!0):k(p._vnode||null,u,p,null,null,null,_),p._vnode=u,N||(N=!0,Ni(),tl(),N=!1)},j={p:k,um:Fe,m:et,r:ht,mt:Pt,mc:J,pc:se,pbc:fe,n:dt,o:e};return{render:I,hydrate:void 0,createApp:zc(I)}}function fr({type:e,props:t},s){return s==="svg"&&e==="foreignObject"||s==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:s}function as({effect:e,job:t},s){s?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function bf(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function El(e,t,s=!1){const n=e.children,r=t.children;if(Q(n)&&Q(r))for(let i=0;i<n.length;i++){const o=n[i];let l=r[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=r[i]=Gt(r[i]),l.el=o.el),!s&&l.patchFlag!==-2&&El(o,l)),l.type===er&&l.patchFlag!==-1&&(l.el=o.el),l.type===es&&!l.el&&(l.el=o.el)}}function _f(e){const t=e.slice(),s=[0];let n,r,i,o,l;const a=e.length;for(n=0;n<a;n++){const c=e[n];if(c!==0){if(r=s[s.length-1],e[r]<c){t[n]=r,s.push(n);continue}for(i=0,o=s.length-1;i<o;)l=i+o>>1,e[s[l]]<c?i=l+1:o=l;c<e[s[i]]&&(i>0&&(t[n]=s[i-1]),s[i]=n)}}for(i=s.length,o=s[i-1];i-- >0;)s[i]=o,o=t[o];return s}function xl(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:xl(t)}function Ui(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const Pl=e=>e.__isSuspense;function vf(e,t){t&&t.pendingBranch?Q(e)?t.effects.push(...e):t.effects.push(e):xc(e)}const gt=Symbol.for("v-fgt"),er=Symbol.for("v-txt"),es=Symbol.for("v-cmt"),ur=Symbol.for("v-stc"),Zs=[];let Xe=null;function $e(e=!1){Zs.push(Xe=e?null:[])}function yf(){Zs.pop(),Xe=Zs[Zs.length-1]||null}let tn=1;function Vi(e,t=!1){tn+=e,e<0&&Xe&&t&&(Xe.hasOnce=!0)}function Al(e){return e.dynamicChildren=tn>0?Xe||ks:null,yf(),tn>0&&Xe&&Xe.push(e),e}function ot(e,t,s,n,r,i){return Al(pe(e,t,s,n,r,i,!0))}function qn(e,t,s,n,r){return Al(Rt(e,t,s,n,r,!0))}function Tl(e){return e?e.__v_isVNode===!0:!1}function Rs(e,t){return e.type===t.type&&e.key===t.key}const Ml=({key:e})=>e??null,Pn=({ref:e,ref_key:t,ref_for:s})=>(typeof e=="number"&&(e=""+e),e!=null?ye(e)||Re(e)||z(e)?{i:at,r:e,k:t,f:!!s}:e:null);function pe(e,t=null,s=null,n=0,r=null,i=e===gt?0:1,o=!1,l=!1){const a={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Ml(t),ref:t&&Pn(t),scopeId:nl,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:at};return l?(fi(a,s),i&128&&e.normalize(a)):s&&(a.shapeFlag|=ye(s)?8:16),tn>0&&!o&&Xe&&(a.patchFlag>0||i&6)&&a.patchFlag!==32&&Xe.push(a),a}const Rt=wf;function wf(e,t=null,s=null,n=0,r=null,i=!1){if((!e||e===Bc)&&(e=es),Tl(e)){const l=Ts(e,t,!0);return s&&fi(l,s),tn>0&&!i&&Xe&&(l.shapeFlag&6?Xe[Xe.indexOf(e)]=l:Xe.push(l)),l.patchFlag=-2,l}if($f(e)&&(e=e.__vccOpts),t){t=Sf(t);let{class:l,style:a}=t;l&&!ye(l)&&(t.class=cn(l)),de(a)&&(ri(a)&&!Q(a)&&(a=Le({},a)),t.style=Zr(a))}const o=ye(e)?1:Pl(e)?128:Tc(e)?64:de(e)?4:z(e)?2:0;return pe(e,t,s,n,r,o,i,!0)}function Sf(e){return e?ri(e)||vl(e)?Le({},e):e:null}function Ts(e,t,s=!1,n=!1){const{props:r,ref:i,patchFlag:o,children:l,transition:a}=e,c=t?kf(r||{},t):r,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&Ml(c),ref:t&&t.ref?s&&i?Q(i)?i.concat(Pn(t)):[i,Pn(t)]:Pn(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:l,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==gt?o===-1?16:o|16:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:a,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ts(e.ssContent),ssFallback:e.ssFallback&&Ts(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return a&&n&&li(f,a.clone(f)),f}function Cf(e=" ",t=0){return Rt(er,null,e,t)}function Cs(e="",t=!1){return t?($e(),qn(es,null,e)):Rt(es,null,e)}function Ct(e){return e==null||typeof e=="boolean"?Rt(es):Q(e)?Rt(gt,null,e.slice()):Tl(e)?Gt(e):Rt(er,null,String(e))}function Gt(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ts(e)}function fi(e,t){let s=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(Q(t))s=16;else if(typeof t=="object")if(n&65){const r=t.default;r&&(r._c&&(r._d=!1),fi(e,r()),r._c&&(r._d=!0));return}else{s=32;const r=t._;!r&&!vl(t)?t._ctx=at:r===3&&at&&(at.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else z(t)?(t={default:t,_ctx:at},s=32):(t=String(t),n&64?(s=16,t=[Cf(t)]):s=8);e.children=t,e.shapeFlag|=s}function kf(...e){const t={};for(let s=0;s<e.length;s++){const n=e[s];for(const r in n)if(r==="class")t.class!==n.class&&(t.class=cn([t.class,n.class]));else if(r==="style")t.style=Zr([t.style,n.style]);else if(Vn(r)){const i=t[r],o=n[r];o&&i!==o&&!(Q(i)&&i.includes(o))&&(t[r]=i?[].concat(i,o):o)}else r!==""&&(t[r]=n[r])}return t}function yt(e,t,s,n=null){xt(e,t,7,[s,n])}const Ef=dl();let xf=0;function Pf(e,t,s){const n=e.type,r=(t?t.appContext:e.appContext)||Ef,i={uid:xf++,vnode:e,type:n,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Ya(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:wl(n,r),emitsOptions:ml(n,r),emit:null,emitted:null,propsDefaults:ce,inheritAttrs:n.inheritAttrs,ctx:ce,data:ce,props:ce,attrs:ce,slots:ce,refs:ce,setupState:ce,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=sf.bind(null,i),e.ce&&e.ce(i),i}let Be=null;const Af=()=>Be||at;let Dn,qr;{const e=Gn(),t=(s,n)=>{let r;return(r=e[s])||(r=e[s]=[]),r.push(n),i=>{r.length>1?r.forEach(o=>o(i)):r[0](i)}};Dn=t("__VUE_INSTANCE_SETTERS__",s=>Be=s),qr=t("__VUE_SSR_SETTERS__",s=>sn=s)}const un=e=>{const t=Be;return Dn(e),e.scope.on(),()=>{e.scope.off(),Dn(t)}},Wi=()=>{Be&&Be.scope.off(),Dn(null)};function Ol(e){return e.vnode.shapeFlag&4}let sn=!1;function Tf(e,t=!1,s=!1){t&&qr(t);const{props:n,children:r}=e.vnode,i=Ol(e);cf(e,n,i,t),df(e,r,s||t);const o=i?Mf(e,t):void 0;return t&&qr(!1),o}function Mf(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Hc);const{setup:n}=s;if(n){Lt();const r=e.setupContext=n.length>1?If(e):null,i=un(e),o=fn(n,e,0,[e.props,r]),l=To(o);if(Ft(),i(),(l||e.sp)&&!Gs(e)&&il(e),l){if(o.then(Wi,Wi),t)return o.then(a=>{Qi(e,a)}).catch(a=>{Zn(a,e,0)});e.asyncDep=o}else Qi(e,o)}else Il(e)}function Qi(e,t,s){z(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:de(t)&&(e.setupState=Jo(t)),Il(e)}function Il(e,t,s){const n=e.type;e.render||(e.render=n.render||kt);{const r=un(e);Lt();try{Uc(e)}finally{Ft(),r()}}}const Of={get(e,t){return Ne(e,"get",""),e[t]}};function If(e){const t=s=>{e.exposed=s||{}};return{attrs:new Proxy(e.attrs,Of),slots:e.slots,emit:e.emit,expose:t}}function tr(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Jo(mc(e.exposed)),{get(t,s){if(s in t)return t[s];if(s in Ys)return Ys[s](e)},has(t,s){return s in t||s in Ys}})):e.proxy}function $f(e){return z(e)&&"__vccOpts"in e}const An=(e,t)=>wc(e,t,sn),Nf="3.5.25";let Dr;const Gi=typeof window<"u"&&window.trustedTypes;if(Gi)try{Dr=Gi.createPolicy("vue",{createHTML:e=>e})}catch{}const $l=Dr?e=>Dr.createHTML(e):e=>e,Rf="http://www.w3.org/2000/svg",Lf="http://www.w3.org/1998/Math/MathML",Ot=typeof document<"u"?document:null,Yi=Ot&&Ot.createElement("template"),Ff={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,n)=>{const r=t==="svg"?Ot.createElementNS(Rf,e):t==="mathml"?Ot.createElementNS(Lf,e):s?Ot.createElement(e,{is:s}):Ot.createElement(e);return e==="select"&&n&&n.multiple!=null&&r.setAttribute("multiple",n.multiple),r},createText:e=>Ot.createTextNode(e),createComment:e=>Ot.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ot.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,s,n,r,i){const o=s?s.previousSibling:t.lastChild;if(r&&(r===i||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),s),!(r===i||!(r=r.nextSibling)););else{Yi.innerHTML=$l(n==="svg"?`<svg>${e}</svg>`:n==="mathml"?`<math>${e}</math>`:e);const l=Yi.content;if(n==="svg"||n==="mathml"){const a=l.firstChild;for(;a.firstChild;)l.appendChild(a.firstChild);l.removeChild(a)}t.insertBefore(l,s)}return[o?o.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}},qf=Symbol("_vtc");function Df(e,t,s){const n=e[qf];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}const zi=Symbol("_vod"),Kf=Symbol("_vsh"),jf=Symbol(""),Bf=/(?:^|;)\s*display\s*:/;function Hf(e,t,s){const n=e.style,r=ye(s);let i=!1;if(s&&!r){if(t)if(ye(t))for(const o of t.split(";")){const l=o.slice(0,o.indexOf(":")).trim();s[l]==null&&Tn(n,l,"")}else for(const o in t)s[o]==null&&Tn(n,o,"");for(const o in s)o==="display"&&(i=!0),Tn(n,o,s[o])}else if(r){if(t!==s){const o=n[jf];o&&(s+=";"+o),n.cssText=s,i=Bf.test(s)}}else t&&e.removeAttribute("style");zi in e&&(e[zi]=i?n.display:"",e[Kf]&&(n.display="none"))}const Zi=/\s*!important$/;function Tn(e,t,s){if(Q(s))s.forEach(n=>Tn(e,t,n));else if(s==null&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const n=Uf(e,t);Zi.test(s)?e.setProperty(bs(n),s.replace(Zi,""),"important"):e[n]=s}}const Ji=["Webkit","Moz","ms"],hr={};function Uf(e,t){const s=hr[t];if(s)return s;let n=Xt(t);if(n!=="filter"&&n in e)return hr[t]=n;n=Io(n);for(let r=0;r<Ji.length;r++){const i=Ji[r]+n;if(i in e)return hr[t]=i}return t}const Xi="http://www.w3.org/1999/xlink";function eo(e,t,s,n,r,i=Wa(t)){n&&t.startsWith("xlink:")?s==null?e.removeAttributeNS(Xi,t.slice(6,t.length)):e.setAttributeNS(Xi,t,s):s==null||i&&!Ro(s)?e.removeAttribute(t):e.setAttribute(t,i?"":Et(s)?String(s):s)}function to(e,t,s,n,r){if(t==="innerHTML"||t==="textContent"){s!=null&&(e[t]=t==="innerHTML"?$l(s):s);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const l=i==="OPTION"?e.getAttribute("value")||"":e.value,a=s==null?e.type==="checkbox"?"on":"":String(s);(l!==a||!("_value"in e))&&(e.value=a),s==null&&e.removeAttribute(t),e._value=s;return}let o=!1;if(s===""||s==null){const l=typeof e[t];l==="boolean"?s=Ro(s):s==null&&l==="string"?(s="",o=!0):l==="number"&&(s=0,o=!0)}try{e[t]=s}catch{}o&&e.removeAttribute(r||t)}function Nl(e,t,s,n){e.addEventListener(t,s,n)}function Vf(e,t,s,n){e.removeEventListener(t,s,n)}const so=Symbol("_vei");function Wf(e,t,s,n,r=null){const i=e[so]||(e[so]={}),o=i[t];if(n&&o)o.value=n;else{const[l,a]=Qf(t);if(n){const c=i[t]=zf(n,r);Nl(e,l,c,a)}else o&&(Vf(e,l,o,a),i[t]=void 0)}}const no=/(?:Once|Passive|Capture)$/;function Qf(e){let t;if(no.test(e)){t={};let n;for(;n=e.match(no);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):bs(e.slice(2)),t]}let dr=0;const Gf=Promise.resolve(),Yf=()=>dr||(Gf.then(()=>dr=0),dr=Date.now());function zf(e,t){const s=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=s.attached)return;xt(Zf(n,s.value),t,5,[n])};return s.value=e,s.attached=Yf(),s}function Zf(e,t){if(Q(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(n=>r=>!r._stopped&&n&&n(r))}else return t}const ro=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Jf=(e,t,s,n,r,i)=>{const o=r==="svg";t==="class"?Df(e,n,o):t==="style"?Hf(e,s,n):Vn(t)?Gr(t)||Wf(e,t,s,n,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Xf(e,t,n,o))?(to(e,t,n),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&eo(e,t,n,o,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!ye(n))?to(e,Xt(t),n,i,t):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),eo(e,t,n,o))};function Xf(e,t,s,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in e&&ro(t)&&z(s));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const r=e.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return ro(t)&&ye(s)?!1:t in e}const io=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Q(t)?s=>En(t,s):t},pr=Symbol("_assign"),oo={deep:!0,created(e,{value:t,modifiers:{number:s}},n){const r=Wn(t);Nl(e,"change",()=>{const i=Array.prototype.filter.call(e.options,o=>o.selected).map(o=>s?No(Kn(o)):Kn(o));e[pr](e.multiple?r?new Set(i):i:i[0]),e._assigning=!0,ii(()=>{e._assigning=!1})}),e[pr]=io(n)},mounted(e,{value:t}){lo(e,t)},beforeUpdate(e,t,s){e[pr]=io(s)},updated(e,{value:t}){e._assigning||lo(e,t)}};function lo(e,t){const s=e.multiple,n=Q(t);if(!(s&&!n&&!Wn(t))){for(let r=0,i=e.options.length;r<i;r++){const o=e.options[r],l=Kn(o);if(s)if(n){const a=typeof l;a==="string"||a==="number"?o.selected=t.some(c=>String(c)===String(l)):o.selected=Ga(t,l)>-1}else o.selected=t.has(l);else if(Yn(Kn(o),t)){e.selectedIndex!==r&&(e.selectedIndex=r);return}}!s&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Kn(e){return"_value"in e?e._value:e.value}const eu=Le({patchProp:Jf},Ff);let ao;function tu(){return ao||(ao=gf(eu))}const su=((...e)=>{const t=tu().createApp(...e),{mount:s}=t;return t.mount=n=>{const r=ru(n);if(!r)return;const i=t._component;!z(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=s(r,!1,nu(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},t});function nu(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function ru(e){return ye(e)?document.querySelector(e):e}const iu={class:"promotion-dialog",open:""},ou=["aria-label","onClick","onTouchstartPassive"],lu=rl({__name:"PromotionDialog",props:{state:{}},emits:["promotionSelected"],setup(e,{emit:t}){const s=e,n=[{name:"Queen",data:"q"},{name:"Knight",data:"n"},{name:"Rook",data:"r"},{name:"Bishop",data:"b"}];function r(i){s.state.callback?.(i.data),t("promotionSelected")}return(i,o)=>($e(),ot("dialog",iu,[($e(),ot(gt,null,fl(n,l=>pe("button",{key:l.name,type:"button",class:cn([l.name.toLowerCase(),i.state.color]),"aria-label":l.name,onClick:a=>r(l),onTouchstartPassive:a=>r(l)},null,42,ou)),64))]))}});const Oe="w",it="b",ke="p",Kr="n",Mn="b",Bs="r",Yt="q",Ee="k",gr="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Ge=-1,au={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},cu=["a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a6","b6","c6","d6","e6","f6","g6","h6","a5","b5","c5","d5","e5","f5","g5","h5","a4","b4","c4","d4","e4","f4","g4","h4","a3","b3","c3","d3","e3","f3","g3","h3","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","c1","d1","e1","f1","g1","h1"],X={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},Y={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},mr={b:[16,32,17,15],w:[-16,-32,-17,-15]},co={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},fu=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],uu=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],hu={p:1,n:2,b:4,r:8,q:16,k:32},du="pnbrqkPNBRQK",fo=[Kr,Mn,Bs,Yt],pu=7,gu=6,mu=1,bu=0,yn={[Ee]:X.KSIDE_CASTLE,[Yt]:X.QSIDE_CASTLE},jt={w:[{square:Y.a1,flag:X.QSIDE_CASTLE},{square:Y.h1,flag:X.KSIDE_CASTLE}],b:[{square:Y.a8,flag:X.QSIDE_CASTLE},{square:Y.h8,flag:X.KSIDE_CASTLE}]},_u={b:mu,w:gu},vu=["1-0","0-1","1/2-1/2","*"];function ps(e){return e>>4}function nn(e){return e&15}function Rl(e){return"0123456789".indexOf(e)!==-1}function Je(e){const t=nn(e),s=ps(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(s,s+1)}function Ls(e){return e===Oe?it:Oe}function yu(e){const t=e.split(/\s+/);if(t.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const s=parseInt(t[5],10);if(isNaN(s)||s<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const n=parseInt(t[4],10);if(isNaN(n)||n<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const r=t[0].split("/");if(r.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let o=0;o<r.length;o++){let l=0,a=!1;for(let c=0;c<r[o].length;c++)if(Rl(r[o][c])){if(a)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};l+=parseInt(r[o][c],10),a=!0}else{if(!/^[prnbqkPRNBQK]$/.test(r[o][c]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};l+=1,a=!1}if(l!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(t[3][1]=="3"&&t[1]=="w"||t[3][1]=="6"&&t[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const i=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:o,regex:l}of i){if(!l.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${o} king`};if((t[0].match(l)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${o} kings`}}return{ok:!0}}function wu(e,t){const s=e.from,n=e.to,r=e.piece;let i=0,o=0,l=0;for(let a=0,c=t.length;a<c;a++){const f=t[a].from,d=t[a].to,h=t[a].piece;r===h&&s!==f&&n===d&&(i++,ps(s)===ps(f)&&o++,nn(s)===nn(f)&&l++)}return i>0?o>0&&l>0?Je(s):l>0?Je(s).charAt(1):Je(s).charAt(0):""}function Bt(e,t,s,n,r,i=void 0,o=X.NORMAL){const l=ps(n);if(r===ke&&(l===pu||l===bu))for(let a=0;a<fo.length;a++){const c=fo[a];e.push({color:t,from:s,to:n,piece:r,captured:i,promotion:c,flags:o|X.PROMOTION})}else e.push({color:t,from:s,to:n,piece:r,captured:i,flags:o})}function uo(e){let t=e.charAt(0);return t>="a"&&t<="h"?e.match(/[a-h]\d.*[a-h]\d/)?void 0:ke:(t=t.toLowerCase(),t==="o"?Ee:t)}function br(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class Su{_board=new Array(128);_turn=Oe;_header={};_kings={w:Ge,b:Ge};_epSquare=-1;_halfMoves=0;_moveNumber=0;_history=[];_comments={};_castling={w:0,b:0};constructor(t=gr){this.load(t)}clear(t=!1){this._board=new Array(128),this._kings={w:Ge,b:Ge},this._turn=Oe,this._castling={w:0,b:0},this._epSquare=Ge,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=t?this._header:{},this._updateSetup(this.fen())}removeHeader(t){t in this._header&&delete this._header[t]}load(t,s=!1){let n=t.split(/\s+/);if(n.length>=2&&n.length<6){const a=["-","-","0","1"];t=n.concat(a.slice(-(6-n.length))).join(" ")}n=t.split(/\s+/);const{ok:r,error:i}=yu(t);if(!r)throw new Error(i);const o=n[0];let l=0;this.clear(s);for(let a=0;a<o.length;a++){const c=o.charAt(a);if(c==="/")l+=8;else if(Rl(c))l+=parseInt(c,10);else{const f=c<"a"?Oe:it;this.put({type:c.toLowerCase(),color:f},Je(l)),l++}}this._turn=n[1],n[2].indexOf("K")>-1&&(this._castling.w|=X.KSIDE_CASTLE),n[2].indexOf("Q")>-1&&(this._castling.w|=X.QSIDE_CASTLE),n[2].indexOf("k")>-1&&(this._castling.b|=X.KSIDE_CASTLE),n[2].indexOf("q")>-1&&(this._castling.b|=X.QSIDE_CASTLE),this._epSquare=n[3]==="-"?Ge:Y[n[3]],this._halfMoves=parseInt(n[4],10),this._moveNumber=parseInt(n[5],10),this._updateSetup(this.fen())}fen(){let t=0,s="";for(let i=Y.a8;i<=Y.h1;i++){if(this._board[i]){t>0&&(s+=t,t=0);const{color:o,type:l}=this._board[i];s+=o===Oe?l.toUpperCase():l.toLowerCase()}else t++;i+1&136&&(t>0&&(s+=t),i!==Y.h1&&(s+="/"),t=0,i+=8)}let n="";this._castling[Oe]&X.KSIDE_CASTLE&&(n+="K"),this._castling[Oe]&X.QSIDE_CASTLE&&(n+="Q"),this._castling[it]&X.KSIDE_CASTLE&&(n+="k"),this._castling[it]&X.QSIDE_CASTLE&&(n+="q"),n=n||"-";let r="-";if(this._epSquare!==Ge){const i=this._epSquare+(this._turn===Oe?16:-16),o=[i+1,i-1];for(const l of o){if(l&136)continue;const a=this._turn;if(this._board[l]?.color===a&&this._board[l]?.type===ke){this._makeMove({color:a,from:l,to:this._epSquare,piece:ke,captured:ke,flags:X.EP_CAPTURE});const c=!this._isKingAttacked(a);if(this._undoMove(),c){r=Je(this._epSquare);break}}}}return[s,this._turn,n,r,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(t){this._history.length>0||(t!==gr?(this._header.SetUp="1",this._header.FEN=t):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(gr)}get(t){return this._board[Y[t]]||!1}put({type:t,color:s},n){if(du.indexOf(t.toLowerCase())===-1||!(n in Y))return!1;const r=Y[n];return t==Ee&&!(this._kings[s]==Ge||this._kings[s]==r)?!1:(this._board[r]={type:t,color:s},t===Ee&&(this._kings[s]=r),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0)}remove(t){const s=this.get(t);return delete this._board[Y[t]],s&&s.type===Ee&&(this._kings[s.color]=Ge),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),s}_updateCastlingRights(){const t=this._board[Y.e1]?.type===Ee&&this._board[Y.e1]?.color===Oe,s=this._board[Y.e8]?.type===Ee&&this._board[Y.e8]?.color===it;(!t||this._board[Y.a1]?.type!==Bs||this._board[Y.a1]?.color!==Oe)&&(this._castling.w&=-65),(!t||this._board[Y.h1]?.type!==Bs||this._board[Y.h1]?.color!==Oe)&&(this._castling.w&=-33),(!s||this._board[Y.a8]?.type!==Bs||this._board[Y.a8]?.color!==it)&&(this._castling.b&=-65),(!s||this._board[Y.h8]?.type!==Bs||this._board[Y.h8]?.color!==it)&&(this._castling.b&=-33)}_updateEnPassantSquare(){if(this._epSquare===Ge)return;const t=this._epSquare+(this._turn===Oe?-16:16),s=this._epSquare+(this._turn===Oe?16:-16),n=[s+1,s-1];if(this._board[t]!==null||this._board[this._epSquare]!==null||this._board[s]?.color!==Ls(this._turn)||this._board[s]?.type!==ke){this._epSquare=Ge;return}const r=i=>!(i&136)&&this._board[i]?.color===this._turn&&this._board[i]?.type===ke;n.some(r)||(this._epSquare=Ge)}_attacked(t,s){for(let n=Y.a8;n<=Y.h1;n++){if(n&136){n+=7;continue}if(this._board[n]===void 0||this._board[n].color!==t)continue;const r=this._board[n],i=n-s;if(i===0)continue;const o=i+119;if(fu[o]&hu[r.type]){if(r.type===ke){if(i>0){if(r.color===Oe)return!0}else if(r.color===it)return!0;continue}if(r.type==="n"||r.type==="k")return!0;const l=uu[o];let a=n+l,c=!1;for(;a!==s;){if(this._board[a]!=null){c=!0;break}a+=l}if(!c)return!0}}return!1}_isKingAttacked(t){const s=this._kings[t];return s===-1?!1:this._attacked(Ls(t),s)}isAttacked(t,s){return this._attacked(s,Y[t])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const t={b:0,n:0,r:0,q:0,k:0,p:0},s=[];let n=0,r=0;for(let i=Y.a8;i<=Y.h1;i++){if(r=(r+1)%2,i&136){i+=7;continue}const o=this._board[i];o&&(t[o.type]=o.type in t?t[o.type]+1:1,o.type===Mn&&s.push(r),n++)}if(n===2||n===3&&(t[Mn]===1||t[Kr]===1))return!0;if(n===t[Mn]+2){let i=0;const o=s.length;for(let l=0;l<o;l++)i+=s[l];if(i===0||i===o)return!0}return!1}isThreefoldRepetition(){const t=[],s={};let n=!1;for(;;){const r=this._undoMove();if(!r)break;t.push(r)}for(;;){const r=this.fen().split(" ").slice(0,4).join(" ");s[r]=r in s?s[r]+1:1,s[r]>=3&&(n=!0);const i=t.pop();if(i)this._makeMove(i);else break}return n}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:t=!1,square:s=void 0,piece:n=void 0}={}){const r=this._moves({square:s,piece:n});return t?r.map(i=>this._makePretty(i)):r.map(i=>this._moveToSan(i,r))}_moves({legal:t=!0,piece:s=void 0,square:n=void 0}={}){const r=n?n.toLowerCase():void 0,i=s?.toLowerCase(),o=[],l=this._turn,a=Ls(l);let c=Y.a8,f=Y.h1,d=!1;if(r)if(r in Y)c=f=Y[r],d=!0;else return[];for(let g=c;g<=f;g++){if(g&136){g+=7;continue}if(!this._board[g]||this._board[g].color===a)continue;const{type:b}=this._board[g];let k;if(b===ke){if(i&&i!==b)continue;k=g+mr[l][0],this._board[k]||(Bt(o,l,g,k,ke),k=g+mr[l][1],_u[l]===ps(g)&&!this._board[k]&&Bt(o,l,g,k,ke,void 0,X.BIG_PAWN));for(let R=2;R<4;R++)k=g+mr[l][R],!(k&136)&&(this._board[k]?.color===a?Bt(o,l,g,k,ke,this._board[k].type,X.CAPTURE):k===this._epSquare&&Bt(o,l,g,k,ke,ke,X.EP_CAPTURE))}else{if(i&&i!==b)continue;for(let R=0,D=co[b].length;R<D;R++){const O=co[b][R];for(k=g;k+=O,!(k&136);){if(!this._board[k])Bt(o,l,g,k,b);else{if(this._board[k].color===l)break;Bt(o,l,g,k,b,this._board[k].type,X.CAPTURE);break}if(b===Kr||b===Ee)break}}}}if((i===void 0||i===Ee)&&(!d||f===this._kings[l])){if(this._castling[l]&X.KSIDE_CASTLE){const g=this._kings[l],b=g+2;!this._board[g+1]&&!this._board[b]&&!this._attacked(a,this._kings[l])&&!this._attacked(a,g+1)&&!this._attacked(a,b)&&Bt(o,l,this._kings[l],b,Ee,void 0,X.KSIDE_CASTLE)}if(this._castling[l]&X.QSIDE_CASTLE){const g=this._kings[l],b=g-2;!this._board[g-1]&&!this._board[g-2]&&!this._board[g-3]&&!this._attacked(a,this._kings[l])&&!this._attacked(a,g-1)&&!this._attacked(a,b)&&Bt(o,l,this._kings[l],b,Ee,void 0,X.QSIDE_CASTLE)}}if(!t||this._kings[l]===-1)return o;const h=[];for(let g=0,b=o.length;g<b;g++)this._makeMove(o[g]),this._isKingAttacked(l)||h.push(o[g]),this._undoMove();return h}move(t,{strict:s=!1}={}){let n=null;if(typeof t=="string")n=this._moveFromSan(t,s);else if(typeof t=="object"){const i=this._moves();for(let o=0,l=i.length;o<l;o++)if(t.from===Je(i[o].from)&&t.to===Je(i[o].to)&&(!("promotion"in i[o])||t.promotion===i[o].promotion)){n=i[o];break}}if(!n)throw typeof t=="string"?new Error(`Invalid move: ${t}`):new Error(`Invalid move: ${JSON.stringify(t)}`);const r=this._makePretty(n);return this._makeMove(n),r}_push(t){this._history.push({move:t,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(t){const s=this._turn,n=Ls(s);if(this._push(t),this._board[t.to]=this._board[t.from],delete this._board[t.from],t.flags&X.EP_CAPTURE&&(this._turn===it?delete this._board[t.to-16]:delete this._board[t.to+16]),t.promotion&&(this._board[t.to]={type:t.promotion,color:s}),this._board[t.to].type===Ee){if(this._kings[s]=t.to,t.flags&X.KSIDE_CASTLE){const r=t.to-1,i=t.to+1;this._board[r]=this._board[i],delete this._board[i]}else if(t.flags&X.QSIDE_CASTLE){const r=t.to+1,i=t.to-2;this._board[r]=this._board[i],delete this._board[i]}this._castling[s]=0}if(this._castling[s]){for(let r=0,i=jt[s].length;r<i;r++)if(t.from===jt[s][r].square&&this._castling[s]&jt[s][r].flag){this._castling[s]^=jt[s][r].flag;break}}if(this._castling[n]){for(let r=0,i=jt[n].length;r<i;r++)if(t.to===jt[n][r].square&&this._castling[n]&jt[n][r].flag){this._castling[n]^=jt[n][r].flag;break}}t.flags&X.BIG_PAWN?s===it?this._epSquare=t.to-16:this._epSquare=t.to+16:this._epSquare=Ge,t.piece===ke?this._halfMoves=0:t.flags&(X.CAPTURE|X.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,s===it&&this._moveNumber++,this._turn=n}undo(){const t=this._undoMove();return t?this._makePretty(t):null}_undoMove(){const t=this._history.pop();if(t===void 0)return null;const s=t.move;this._kings=t.kings,this._turn=t.turn,this._castling=t.castling,this._epSquare=t.epSquare,this._halfMoves=t.halfMoves,this._moveNumber=t.moveNumber;const n=this._turn,r=Ls(n);if(this._board[s.from]=this._board[s.to],this._board[s.from].type=s.piece,delete this._board[s.to],s.captured)if(s.flags&X.EP_CAPTURE){let i;n===it?i=s.to-16:i=s.to+16,this._board[i]={type:ke,color:r}}else this._board[s.to]={type:s.captured,color:r};if(s.flags&(X.KSIDE_CASTLE|X.QSIDE_CASTLE)){let i,o;s.flags&X.KSIDE_CASTLE?(i=s.to+1,o=s.to-1):(i=s.to-2,o=s.to+1),this._board[i]=this._board[o],delete this._board[o]}return s}pgn({newline:t=`
`,maxWidth:s=0}={}){const n=[];let r=!1;for(const h in this._header)n.push("["+h+' "'+this._header[h]+'"]'+t),r=!0;r&&this._history.length&&n.push(t);const i=h=>{const g=this._comments[this.fen()];if(typeof g<"u"){const b=h.length>0?" ":"";h=`${h}${b}{${g}}`}return h},o=[];for(;this._history.length>0;)o.push(this._undoMove());const l=[];let a="";for(o.length===0&&l.push(i(""));o.length>0;){a=i(a);const h=o.pop();if(!h)break;if(!this._history.length&&h.color==="b"){const g=`${this._moveNumber}. ...`;a=a?`${a} ${g}`:g}else h.color==="w"&&(a.length&&l.push(a),a=this._moveNumber+".");a=a+" "+this._moveToSan(h,this._moves({legal:!0})),this._makeMove(h)}if(a.length&&l.push(i(a)),typeof this._header.Result<"u"&&l.push(this._header.Result),s===0)return n.join("")+l.join(" ");const c=function(){return n.length>0&&n[n.length-1]===" "?(n.pop(),!0):!1},f=function(h,g){for(const b of g.split(" "))if(b){if(h+b.length>s){for(;c();)h--;n.push(t),h=0}n.push(b),h+=b.length,n.push(" "),h++}return c()&&h--,h};let d=0;for(let h=0;h<l.length;h++){if(d+l[h].length>s&&l[h].includes("{")){d=f(d,l[h]);continue}d+l[h].length>s&&h!==0?(n[n.length-1]===" "&&n.pop(),n.push(t),d=0):h!==0&&(n.push(" "),d++),n.push(l[h]),d+=l[h].length}return n.join("")}header(...t){for(let s=0;s<t.length;s+=2)typeof t[s]=="string"&&typeof t[s+1]=="string"&&(this._header[t[s]]=t[s+1]);return this._header}loadPgn(t,{strict:s=!1,newlineChar:n=`\r?
`}={}){function r(O){return O.replace(/\\/g,"\\")}function i(O){const G={},L=O.split(new RegExp(r(n)));let Z="",_e="";for(let te=0;te<L.length;te++){const J=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;Z=L[te].replace(J,"$1"),_e=L[te].replace(J,"$2"),Z.trim().length>0&&(G[Z]=_e)}return G}t=t.trim();const o=new RegExp("^(\\[((?:"+r(n)+")|.)*\\])((?:\\s*"+r(n)+"){2}|(?:\\s*"+r(n)+")*$)").exec(t),l=o&&o.length>=2?o[1]:"";this.reset();const a=i(l);let c="";for(const O in a)O.toLowerCase()==="fen"&&(c=a[O]),this.header(O,a[O]);if(!s)c&&this.load(c,!0);else if(a.SetUp==="1"){if(!("FEN"in a))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(a.FEN,!0)}function f(O){return Array.from(O).map(function(G){return G.charCodeAt(0)<128?G.charCodeAt(0).toString(16):encodeURIComponent(G).replace(/%/g,"").toLowerCase()}).join("")}function d(O){return O.length==0?"":decodeURIComponent("%"+(O.match(/.{1,2}/g)||[]).join("%"))}const h=function(O){return O=O.replace(new RegExp(r(n),"g")," "),`{${f(O.slice(1,O.length-1))}}`},g=function(O){if(O.startsWith("{")&&O.endsWith("}"))return d(O.slice(1,O.length-1))};let b=t.replace(l,"").replace(new RegExp(`({[^}]*})+?|;([^${r(n)}]*)`,"g"),function(O,G,L){return G!==void 0?h(G):" "+h(`{${L.slice(1)}}`)}).replace(new RegExp(r(n),"g")," ");const k=/(\([^()]+\))+?/g;for(;k.test(b);)b=b.replace(k,"");b=b.replace(/\d+\.(\.\.)?/g,""),b=b.replace(/\.\.\./g,""),b=b.replace(/\$\d+/g,"");let R=b.trim().split(new RegExp(/\s+/));R=R.filter(O=>O!=="");let D="";for(let O=0;O<R.length;O++){const G=g(R[O]);if(G!==void 0){this._comments[this.fen()]=G;continue}const L=this._moveFromSan(R[O],s);if(L==null)if(vu.indexOf(R[O])>-1)D=R[O];else throw new Error(`Invalid move in PGN: ${R[O]}`);else D="",this._makeMove(L)}D&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",D)}_moveToSan(t,s){let n="";if(t.flags&X.KSIDE_CASTLE)n="O-O";else if(t.flags&X.QSIDE_CASTLE)n="O-O-O";else{if(t.piece!==ke){const r=wu(t,s);n+=t.piece.toUpperCase()+r}t.flags&(X.CAPTURE|X.EP_CAPTURE)&&(t.piece===ke&&(n+=Je(t.from)[0]),n+="x"),n+=Je(t.to),t.promotion&&(n+="="+t.promotion.toUpperCase())}return this._makeMove(t),this.isCheck()&&(this.isCheckmate()?n+="#":n+="+"),this._undoMove(),n}_moveFromSan(t,s=!1){const n=br(t);let r=uo(n),i=this._moves({legal:!0,piece:r});for(let h=0,g=i.length;h<g;h++)if(n===br(this._moveToSan(i[h],i)))return i[h];if(s)return null;let o,l,a,c,f,d=!1;if(l=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),l?(o=l[1],a=l[2],c=l[3],f=l[4],a.length==1&&(d=!0)):(l=n.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),l&&(o=l[1],a=l[2],c=l[3],f=l[4],a.length==1&&(d=!0))),r=uo(n),i=this._moves({legal:!0,piece:o||r}),!c)return null;for(let h=0,g=i.length;h<g;h++)if(a){if((!o||o.toLowerCase()==i[h].piece)&&Y[a]==i[h].from&&Y[c]==i[h].to&&(!f||f.toLowerCase()==i[h].promotion))return i[h];if(d){const b=Je(i[h].from);if((!o||o.toLowerCase()==i[h].piece)&&Y[c]==i[h].to&&(a==b[0]||a==b[1])&&(!f||f.toLowerCase()==i[h].promotion))return i[h]}}else if(n===br(this._moveToSan(i[h],i)).replace("x",""))return i[h];return null}ascii(){let t=`   +------------------------+
`;for(let s=Y.a8;s<=Y.h1;s++){if(nn(s)===0&&(t+=" "+"87654321"[ps(s)]+" |"),this._board[s]){const n=this._board[s].type,r=this._board[s].color===Oe?n.toUpperCase():n.toLowerCase();t+=" "+r+" "}else t+=" . ";s+1&136&&(t+=`|
`,s+=8)}return t+=`   +------------------------+
`,t+="     a  b  c  d  e  f  g  h",t}perft(t){const s=this._moves({legal:!1});let n=0;const r=this._turn;for(let i=0,o=s.length;i<o;i++)this._makeMove(s[i]),this._isKingAttacked(r)||(t-1>0?n+=this.perft(t-1):n++),this._undoMove();return n}_makePretty(t){const{color:s,piece:n,from:r,to:i,flags:o,captured:l,promotion:a}=t;let c="";for(const g in X)X[g]&o&&(c+=au[g]);const f=Je(r),d=Je(i),h={color:s,piece:n,from:f,to:d,san:this._moveToSan(t,this._moves({legal:!0})),flags:c,lan:f+d,before:this.fen(),after:""};return this._makeMove(t),h.after=this.fen(),this._undoMove(),l&&(h.captured=l),a&&(h.promotion=a,h.lan+=a),h}turn(){return this._turn}board(){const t=[];let s=[];for(let n=Y.a8;n<=Y.h1;n++)this._board[n]==null?s.push(null):s.push({square:Je(n),type:this._board[n].type,color:this._board[n].color}),n+1&136&&(t.push(s),s=[],n+=8);return t}squareColor(t){if(t in Y){const s=Y[t];return(ps(s)+nn(s))%2===0?"light":"dark"}return null}history({verbose:t=!1}={}){const s=[],n=[];for(;this._history.length>0;)s.push(this._undoMove());for(;;){const r=s.pop();if(!r)break;t?n.push(this._makePretty(r)):n.push(this._moveToSan(r,this._moves())),this._makeMove(r)}return n}_pruneComments(){const t=[],s={},n=r=>{r in this._comments&&(s[r]=this._comments[r])};for(;this._history.length>0;)t.push(this._undoMove());for(n(this.fen());;){const r=t.pop();if(!r)break;this._makeMove(r),n(this.fen())}this._comments=s}getComment(){return this._comments[this.fen()]}setComment(t){this._comments[this.fen()]=t.replace("{","[").replace("}","]")}deleteComment(){const t=this._comments[this.fen()];return delete this._comments[this.fen()],t}getComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>({fen:t,comment:this._comments[t]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>{const s=this._comments[t];return delete this._comments[t],{fen:t,comment:s}})}setCastlingRights(t,s){for(const r of[Ee,Yt])s[r]!==void 0&&(s[r]?this._castling[t]|=yn[r]:this._castling[t]&=~yn[r]);this._updateCastlingRights();const n=this.getCastlingRights(t);return(s[Ee]===void 0||s[Ee]===n[Ee])&&(s[Yt]===void 0||s[Yt]===n[Yt])}getCastlingRights(t){return{[Ee]:(this._castling[t]&yn[Ee])!==0,[Yt]:(this._castling[t]&yn[Yt])!==0}}moveNumber(){return this._moveNumber}}function Cu(e){const t=[];for(const s of e)t.push({orig:s.to,brush:"yellow"}),s.captured&&t.push({orig:s.from,dest:s.to,brush:"red"}),s.san.includes("+")&&t.push({orig:s.from,dest:s.to,brush:"blue"});return t}function wn(e){return e==="w"?"white":"black"}function ho(e){const t=new Map;for(const s of cu){const n=e.moves({square:s,verbose:!0});n.length&&t.set(n[0].from,n.map(r=>r.to))}return t}function ku(e,t){if(t?.type!=="p")return!1;const s=t?.color==="w"?"8":"1";return e[1]===s}function rn(e){return!!e&&e instanceof Object&&!(e instanceof Array)&&!(e instanceof Function)}function jn(e){return rn(e)?Object.fromEntries(Object.entries(e).map(([t,s])=>[t,jn(s)])):e}function Ll(e,t){const s={...e,...t};for(const n in s)s[n]=rn(e?.[n])&&rn(t?.[n])?Ll(e[n],t[n]):jn(s[n]);return s}function Fl(e,t){const s={};for(const n in t)if(rn(e?.[n])&&rn(t?.[n])){const r=Fl(e[n],t[n]);Object.keys(r).length>0&&(s[n]=r)}else e?.[n]!==t[n]&&(s[n]=t[n]);return s}const Eu={p:"pawn",n:"knight",b:"bishop",r:"rook",q:"queen",k:"king"},xu=new Map([["b1",["a3","c3"]],["g1",["f3","h3"]],["a2",["a3","a4"]],["b2",["b3","b4"]],["c2",["c3","c4"]],["d2",["d3","d4"]],["e2",["e3","e4"]],["f2",["f3","f4"]],["g2",["g3","g4"]],["h2",["h3","h4"]]]),Pu="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Au={fen:Pu,orientation:"white",turnColor:"white",coordinates:!1,autoCastle:!0,viewOnly:!1,disableContextMenu:!1,addPieceZIndex:!1,blockTouchScroll:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:300},lastMove:void 0,movable:{free:!1,color:"white",showDests:!0,dests:xu,events:{after:()=>{},afterNewPiece:void 0},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{set:void 0,unset:void 0}},predroppable:{enabled:!1,events:{set:void 0,unset:void 0}},draggable:{enabled:!0,distance:3,autoDistance:!0,showGhost:!0,deleteOnDropOff:!1},selectable:{enabled:!0},events:{change:void 0,move:void 0,dropNewPiece:void 0,select:void 0,insert:void 0},drawable:{enabled:!0,visible:!0,defaultSnapToValidMove:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}}}},Tu=["white","black"],ui=["a","b","c","d","e","f","g","h"],hi=["1","2","3","4","5","6","7","8"],Mu=[...hi].reverse(),di=Array.prototype.concat(...ui.map(e=>hi.map(t=>e+t))),lt=e=>di[8*e[0]+e[1]],ge=e=>[e.charCodeAt(0)-97,e.charCodeAt(1)-49],ql=di.map(ge);function Ou(e){let t;const s=()=>(t===void 0&&(t=e()),t);return s.clear=()=>{t=void 0},s}const Iu=()=>{let e;return{start(){e=performance.now()},cancel(){e=void 0},stop(){if(!e)return 0;const t=performance.now()-e;return e=void 0,t}}},pi=e=>e==="white"?"black":"white",on=(e,t)=>{const s=e[0]-t[0],n=e[1]-t[1];return s*s+n*n},jr=(e,t)=>e.role===t.role&&e.color===t.color,hn=e=>(t,s)=>[(s?t[0]:7-t[0])*e.width/8,(s?7-t[1]:t[1])*e.height/8],St=(e,t)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px)`},Dl=(e,t,s=1)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px) scale(${s})`},gi=(e,t)=>{e.style.visibility=t?"visible":"hidden"},_s=e=>{var t;if(e.clientX||e.clientX===0)return[e.clientX,e.clientY];if(!((t=e.targetTouches)===null||t===void 0)&&t[0])return[e.targetTouches[0].clientX,e.targetTouches[0].clientY]},Kl=e=>e.buttons===2||e.button===2,Nt=(e,t)=>{const s=document.createElement(e);return t&&(s.className=t),s};function jl(e,t,s){const n=ge(e);return t||(n[0]=7-n[0],n[1]=7-n[1]),[s.left+s.width*n[0]/8+s.width/16,s.top+s.height*(7-n[1])/8+s.height/16]}const ms=(e,t)=>Math.abs(e-t),$u=e=>(t,s,n,r)=>ms(t,n)<2&&(e==="white"?r===s+1||s<=1&&r===s+2&&t===n:r===s-1||s>=6&&r===s-2&&t===n),Bl=(e,t,s,n)=>{const r=ms(e,s),i=ms(t,n);return r===1&&i===2||r===2&&i===1},Hl=(e,t,s,n)=>ms(e,s)===ms(t,n),Ul=(e,t,s,n)=>e===s||t===n,Vl=(e,t,s,n)=>Hl(e,t,s,n)||Ul(e,t,s,n),Nu=(e,t,s)=>(n,r,i,o)=>ms(n,i)<2&&ms(r,o)<2||s&&r===o&&r===(e==="white"?0:7)&&(n===4&&(i===2&&t.includes(0)||i===6&&t.includes(7))||t.includes(i));function Ru(e,t){const s=t==="white"?"1":"8",n=[];for(const[r,i]of e)r[1]===s&&i.color===t&&i.role==="rook"&&n.push(ge(r)[0]);return n}function Wl(e,t,s){const n=e.get(t);if(!n)return[];const r=ge(t),i=n.role,o=i==="pawn"?$u(n.color):i==="knight"?Bl:i==="bishop"?Hl:i==="rook"?Ul:i==="queen"?Vl:Nu(n.color,Ru(e,n.color),s);return ql.filter(l=>(r[0]!==l[0]||r[1]!==l[1])&&o(r[0],r[1],l[0],l[1])).map(lt)}function We(e,...t){e&&setTimeout(()=>e(...t),1)}function Lu(e){e.orientation=pi(e.orientation),e.animation.current=e.draggable.current=e.selected=void 0}function Fu(e,t){for(const[s,n]of t)n?e.pieces.set(s,n):e.pieces.delete(s)}function qu(e,t){if(e.check=void 0,t===!0&&(t=e.turnColor),t)for(const[s,n]of e.pieces)n.role==="king"&&n.color===t&&(e.check=s)}function Du(e,t,s,n){ss(e),e.premovable.current=[t,s],We(e.premovable.events.set,t,s,n)}function ts(e){e.premovable.current&&(e.premovable.current=void 0,We(e.premovable.events.unset))}function Ku(e,t,s){ts(e),e.predroppable.current={role:t,key:s},We(e.predroppable.events.set,t,s)}function ss(e){const t=e.predroppable;t.current&&(t.current=void 0,We(t.events.unset))}function ju(e,t,s){if(!e.autoCastle)return!1;const n=e.pieces.get(t);if(!n||n.role!=="king")return!1;const r=ge(t),i=ge(s);if(r[1]!==0&&r[1]!==7||r[1]!==i[1])return!1;r[0]===4&&!e.pieces.has(s)&&(i[0]===6?s=lt([7,i[1]]):i[0]===2&&(s=lt([0,i[1]])));const o=e.pieces.get(s);return!o||o.color!==n.color||o.role!=="rook"?!1:(e.pieces.delete(t),e.pieces.delete(s),r[0]<i[0]?(e.pieces.set(lt([6,i[1]]),n),e.pieces.set(lt([5,i[1]]),o)):(e.pieces.set(lt([2,i[1]]),n),e.pieces.set(lt([3,i[1]]),o)),!0)}function Ql(e,t,s){const n=e.pieces.get(t),r=e.pieces.get(s);if(t===s||!n)return!1;const i=r&&r.color!==n.color?r:void 0;return s===e.selected&&ft(e),We(e.events.move,t,s,i),ju(e,t,s)||(e.pieces.set(s,n),e.pieces.delete(t)),e.lastMove=[t,s],e.check=void 0,We(e.events.change),i||!0}function mi(e,t,s,n){if(e.pieces.has(s))if(n)e.pieces.delete(s);else return!1;return We(e.events.dropNewPiece,t,s),e.pieces.set(s,t),e.lastMove=[s],e.check=void 0,We(e.events.change),e.movable.dests=void 0,e.turnColor=pi(e.turnColor),!0}function Gl(e,t,s){const n=Ql(e,t,s);return n&&(e.movable.dests=void 0,e.turnColor=pi(e.turnColor),e.animation.current=void 0),n}function Yl(e,t,s){if(bi(e,t,s)){const n=Gl(e,t,s);if(n){const r=e.hold.stop();ft(e);const i={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:r};return n!==!0&&(i.captured=n),We(e.movable.events.after,t,s,i),!0}}else if(Hu(e,t,s))return Du(e,t,s,{ctrlKey:e.stats.ctrlKey}),ft(e),!0;return ft(e),!1}function zl(e,t,s,n){const r=e.pieces.get(t);r&&(Bu(e,t,s)||n)?(e.pieces.delete(t),mi(e,r,s,n),We(e.movable.events.afterNewPiece,r.role,s,{premove:!1,predrop:!1})):r&&Uu(e,t,s)?Ku(e,r.role,s):(ts(e),ss(e)),e.pieces.delete(t),ft(e)}function Br(e,t,s){if(We(e.events.select,t),e.selected){if(e.selected===t&&!e.draggable.enabled){ft(e),e.hold.cancel();return}else if((e.selectable.enabled||s)&&e.selected!==t&&Yl(e,e.selected,t)){e.stats.dragged=!1;return}}(e.selectable.enabled||e.draggable.enabled)&&(Jl(e,t)||_i(e,t))&&(Zl(e,t),e.hold.start())}function Zl(e,t){e.selected=t,_i(e,t)?e.premovable.customDests||(e.premovable.dests=Wl(e.pieces,t,e.premovable.castle)):e.premovable.dests=void 0}function ft(e){e.selected=void 0,e.premovable.dests=void 0,e.hold.cancel()}function Jl(e,t){const s=e.pieces.get(t);return!!s&&(e.movable.color==="both"||e.movable.color===s.color&&e.turnColor===s.color)}const bi=(e,t,s)=>{var n,r;return t!==s&&Jl(e,t)&&(e.movable.free||!!(!((r=(n=e.movable.dests)===null||n===void 0?void 0:n.get(t))===null||r===void 0)&&r.includes(s)))};function Bu(e,t,s){const n=e.pieces.get(t);return!!n&&(t===s||!e.pieces.has(s))&&(e.movable.color==="both"||e.movable.color===n.color&&e.turnColor===n.color)}function _i(e,t){const s=e.pieces.get(t);return!!s&&e.premovable.enabled&&e.movable.color===s.color&&e.turnColor!==s.color}function Hu(e,t,s){var n,r;const i=(r=(n=e.premovable.customDests)===null||n===void 0?void 0:n.get(t))!==null&&r!==void 0?r:Wl(e.pieces,t,e.premovable.castle);return t!==s&&_i(e,t)&&i.includes(s)}function Uu(e,t,s){const n=e.pieces.get(t),r=e.pieces.get(s);return!!n&&(!r||r.color!==e.movable.color)&&e.predroppable.enabled&&(n.role!=="pawn"||s[1]!=="1"&&s[1]!=="8")&&e.movable.color===n.color&&e.turnColor!==n.color}function Vu(e,t){const s=e.pieces.get(t);return!!s&&e.draggable.enabled&&(e.movable.color==="both"||e.movable.color===s.color&&(e.turnColor===s.color||e.premovable.enabled))}function Wu(e){const t=e.premovable.current;if(!t)return!1;const s=t[0],n=t[1];let r=!1;if(bi(e,s,n)){const i=Gl(e,s,n);if(i){const o={premove:!0};i!==!0&&(o.captured=i),We(e.movable.events.after,s,n,o),r=!0}}return ts(e),r}function Qu(e,t){const s=e.predroppable.current;let n=!1;if(!s)return!1;if(t(s)){const r={role:s.role,color:e.movable.color};mi(e,r,s.key)&&(We(e.movable.events.afterNewPiece,s.role,s.key,{premove:!1,predrop:!0}),n=!0)}return ss(e),n}function vi(e){ts(e),ss(e),ft(e)}function po(e){e.movable.color=e.movable.dests=e.animation.current=void 0,vi(e)}function vs(e,t,s){let n=Math.floor(8*(e[0]-s.left)/s.width);t||(n=7-n);let r=7-Math.floor(8*(e[1]-s.top)/s.height);return t||(r=7-r),n>=0&&n<8&&r>=0&&r<8?lt([n,r]):void 0}function Gu(e,t,s,n){const r=ge(e),i=ql.filter(a=>Vl(r[0],r[1],a[0],a[1])||Bl(r[0],r[1],a[0],a[1])),o=i.map(a=>jl(lt(a),s,n)).map(a=>on(t,a)),[,l]=o.reduce((a,c,f)=>a[0]<c?a:[c,f],[o[0],0]);return lt(i[l])}const Qe=e=>e.orientation==="white",Xl="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",Yu={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},zu={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};function ea(e){e==="start"&&(e=Xl);const t=new Map;let s=7,n=0;for(const r of e)switch(r){case" ":case"[":return t;case"/":if(--s,s<0)return t;n=0;break;case"~":{const i=t.get(lt([n-1,s]));i&&(i.promoted=!0);break}default:{const i=r.charCodeAt(0);if(i<57)n+=i-48;else{const o=r.toLowerCase();t.set(lt([n,s]),{role:Yu[o],color:r===o?"black":"white"}),++n}}}return t}function Zu(e){return Mu.map(t=>ui.map(s=>{const n=e.get(s+t);if(n){let r=zu[n.role];return n.color==="white"&&(r=r.toUpperCase()),n.promoted&&(r+="~"),r}else return"1"}).join("")).join("/").replace(/1{2,}/g,t=>t.length.toString())}function ta(e,t){t.animation&&(yi(e.animation,t.animation),(e.animation.duration||0)<70&&(e.animation.enabled=!1))}function sa(e,t){var s,n,r;if(!((s=t.movable)===null||s===void 0)&&s.dests&&(e.movable.dests=void 0),!((n=t.drawable)===null||n===void 0)&&n.autoShapes&&(e.drawable.autoShapes=[]),yi(e,t),t.fen&&(e.pieces=ea(t.fen),e.drawable.shapes=((r=t.drawable)===null||r===void 0?void 0:r.shapes)||[]),"check"in t&&qu(e,t.check||!1),"lastMove"in t&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&Zl(e,e.selected),ta(e,t),!e.movable.rookCastle&&e.movable.dests){const i=e.movable.color==="white"?"1":"8",o="e"+i,l=e.movable.dests.get(o),a=e.pieces.get(o);if(!l||!a||a.role!=="king")return;e.movable.dests.set(o,l.filter(c=>!(c==="a"+i&&l.includes("c"+i))&&!(c==="h"+i&&l.includes("g"+i))))}}function yi(e,t){for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(Object.prototype.hasOwnProperty.call(e,s)&&go(e[s])&&go(t[s])?yi(e[s],t[s]):e[s]=t[s])}function go(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}const us=(e,t)=>t.animation.enabled?eh(e,t):Vt(e,t);function Vt(e,t){const s=e(t);return t.dom.redraw(),s}const _r=(e,t)=>({key:e,pos:ge(e),piece:t}),Ju=(e,t)=>t.sort((s,n)=>on(e.pos,s.pos)-on(e.pos,n.pos))[0];function Xu(e,t){const s=new Map,n=[],r=new Map,i=[],o=[],l=new Map;let a,c,f;for(const[d,h]of e)l.set(d,_r(d,h));for(const d of di)a=t.pieces.get(d),c=l.get(d),a?c?jr(a,c.piece)||(i.push(c),o.push(_r(d,a))):o.push(_r(d,a)):c&&i.push(c);for(const d of o)c=Ju(d,i.filter(h=>jr(d.piece,h.piece))),c&&(f=[c.pos[0]-d.pos[0],c.pos[1]-d.pos[1]],s.set(d.key,f.concat(f)),n.push(c.key));for(const d of i)n.includes(d.key)||r.set(d.key,d.piece);return{anims:s,fadings:r}}function na(e,t){const s=e.animation.current;if(s===void 0){e.dom.destroyed||e.dom.redrawNow();return}const n=1-(t-s.start)*s.frequency;if(n<=0)e.animation.current=void 0,e.dom.redrawNow();else{const r=th(n);for(const i of s.plan.anims.values())i[2]=i[0]*r,i[3]=i[1]*r;e.dom.redrawNow(!0),requestAnimationFrame((i=performance.now())=>na(e,i))}}function eh(e,t){const s=new Map(t.pieces),n=e(t),r=Xu(s,t);if(r.anims.size||r.fadings.size){const i=t.animation.current&&t.animation.current.start;t.animation.current={start:performance.now(),frequency:1/t.animation.duration,plan:r},i||na(t,performance.now())}else t.dom.redraw();return n}const th=e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,sh=["green","red","blue","yellow"];function nh(e,t){if(t.touches&&t.touches.length>1)return;t.stopPropagation(),t.preventDefault(),t.ctrlKey?ft(e):vi(e);const s=_s(t),n=vs(s,Qe(e),e.dom.bounds());n&&(e.drawable.current={orig:n,pos:s,brush:lh(t),snapToValidMove:e.drawable.defaultSnapToValidMove},ra(e))}function ra(e){requestAnimationFrame(()=>{const t=e.drawable.current;if(t){const s=vs(t.pos,Qe(e),e.dom.bounds());s||(t.snapToValidMove=!1);const n=t.snapToValidMove?Gu(t.orig,t.pos,Qe(e),e.dom.bounds()):s;n!==t.mouseSq&&(t.mouseSq=n,t.dest=n!==t.orig?n:void 0,e.dom.redrawNow()),ra(e)}})}function rh(e,t){e.drawable.current&&(e.drawable.current.pos=_s(t))}function ih(e){const t=e.drawable.current;t&&(t.mouseSq&&ah(e.drawable,t),ia(e))}function ia(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function oh(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),oa(e.drawable))}function lh(e){var t;const s=(e.shiftKey||e.ctrlKey)&&Kl(e),n=e.altKey||e.metaKey||((t=e.getModifierState)===null||t===void 0?void 0:t.call(e,"AltGraph"));return sh[(s?1:0)+(n?2:0)]}function ah(e,t){const s=r=>r.orig===t.orig&&r.dest===t.dest,n=e.shapes.find(s);n&&(e.shapes=e.shapes.filter(r=>!s(r))),(!n||n.brush!==t.brush)&&e.shapes.push({orig:t.orig,dest:t.dest,brush:t.brush}),oa(e)}function oa(e){e.onChange&&e.onChange(e.shapes)}function ch(e,t){if(!(e.trustAllEvents||t.isTrusted)||t.button!==void 0&&t.button!==0||t.touches&&t.touches.length>1)return;const s=e.dom.bounds(),n=_s(t),r=vs(n,Qe(e),s);if(!r)return;const i=e.pieces.get(r),o=e.selected;if(!o&&e.drawable.enabled&&(e.drawable.eraseOnClick||!i||i.color!==e.turnColor)&&oh(e),t.cancelable!==!1&&(!t.touches||e.blockTouchScroll||i||o||fh(e,n)))t.preventDefault();else if(t.touches)return;const l=!!e.premovable.current,a=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&bi(e,e.selected,r)?us(d=>Br(d,r),e):Br(e,r);const c=e.selected===r,f=aa(e,r);if(i&&f&&c&&Vu(e,r)){e.draggable.current={orig:r,piece:i,origPos:n,pos:n,started:e.draggable.autoDistance&&e.stats.dragged,element:f,previouslySelected:o,originTarget:t.target,keyHasChanged:!1},f.cgDragging=!0,f.classList.add("dragging");const d=e.dom.elements.ghost;d&&(d.className=`ghost ${i.color} ${i.role}`,St(d,hn(s)(ge(r),Qe(e))),gi(d,!0)),wi(e)}else l&&ts(e),a&&ss(e);e.dom.redraw()}function fh(e,t){const s=Qe(e),n=e.dom.bounds(),r=Math.pow(n.width/8,2);for(const i of e.pieces.keys()){const o=jl(i,s,n);if(on(o,t)<=r)return!0}return!1}function uh(e,t,s,n){e.pieces.set("a0",t),e.dom.redraw();const i=_s(s);e.draggable.current={orig:"a0",piece:t,origPos:i,pos:i,started:!0,element:()=>aa(e,"a0"),originTarget:s.target,newPiece:!0,force:!!n,keyHasChanged:!1},wi(e)}function wi(e){requestAnimationFrame(()=>{var t;const s=e.draggable.current;if(!s)return;!((t=e.animation.current)===null||t===void 0)&&t.plan.anims.has(s.orig)&&(e.animation.current=void 0);const n=e.pieces.get(s.orig);if(!n||!jr(n,s.piece))Bn(e);else if(!s.started&&on(s.pos,s.origPos)>=Math.pow(e.draggable.distance,2)&&(s.started=!0),s.started){if(typeof s.element=="function"){const i=s.element();if(!i)return;i.cgDragging=!0,i.classList.add("dragging"),s.element=i}const r=e.dom.bounds();St(s.element,[s.pos[0]-r.left-r.width/16,s.pos[1]-r.top-r.height/16]),s.keyHasChanged||(s.keyHasChanged=s.orig!==vs(s.pos,Qe(e),r))}wi(e)})}function hh(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.pos=_s(t))}function dh(e,t){const s=e.draggable.current;if(!s)return;if(t.type==="touchend"&&t.cancelable!==!1&&t.preventDefault(),t.type==="touchend"&&s.originTarget!==t.target&&!s.newPiece){e.draggable.current=void 0;return}ts(e),ss(e);const n=_s(t)||s.pos,r=vs(n,Qe(e),e.dom.bounds());r&&s.started&&s.orig!==r?s.newPiece?zl(e,s.orig,r,s.force):(e.stats.ctrlKey=t.ctrlKey,Yl(e,s.orig,r)&&(e.stats.dragged=!0)):s.newPiece?e.pieces.delete(s.orig):e.draggable.deleteOnDropOff&&!r&&(e.pieces.delete(s.orig),We(e.events.change)),(s.orig===s.previouslySelected||s.keyHasChanged)&&(s.orig===r||!r)?ft(e):e.selectable.enabled||ft(e),la(e),e.draggable.current=void 0,e.dom.redraw()}function Bn(e){const t=e.draggable.current;t&&(t.newPiece&&e.pieces.delete(t.orig),e.draggable.current=void 0,ft(e),la(e),e.dom.redraw())}function la(e){const t=e.dom.elements;t.ghost&&gi(t.ghost,!1)}function aa(e,t){let s=e.dom.elements.board.firstChild;for(;s;){if(s.cgKey===t&&s.tagName==="PIECE")return s;s=s.nextSibling}}function ph(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(()=>{mo(e,2),setTimeout(()=>mo(e,void 0),120)},120)}function mo(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}function gh(e,t){function s(){Lu(e),t()}return{set(n){n.orientation&&n.orientation!==e.orientation&&s(),ta(e,n),(n.fen?us:Vt)(r=>sa(r,n),e)},state:e,getFen:()=>Zu(e.pieces),toggleOrientation:s,setPieces(n){us(r=>Fu(r,n),e)},selectSquare(n,r){n?us(i=>Br(i,n,r),e):e.selected&&(ft(e),e.dom.redraw())},move(n,r){us(i=>Ql(i,n,r),e)},newPiece(n,r){us(i=>mi(i,n,r),e)},playPremove(){if(e.premovable.current){if(us(Wu,e))return!0;e.dom.redraw()}return!1},playPredrop(n){if(e.predroppable.current){const r=Qu(e,n);return e.dom.redraw(),r}return!1},cancelPremove(){Vt(ts,e)},cancelPredrop(){Vt(ss,e)},cancelMove(){Vt(n=>{vi(n),Bn(n)},e)},stop(){Vt(n=>{po(n),Bn(n)},e)},explode(n){ph(e,n)},setAutoShapes(n){Vt(r=>r.drawable.autoShapes=n,e)},setShapes(n){Vt(r=>r.drawable.shapes=n,e)},getKeyAtDomPos(n){return vs(n,Qe(e),e.dom.bounds())},redrawAll:t,dragNewPiece(n,r,i){uh(e,n,r,i)},destroy(){po(e),e.dom.unbind&&e.dom.unbind(),e.dom.destroyed=!0}}}function mh(){return{pieces:ea(Xl),orientation:"white",turnColor:"white",coordinates:!0,ranksPosition:"right",autoCastle:!0,viewOnly:!1,disableContextMenu:!1,addPieceZIndex:!1,blockTouchScroll:!1,pieceKey:!1,trustAllEvents:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,showGhost:!0,deleteOnDropOff:!1},dropmode:{active:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,defaultSnapToValidMove:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15},purple:{key:"purp",color:"#68217a",opacity:.65,lineWidth:10},pink:{key:"pink",color:"#ee2080",opacity:.5,lineWidth:10},hilite:{key:"hilite",color:"#fff",opacity:1,lineWidth:1}},prevSvgHash:""},hold:Iu()}}function bh(){const e=Se("defs"),t=He(Se("filter"),{id:"cg-filter-blur"});return t.appendChild(He(Se("feGaussianBlur"),{stdDeviation:"0.022"})),e.appendChild(t),e}function _h(e,t,s){var n;const r=e.drawable,i=r.current,o=i&&i.mouseSq?i:void 0,l=new Map,a=e.dom.bounds(),c=r.autoShapes.filter(g=>!g.piece);for(const g of r.shapes.concat(c).concat(o?[o]:[])){if(!g.dest)continue;const b=(n=l.get(g.dest))!==null&&n!==void 0?n:new Set,k=Un(Hn(ge(g.orig),e.orientation),a),R=Un(Hn(ge(g.dest),e.orientation),a);b.add(Ur(k,R)),l.set(g.dest,b)}const f=r.shapes.concat(c).map(g=>({shape:g,current:!1,hash:bo(g,Hr(g.dest,l),!1,a)}));o&&f.push({shape:o,current:!0,hash:bo(o,Hr(o.dest,l),!0,a)});const d=f.map(g=>g.hash).join(";");if(d===e.drawable.prevSvgHash)return;e.drawable.prevSvgHash=d;const h=t.querySelector("defs");vh(r,f,h),yh(f,t.querySelector("g"),s.querySelector("g"),g=>Ch(e,g,r.brushes,l,a))}function vh(e,t,s){var n;const r=new Map;let i;for(const a of t.filter(c=>c.shape.dest&&c.shape.brush))i=ca(e.brushes[a.shape.brush],a.shape.modifiers),!((n=a.shape.modifiers)===null||n===void 0)&&n.hilite&&r.set("hilite",e.brushes.hilite),r.set(i.key,i);const o=new Set;let l=s.firstElementChild;for(;l;)o.add(l.getAttribute("cgKey")),l=l.nextElementSibling;for(const[a,c]of r.entries())o.has(a)||s.appendChild(xh(c))}function yh(e,t,s,n){const r=new Map;for(const i of e)r.set(i.hash,!1);for(const i of[t,s]){const o=[];let l=i.firstElementChild,a;for(;l;)a=l.getAttribute("cgHash"),r.has(a)?r.set(a,!0):o.push(l),l=l.nextElementSibling;for(const c of o)i.removeChild(c)}for(const i of e.filter(o=>!r.get(o.hash)))for(const o of n(i))o.isCustom?s.appendChild(o.el):t.appendChild(o.el)}function bo({orig:e,dest:t,brush:s,piece:n,modifiers:r,customSvg:i,label:o},l,a,c){var f,d;return[c.width,c.height,a,e,t,s,l&&"-",n&&wh(n),r&&Sh(r),i&&`custom-${_o(i.html)},${(d=(f=i.center)===null||f===void 0?void 0:f[0])!==null&&d!==void 0?d:"o"}`,o&&`label-${_o(o.text)}`].filter(h=>h).join(",")}function wh(e){return[e.color,e.role,e.scale].filter(t=>t).join(",")}function Sh(e){return[e.lineWidth,e.hilite&&"*"].filter(t=>t).join(",")}function _o(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s)>>>0;return t.toString()}function Ch(e,{shape:t,current:s,hash:n},r,i,o){var l,a;const c=Un(Hn(ge(t.orig),e.orientation),o),f=t.dest?Un(Hn(ge(t.dest),e.orientation),o):c,d=t.brush&&ca(r[t.brush],t.modifiers),h=i.get(t.dest),g=[];if(d){const b=He(Se("g"),{cgHash:n});g.push({el:b}),c[0]!==f[0]||c[1]!==f[1]?b.appendChild(Eh(t,d,c,f,s,Hr(t.dest,i))):b.appendChild(kh(r[t.brush],c,s,o))}if(t.label){const b=t.label;(l=b.fill)!==null&&l!==void 0||(b.fill=t.brush&&r[t.brush].color);const k=t.brush?void 0:"tr";g.push({el:Ph(b,n,c,f,h,k),isCustom:!0})}if(t.customSvg){const b=(a=t.customSvg.center)!==null&&a!==void 0?a:"orig",[k,R]=b==="label"?ua(c,f,h).map(O=>O-.5):b==="dest"?f:c,D=He(Se("g"),{transform:`translate(${k},${R})`,cgHash:n});D.innerHTML=`<svg width="1" height="1" viewBox="0 0 100 100">${t.customSvg.html}</svg>`,g.push({el:D,isCustom:!0})}return g}function kh(e,t,s,n){const r=Ah(),i=(n.width+n.height)/(4*Math.max(n.width,n.height));return He(Se("circle"),{stroke:e.color,"stroke-width":r[s?0:1],fill:"none",opacity:fa(e,s),cx:t[0],cy:t[1],r:i-r[1]/2})}function Eh(e,t,s,n,r,i){var o;function l(f){var d;const h=Mh(i&&!r),g=n[0]-s[0],b=n[1]-s[1],k=Math.atan2(b,g),R=Math.cos(k)*h,D=Math.sin(k)*h;return He(Se("line"),{stroke:f?"white":t.color,"stroke-width":Th(t,r)+(f?.04:0),"stroke-linecap":"round","marker-end":`url(#arrowhead-${f?"hilite":t.key})`,opacity:!((d=e.modifiers)===null||d===void 0)&&d.hilite?1:fa(t,r),x1:s[0],y1:s[1],x2:n[0]-R,y2:n[1]-D})}if(!(!((o=e.modifiers)===null||o===void 0)&&o.hilite))return l(!1);const a=Se("g"),c=He(Se("g"),{filter:"url(#cg-filter-blur)"});return c.appendChild(Oh(s,n)),c.appendChild(l(!0)),a.appendChild(c),a.appendChild(l(!1)),a}function xh(e){const t=He(Se("marker"),{id:"arrowhead-"+e.key,orient:"auto",overflow:"visible",markerWidth:4,markerHeight:4,refX:e.key==="hilite"?1.86:2.05,refY:2});return t.appendChild(He(Se("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function Ph(e,t,s,n,r,i){var o;const l=.4*.75**e.text.length,a=ua(s,n,r),c=i==="tr"?.4:0,f=He(Se("g"),{transform:`translate(${a[0]+c},${a[1]-c})`,cgHash:t});f.appendChild(He(Se("circle"),{r:.4/2,"fill-opacity":i?1:.8,"stroke-opacity":i?1:.7,"stroke-width":.03,fill:(o=e.fill)!==null&&o!==void 0?o:"#666",stroke:"white"}));const d=He(Se("text"),{"font-size":l,"font-family":"Noto Sans","text-anchor":"middle",fill:"white",y:.13*.75**e.text.length});return d.innerHTML=e.text,f.appendChild(d),f}function Hn(e,t){return t==="white"?e:[7-e[0],7-e[1]]}function Hr(e,t){return(e&&t.has(e)&&t.get(e).size>1)===!0}function Se(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function He(e,t){for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.setAttribute(s,t[s]);return e}function ca(e,t){return t?{color:e.color,opacity:Math.round(e.opacity*10)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth),key:[e.key,t.lineWidth].filter(s=>s).join("")}:e}function Ah(){return[3/64,4/64]}function Th(e,t){return(e.lineWidth||10)*(t?.85:1)/64}function fa(e,t){return(e.opacity||1)*(t?.9:1)}function Mh(e){return(e?20:10)/64}function Un(e,t){const s=Math.min(1,t.width/t.height),n=Math.min(1,t.height/t.width);return[(e[0]-3.5)*s,(3.5-e[1])*n]}function Oh(e,t){const s={from:[Math.floor(Math.min(e[0],t[0])),Math.floor(Math.min(e[1],t[1]))],to:[Math.ceil(Math.max(e[0],t[0])),Math.ceil(Math.max(e[1],t[1]))]};return He(Se("rect"),{x:s.from[0],y:s.from[1],width:s.to[0]-s.from[0],height:s.to[1]-s.from[1],fill:"none",stroke:"none"})}function Ur(e,t,s=!0){const n=Math.atan2(t[1]-e[1],t[0]-e[0])+Math.PI;return s?(Math.round(n*8/Math.PI)+16)%16:n}function Ih(e,t){return Math.sqrt([e[0]-t[0],e[1]-t[1]].reduce((s,n)=>s+n*n,0))}function ua(e,t,s){let n=Ih(e,t);const r=Ur(e,t,!1);if(s&&(n-=33/64,s.size>1)){n-=10/64;const i=Ur(e,t);(s.has((i+1)%16)||s.has((i+15)%16))&&i&1&&(n-=.4)}return[e[0]-Math.cos(r)*n,e[1]-Math.sin(r)*n].map(i=>i+.5)}function $h(e,t){e.innerHTML="",e.classList.add("cg-wrap");for(const a of Tu)e.classList.toggle("orientation-"+a,t.orientation===a);e.classList.toggle("manipulable",!t.viewOnly);const s=Nt("cg-container");e.appendChild(s);const n=Nt("cg-board");s.appendChild(n);let r,i,o;if(t.drawable.visible&&(r=He(Se("svg"),{class:"cg-shapes",viewBox:"-4 -4 8 8",preserveAspectRatio:"xMidYMid slice"}),r.appendChild(bh()),r.appendChild(Se("g")),i=He(Se("svg"),{class:"cg-custom-svgs",viewBox:"-3.5 -3.5 8 8",preserveAspectRatio:"xMidYMid slice"}),i.appendChild(Se("g")),o=Nt("cg-auto-pieces"),s.appendChild(r),s.appendChild(i),s.appendChild(o)),t.coordinates){const a=t.orientation==="black"?" black":"",c=t.ranksPosition==="left"?" left":"";s.appendChild(vo(hi,"ranks"+a+c)),s.appendChild(vo(ui,"files"+a))}let l;return t.draggable.enabled&&t.draggable.showGhost&&(l=Nt("piece","ghost"),gi(l,!1),s.appendChild(l)),{board:n,container:s,wrap:e,ghost:l,svg:r,customSvg:i,autoPieces:o}}function vo(e,t){const s=Nt("coords",t);let n;for(const r of e)n=Nt("coord"),n.textContent=r,s.appendChild(n);return s}function Nh(e,t){if(!e.dropmode.active)return;ts(e),ss(e);const s=e.dropmode.piece;if(s){e.pieces.set("a0",s);const n=_s(t),r=n&&vs(n,Qe(e),e.dom.bounds());r&&zl(e,"a0",r)}e.dom.redraw()}function Rh(e,t){const s=e.dom.elements.board;if("ResizeObserver"in window&&new ResizeObserver(t).observe(e.dom.elements.wrap),(e.disableContextMenu||e.drawable.enabled)&&s.addEventListener("contextmenu",r=>r.preventDefault()),e.viewOnly)return;const n=Fh(e);s.addEventListener("touchstart",n,{passive:!1}),s.addEventListener("mousedown",n,{passive:!1})}function Lh(e,t){const s=[];if("ResizeObserver"in window||s.push(Fs(document.body,"chessground.resize",t)),!e.viewOnly){const n=yo(e,hh,rh),r=yo(e,dh,ih);for(const o of["touchmove","mousemove"])s.push(Fs(document,o,n));for(const o of["touchend","mouseup"])s.push(Fs(document,o,r));const i=()=>e.dom.bounds.clear();s.push(Fs(document,"scroll",i,{capture:!0,passive:!0})),s.push(Fs(window,"resize",i,{passive:!0}))}return()=>s.forEach(n=>n())}function Fs(e,t,s,n){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s,n)}const Fh=e=>t=>{e.draggable.current?Bn(e):e.drawable.current?ia(e):t.shiftKey||Kl(t)?e.drawable.enabled&&nh(e,t):e.viewOnly||(e.dropmode.active?Nh(e,t):ch(e,t))},yo=(e,t,s)=>n=>{e.drawable.current?e.drawable.enabled&&s(e,n):e.viewOnly||t(e,n)};function qh(e){const t=Qe(e),s=hn(e.dom.bounds()),n=e.dom.elements.board,r=e.pieces,i=e.animation.current,o=i?i.plan.anims:new Map,l=i?i.plan.fadings:new Map,a=e.draggable.current,c=Kh(e),f=new Set,d=new Set,h=new Map,g=new Map;let b,k,R,D,O,G,L,Z,_e,te;for(k=n.firstChild;k;){if(b=k.cgKey,ha(k))if(R=r.get(b),O=o.get(b),G=l.get(b),D=k.cgPiece,k.cgDragging&&(!a||a.orig!==b)&&(k.classList.remove("dragging"),St(k,s(ge(b),t)),k.cgDragging=!1),!G&&k.cgFading&&(k.cgFading=!1,k.classList.remove("fading")),R){if(O&&k.cgAnimating&&D===qs(R)){const J=ge(b);J[0]+=O[2],J[1]+=O[3],k.classList.add("anim"),St(k,s(J,t))}else k.cgAnimating&&(k.cgAnimating=!1,k.classList.remove("anim"),St(k,s(ge(b),t)),e.addPieceZIndex&&(k.style.zIndex=vr(ge(b),t)));D===qs(R)&&(!G||!k.cgFading)?f.add(b):G&&D===qs(G)?(k.classList.add("fading"),k.cgFading=!0):yr(h,D,k)}else yr(h,D,k);else if(da(k)){const J=k.className;c.get(b)===J?d.add(b):yr(g,J,k)}k=k.nextSibling}for(const[J,Ae]of c)if(!d.has(J)){_e=g.get(Ae),te=_e&&_e.pop();const fe=s(ge(J),t);if(te)te.cgKey=J,St(te,fe);else{const me=Nt("square",Ae);me.cgKey=J,St(me,fe),n.insertBefore(me,n.firstChild)}}for(const[J,Ae]of r)if(O=o.get(J),!f.has(J))if(L=h.get(qs(Ae)),Z=L&&L.pop(),Z){Z.cgKey=J,Z.cgFading&&(Z.classList.remove("fading"),Z.cgFading=!1);const fe=ge(J);e.addPieceZIndex&&(Z.style.zIndex=vr(fe,t)),O&&(Z.cgAnimating=!0,Z.classList.add("anim"),fe[0]+=O[2],fe[1]+=O[3]),St(Z,s(fe,t))}else{const fe=qs(Ae),me=Nt("piece",fe),Ue=ge(J);me.cgPiece=fe,me.cgKey=J,O&&(me.cgAnimating=!0,Ue[0]+=O[2],Ue[1]+=O[3]),St(me,s(Ue,t)),e.addPieceZIndex&&(me.style.zIndex=vr(Ue,t)),n.appendChild(me)}for(const J of h.values())So(e,J);for(const J of g.values())So(e,J)}function Dh(e){const t=Qe(e),s=hn(e.dom.bounds());let n=e.dom.elements.board.firstChild;for(;n;)(ha(n)&&!n.cgAnimating||da(n))&&St(n,s(ge(n.cgKey),t)),n=n.nextSibling}function wo(e){var t,s;const n=e.dom.elements.wrap.getBoundingClientRect(),r=e.dom.elements.container,i=n.height/n.width,o=Math.floor(n.width*window.devicePixelRatio/8)*8/window.devicePixelRatio,l=o*i;r.style.width=o+"px",r.style.height=l+"px",e.dom.bounds.clear(),(t=e.addDimensionsCssVarsTo)===null||t===void 0||t.style.setProperty("--cg-width",o+"px"),(s=e.addDimensionsCssVarsTo)===null||s===void 0||s.style.setProperty("--cg-height",l+"px")}const ha=e=>e.tagName==="PIECE",da=e=>e.tagName==="SQUARE";function So(e,t){for(const s of t)e.dom.elements.board.removeChild(s)}function vr(e,t){const s=e[1];return`${t?10-s:3+s}`}const qs=e=>`${e.color} ${e.role}`;function Kh(e){var t,s,n;const r=new Map;if(e.lastMove&&e.highlight.lastMove)for(const l of e.lastMove)Mt(r,l,"last-move");if(e.check&&e.highlight.check&&Mt(r,e.check,"check"),e.selected&&(Mt(r,e.selected,"selected"),e.movable.showDests)){const l=(t=e.movable.dests)===null||t===void 0?void 0:t.get(e.selected);if(l)for(const c of l)Mt(r,c,"move-dest"+(e.pieces.has(c)?" oc":""));const a=(n=(s=e.premovable.customDests)===null||s===void 0?void 0:s.get(e.selected))!==null&&n!==void 0?n:e.premovable.dests;if(a)for(const c of a)Mt(r,c,"premove-dest"+(e.pieces.has(c)?" oc":""))}const i=e.premovable.current;if(i)for(const l of i)Mt(r,l,"current-premove");else e.predroppable.current&&Mt(r,e.predroppable.current.key,"current-premove");const o=e.exploding;if(o)for(const l of o.keys)Mt(r,l,"exploding"+o.stage);return e.highlight.custom&&e.highlight.custom.forEach((l,a)=>{Mt(r,a,l)}),r}function Mt(e,t,s){const n=e.get(t);n?e.set(t,`${n} ${s}`):e.set(t,s)}function yr(e,t,s){const n=e.get(t);n?n.push(s):e.set(t,[s])}function jh(e,t,s){const n=new Map,r=[];for(const l of e)n.set(l.hash,!1);let i=t.firstElementChild,o;for(;i;)o=i.getAttribute("cgHash"),n.has(o)?n.set(o,!0):r.push(i),i=i.nextElementSibling;for(const l of r)t.removeChild(l);for(const l of e)n.get(l.hash)||t.appendChild(s(l))}function Bh(e,t){const s=e.drawable.autoShapes.filter(n=>n.piece).map(n=>({shape:n,hash:Vh(n),current:!1}));jh(s,t,n=>Uh(e,n,e.dom.bounds()))}function Hh(e){var t;const s=Qe(e),n=hn(e.dom.bounds());let r=(t=e.dom.elements.autoPieces)===null||t===void 0?void 0:t.firstChild;for(;r;)Dl(r,n(ge(r.cgKey),s),r.cgScale),r=r.nextSibling}function Uh(e,{shape:t,hash:s},n){var r,i,o;const l=t.orig,a=(r=t.piece)===null||r===void 0?void 0:r.role,c=(i=t.piece)===null||i===void 0?void 0:i.color,f=(o=t.piece)===null||o===void 0?void 0:o.scale,d=Nt("piece",`${a} ${c}`);return d.setAttribute("cgHash",s),d.cgKey=l,d.cgScale=f,Dl(d,hn(n)(ge(l),Qe(e)),f),d}const Vh=e=>{var t,s,n;return[e.orig,(t=e.piece)===null||t===void 0?void 0:t.role,(s=e.piece)===null||s===void 0?void 0:s.color,(n=e.piece)===null||n===void 0?void 0:n.scale].join(",")};function Wh(e,t){const s=mh();sa(s,{});function n(){const r="dom"in s?s.dom.unbind:void 0,i=$h(e,s),o=Ou(()=>i.board.getBoundingClientRect()),l=f=>{qh(c),i.autoPieces&&Bh(c,i.autoPieces),!f&&i.svg&&_h(c,i.svg,i.customSvg)},a=()=>{wo(c),Dh(c),i.autoPieces&&Hh(c)},c=s;return c.dom={elements:i,bounds:o,redraw:Qh(l),redrawNow:l,unbind:r},c.drawable.prevSvgHash="",wo(c),l(!1),Rh(c,a),r||(c.dom.unbind=Lh(c,a)),c.events.insert&&c.events.insert(i),c}return gh(n(),n)}function Qh(e){let t=!1;return()=>{t||(t=!0,requestAnimationFrame(()=>{e(),t=!1}))}}class Gh{game;board;boardState;props;emit;constructor(t,s,n,r){this.boardState=s,this.props=n,this.emit=r,this.game=new Su,this.board=Wh(t),this.resetBoard()}updateGameState({updateFen:t=!0}={}){this.boardState.historyViewerState.isEnabled||(t&&this.board.set({fen:this.game.fen()}),this.board.state.turnColor=this.getTurnColor(),this.board.state.movable.free?(this.board.state.movable.color="both",this.board.state.movable.dests=new Map):(this.board.state.movable.color=this.props.playerColor||this.board.state.turnColor,this.board.state.movable.dests=ho(this.game)),this.displayInCheck(this.game.inCheck(),this.board.state.turnColor),this.boardState.showThreats&&this.drawMoves()),this.emitEvents()}displayInCheck(t,s){if(t){for(const[n,r]of this.board.state.pieces)if(r.role==="king"&&r.color===s){this.board.state.check=n;return}}else this.board.state.check=void 0}emitEvents(){this.game.inCheck()&&this.emit(this.game.isCheckmate()?"checkmate":"check",this.board.state.turnColor),this.game.isDraw()&&this.emit("draw"),this.game.isStalemate()&&this.emit("stalemate")}async changeTurn(t,s,n){let r;ku(s,this.game.get(t))&&(r=await new Promise(i=>{this.boardState.promotionDialogState={isEnabled:!0,color:this.getTurnColor(),callback:i}})),this.move({from:t,to:s,promotion:r})}resetBoard(){this.setConfig(this.props.boardConfig,!0)}undoLastMove(){const t=this.game.undo();if(t!=null&&(this.boardState.historyViewerState.isEnabled&&this.boardState.historyViewerState.plyViewing===this.getCurrentPlyNumber()&&this.stopViewingHistory(),!this.boardState.historyViewerState.isEnabled)){this.board.set({fen:t.before}),this.updateGameState({updateFen:!1});const s=this.getLastMove();this.board.state.lastMove=s?[s?.from,s?.to]:void 0}}getMaterialCount(){const t=this.board.state.pieces,s={pawn:1,knight:3,bishop:3,rook:5,queen:9,king:0},n={materialWhite:0,materialBlack:0,materialDiff:0};for(const r of t)r[1].color==="white"?n.materialWhite+=s[r[1].role]:n.materialBlack+=s[r[1].role];return n.materialDiff=n.materialWhite-n.materialBlack,n}getCapturedPieces(){const t={white:[],black:[]};for(const{color:s,captured:n}of this.getHistory(!0))n&&t[wn(s)].push(n);return t}toggleOrientation(){this.board.toggleOrientation()}drawMoves(){this.boardState.showThreats=!0,this.board.setShapes(Cu(this.game.moves({verbose:!0})))}hideMoves(){this.boardState.showThreats=!1,this.board.setShapes([])}drawMove(t,s,n){this.board.setShapes([{orig:t,dest:s,brush:n}])}toggleMoves(){this.boardState.showThreats?this.hideMoves():this.drawMoves()}async getOpeningName(){try{const t=this.game.history({verbose:!0}).map(s=>s.lan).join(",");return(await(await fetch(`https://explorer.lichess.ovh/masters?play=${t}`)).json()).opening?.name??null}catch{return null}}move(t){let s;try{s=this.game.move(t)}catch{return typeof t=="object"&&this.board.state.movable.free&&(this.board.move(t.from,t.to),this.updateGameState({updateFen:!1})),!1}return this.emit("move",s),s?.promotion&&this.emit("promotion",{color:wn(s.color),promotedTo:s.promotion.toUpperCase(),sanMove:s.san}),this.boardState.historyViewerState.isEnabled||(this.board.move(s.from,s.to),(s.flags==="e"||s?.promotion)&&setTimeout(()=>this.board.set({fen:s.after}),this.board.state.animation.current?this.board.state.animation.duration:0),this.updateGameState({updateFen:!1}),ii(this.board.playPremove)),!0}getTurnColor(){return wn(this.game.turn())}getPossibleMoves(){return ho(this.game)}getCurrentTurnNumber(){return this.game.moveNumber()}getCurrentPlyNumber(){return 2*this.getCurrentTurnNumber()-(this.getTurnColor()==="black"?1:2)}getLastMove(){return this.game.history({verbose:!0}).at(-1)}getHistory(t=!1){return this.game.history({verbose:t})}getFen(){return this.game.fen()}getBoardPosition(){return this.game.board()}getPgn(){return this.game.pgn()}getIsGameOver(){return this.game.isGameOver()}getIsCheckmate(){return this.game.isCheckmate()}getIsCheck(){return this.game.isCheck()}getIsStalemate(){return this.game.isStalemate()}getIsDraw(){return this.game.isDraw()}getIsThreefoldRepetition(){return this.game.isThreefoldRepetition()}getIsInsufficientMaterial(){return this.game.isInsufficientMaterial()}getSquareColor(t){return this.game.squareColor(t)}getSquare(t){return this.game.get(t)}setPosition(t){this.game.load(t),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState()}putPiece(t,s){if(this.board.state.movable.free){const n=this.board.state.pieces;return n.set(s,{color:t.color==="w"?"white":"black",role:Eu[t.type]}),this.board.setPieces(n),!0}else{const n=this.game.put(t,s);return n&&this.updateGameState(),n}}removePiece(t){this.board.state.pieces.delete(t),this.game.remove(t)}clearBoard(){this.game.clear(),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState()}setShapes(t){this.board.setShapes(t)}loadPgn(t){this.game.loadPgn(t),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState();const s=this.getLastMove();s&&this.board.set({lastMove:[s.from,s.to]})}getPgnInfo(){return this.game.header()}setPgnInfo(t){return this.game.header(...Object.entries(t).flat())}setConfig(t,s=!1){if(s&&(t=Ll(Au,t),this.board.state.selected=void 0),t.movable?.events&&"after"in t.movable.events){const i=t.movable.events.after;t.movable.events.after=i?async(...o)=>{await this.changeTurn(...o),i(...o)}:this.changeTurn.bind(this)}const{fen:n,...r}=t;this.board.set(r),n&&this.setPosition(n),this.board.redrawAll()}viewHistory(t){const s=this.getHistory(!0);if(t<0||t>s.length)return;const n=this.board.state.animation.enabled&&(this.boardState.historyViewerState.isEnabled&&Math.abs(this.boardState.historyViewerState.plyViewing-t)!==1||!this.boardState.historyViewerState.isEnabled&&t!==s.length-1);if(n&&this.board.set({animation:{enabled:!1}}),t<s.length)this.boardState.historyViewerState.isEnabled?this.boardState.historyViewerState.plyViewing=t:this.boardState.historyViewerState={isEnabled:!0,plyViewing:t,viewOnly:this.board.state.viewOnly},this.board.set({fen:s[t].before,viewOnly:!0,lastMove:t>0?[s[t-1].from,s[t-1].to]:void 0,selected:void 0}),this.displayInCheck(t>0?"+#".includes(s[t-1].san.at(-1)):!1,wn(s[t].color)),this.board.cancelPremove();else if(this.boardState.historyViewerState.isEnabled){const r=s.at(-1);this.board.set({fen:r.after,viewOnly:this.boardState.historyViewerState.viewOnly,lastMove:[r.from,r.to]}),this.boardState.historyViewerState={isEnabled:!1},this.updateGameState({updateFen:!1})}n&&this.board.set({animation:{enabled:!0}})}stopViewingHistory(){this.boardState.historyViewerState.isEnabled&&this.viewHistory(this.getCurrentPlyNumber())}viewStart(){this.viewHistory(0)}viewNext(){this.boardState.historyViewerState.isEnabled&&this.viewHistory(this.boardState.historyViewerState.plyViewing+1)}viewPrevious(){const t=this.boardState.historyViewerState.isEnabled?this.boardState.historyViewerState.plyViewing:this.getCurrentPlyNumber();this.viewHistory(t-1)}}const Yh={class:"main-board"},Co=rl({__name:"TheChessboard",props:{boardConfig:{default:()=>({})},playerColor:{},reactiveConfig:{type:Boolean,default:!1}},emits:["boardCreated","check","checkmate","stalemate","draw","promotion","move"],setup(e,{emit:t}){const s=e,n=Ye(null),r=Jt({showThreats:!1,promotionDialogState:{isEnabled:!1},historyViewerState:{isEnabled:!1}});return al(()=>{if(n.value==null)throw new Error("vue3-chessboard: Failed to mount board.");const i=new Gh(n.value,r,s,t);if(t("boardCreated",i),s.reactiveConfig){let o=jn(s.boardConfig);zs(Jt(s.boardConfig),l=>{i.setConfig(Fl(o,l)),o=jn(l)})}}),(i,o)=>($e(),ot("section",{class:cn(["main-wrap",{disabledBoard:r.promotionDialogState.isEnabled,viewingHistory:r.historyViewerState.isEnabled}])},[pe("div",Yh,[r.promotionDialogState.isEnabled?($e(),qn(lu,{key:0,state:r.promotionDialogState,onPromotionSelected:o[0]||(o[0]=l=>r.promotionDialogState={isEnabled:!1})},null,8,["state"])):Cs("",!0),pe("div",{ref_key:"boardElement",ref:n},null,512)])],2))}});function zh(e){return e!==null?{comment:e,variations:[]}:{variations:[]}}function Zh(e,t,s,n,r){const i={move:e,variations:r};return t&&(i.suffix=t),s&&(i.nag=s),n!==null&&(i.comment=n),i}function Jh(...e){const[t,...s]=e;let n=t;for(const r of s)r!==null&&(n.variations=[r,...r.variations],r.variations=[],n=r);return t}function Xh(e,t){if(t.marker&&t.marker.comment){let s=t.root;for(;;){const n=s.variations[0];if(!n){s.comment=t.marker.comment;break}s=n}}return{headers:e,root:t.root,result:(t.marker&&t.marker.result)??void 0}}function ed(e,t){function s(){this.constructor=e}s.prototype=t.prototype,e.prototype=new s}function Ms(e,t,s,n){var r=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(r,Ms.prototype),r.expected=t,r.found=s,r.location=n,r.name="SyntaxError",r}ed(Ms,Error);function wr(e,t,s){return s=s||" ",e.length>t?e:(t-=e.length,s+=s.repeat(t),e+s.slice(0,t))}Ms.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var s=null,n;for(n=0;n<e.length;n++)if(e[n].source===this.location.source){s=e[n].text.split(/\r\n|\n|\r/g);break}var r=this.location.start,i=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(r):r,o=this.location.source+":"+i.line+":"+i.column;if(s){var l=this.location.end,a=wr("",i.line.toString().length," "),c=s[r.line-1],f=r.line===l.line?l.column:c.length+1,d=f-r.column||1;t+=`
 --> `+o+`
`+a+` |
`+i.line+" | "+c+`
`+a+" | "+wr("",r.column-1," ")+wr("",d,"^")}else t+=`
 at `+o}return t};Ms.buildMessage=function(e,t){var s={literal:function(c){return'"'+r(c.text)+'"'},class:function(c){var f=c.parts.map(function(d){return Array.isArray(d)?i(d[0])+"-"+i(d[1]):i(d)});return"["+(c.inverted?"^":"")+f.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(c){return c.description}};function n(c){return c.charCodeAt(0).toString(16).toUpperCase()}function r(c){return c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(f){return"\\x0"+n(f)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(f){return"\\x"+n(f)})}function i(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(f){return"\\x0"+n(f)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(f){return"\\x"+n(f)})}function o(c){return s[c.type](c)}function l(c){var f=c.map(o),d,h;if(f.sort(),f.length>0){for(d=1,h=1;d<f.length;d++)f[d-1]!==f[d]&&(f[h]=f[d],h++);f.length=h}switch(f.length){case 1:return f[0];case 2:return f[0]+" or "+f[1];default:return f.slice(0,-1).join(", ")+", or "+f[f.length-1]}}function a(c){return c?'"'+r(c)+'"':"end of input"}return"Expected "+l(e)+" but "+a(t)+" found."};function td(e,t){t=t!==void 0?t:{};var s={},n=t.grammarSource,r={pgn:ki},i=ki,o="[",l='"',a="]",c=".",f="O-O-O",d="O-O",h="0-0-0",g="0-0",b="$",k="{",R="}",D=";",O="(",G=")",L="1-0",Z="0-1",_e="1/2-1/2",te="*",J=/^[a-zA-Z]/,Ae=/^[^"]/,fe=/^[0-9]/,me=/^[.]/,Ue=/^[a-zA-Z1-8\-=]/,Kt=/^[+#]/,Pt=/^[!?]/,ns=/^[^}]/,be=/^[^\r\n]/,ae=/^[ \t\r\n]/,se=rt("tag pair"),ut=Ce("[",!1),At=Ce('"',!1),et=Ce("]",!1),Fe=rt("tag name"),ht=vt([["a","z"],["A","Z"]],!1,!1),Os=rt("tag value"),rs=vt(['"'],!0,!1),_t=rt("move number"),dt=vt([["0","9"]],!1,!1),N=Ce(".",!1),I=vt(["."],!1,!1),j=rt("standard algebraic notation"),ue=Ce("O-O-O",!1),u=Ce("O-O",!1),p=Ce("0-0-0",!1),_=Ce("0-0",!1),v=vt([["a","z"],["A","Z"],["1","8"],"-","="],!1,!1),w=vt(["+","#"],!1,!1),E=rt("suffix annotation"),T=vt(["!","?"],!1,!1),P=rt("NAG"),A=Ce("$",!1),x=rt("brace comment"),F=Ce("{",!1),M=vt(["}"],!0,!1),q=Ce("}",!1),H=rt("rest of line comment"),ee=Ce(";",!1),ne=vt(["\r",`
`],!0,!1),re=rt("variation"),Te=Ce("(",!1),Me=Ce(")",!1),tt=rt("game termination marker"),st=Ce("1-0",!1),is=Ce("0-1",!1),dn=Ce("1/2-1/2",!1),qe=Ce("*",!1),nt=rt("whitespace"),Is=vt([" ","	","\r",`
`],!1,!1),pn=function(m,S){return Xh(m,S)},ga=function(m){return Object.fromEntries(m)},ma=function(m,S){return[m,S]},ba=function(m,S){return{root:m,marker:S}},_a=function(m,S){return Jh(zh(m),...S.flat())},va=function(m,S,C,B,U){return Zh(m,S,C,B,U)},ya=function(m){return m},wa=function(m){return m.replace(/[\r\n]+/g," ")},Sa=function(m){return m.trim()},Ca=function(m){return m},ka=function(m,S){return{result:m,comment:S}},y=t.peg$currPos|0,ys=[{line:1,column:1}],pt=y,gn=t.peg$maxFailExpected||[],$=t.peg$silentFails|0,$s;if(t.startRule){if(!(t.startRule in r))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');i=r[t.startRule]}function Ce(m,S){return{type:"literal",text:m,ignoreCase:S}}function vt(m,S,C){return{type:"class",parts:m,inverted:S,ignoreCase:C}}function Ea(){return{type:"end"}}function rt(m){return{type:"other",description:m}}function Si(m){var S=ys[m],C;if(S)return S;if(m>=ys.length)C=ys.length-1;else for(C=m;!ys[--C];);for(S=ys[C],S={line:S.line,column:S.column};C<m;)e.charCodeAt(C)===10?(S.line++,S.column=1):S.column++,C++;return ys[m]=S,S}function Ci(m,S,C){var B=Si(m),U=Si(S),le={source:n,start:{offset:m,line:B.line,column:B.column},end:{offset:S,line:U.line,column:U.column}};return le}function K(m){y<pt||(y>pt&&(pt=y,gn=[]),gn.push(m))}function xa(m,S,C){return new Ms(Ms.buildMessage(m,S),m,S,C)}function ki(){var m,S,C;return m=y,S=Pa(),C=Ma(),m=pn(S,C),m}function Pa(){var m,S,C;for(m=y,S=[],C=Ei();C!==s;)S.push(C),C=Ei();return C=De(),m=ga(S),m}function Ei(){var m,S,C,B,U,le,os;return $++,m=y,De(),e.charCodeAt(y)===91?(S=o,y++):(S=s,$===0&&K(ut)),S!==s?(De(),C=Aa(),C!==s?(De(),e.charCodeAt(y)===34?(B=l,y++):(B=s,$===0&&K(At)),B!==s?(U=Ta(),e.charCodeAt(y)===34?(le=l,y++):(le=s,$===0&&K(At)),le!==s?(De(),e.charCodeAt(y)===93?(os=a,y++):(os=s,$===0&&K(et)),os!==s?m=ma(C,U):(y=m,m=s)):(y=m,m=s)):(y=m,m=s)):(y=m,m=s)):(y=m,m=s),$--,m===s&&$===0&&K(se),m}function Aa(){var m,S,C;if($++,m=y,S=[],C=e.charAt(y),J.test(C)?y++:(C=s,$===0&&K(ht)),C!==s)for(;C!==s;)S.push(C),C=e.charAt(y),J.test(C)?y++:(C=s,$===0&&K(ht));else S=s;return S!==s?m=e.substring(m,y):m=S,$--,m===s&&(S=s,$===0&&K(Fe)),m}function Ta(){var m,S,C;for($++,m=y,S=[],C=e.charAt(y),Ae.test(C)?y++:(C=s,$===0&&K(rs));C!==s;)S.push(C),C=e.charAt(y),Ae.test(C)?y++:(C=s,$===0&&K(rs));return m=e.substring(m,y),$--,S=s,$===0&&K(Os),m}function Ma(){var m,S,C;return m=y,S=xi(),De(),C=La(),C===s&&(C=null),De(),m=ba(S,C),m}function xi(){var m,S,C,B;for(m=y,S=nr(),S===s&&(S=null),C=[],B=Pi();B!==s;)C.push(B),B=Pi();return m=_a(S,C),m}function Pi(){var m,S,C,B,U,le,os,mn;if(m=y,De(),Oa(),De(),S=Ia(),S!==s){for(C=$a(),C===s&&(C=null),B=[],U=Ai();U!==s;)B.push(U),U=Ai();for(U=De(),le=nr(),le===s&&(le=null),os=[],mn=Ti();mn!==s;)os.push(mn),mn=Ti();m=va(S,C,B,le,os)}else y=m,m=s;return m}function Oa(){var m,S,C,B,U,le;for($++,m=y,S=[],C=e.charAt(y),fe.test(C)?y++:(C=s,$===0&&K(dt));C!==s;)S.push(C),C=e.charAt(y),fe.test(C)?y++:(C=s,$===0&&K(dt));if(e.charCodeAt(y)===46?(C=c,y++):(C=s,$===0&&K(N)),C!==s){for(B=De(),U=[],le=e.charAt(y),me.test(le)?y++:(le=s,$===0&&K(I));le!==s;)U.push(le),le=e.charAt(y),me.test(le)?y++:(le=s,$===0&&K(I));S=[S,C,B,U],m=S}else y=m,m=s;return $--,m===s&&(S=s,$===0&&K(_t)),m}function Ia(){var m,S,C,B,U,le;if($++,m=y,S=y,e.substr(y,5)===f?(C=f,y+=5):(C=s,$===0&&K(ue)),C===s&&(e.substr(y,3)===d?(C=d,y+=3):(C=s,$===0&&K(u)),C===s&&(e.substr(y,5)===h?(C=h,y+=5):(C=s,$===0&&K(p)),C===s&&(e.substr(y,3)===g?(C=g,y+=3):(C=s,$===0&&K(_)),C===s))))if(C=y,B=e.charAt(y),J.test(B)?y++:(B=s,$===0&&K(ht)),B!==s){if(U=[],le=e.charAt(y),Ue.test(le)?y++:(le=s,$===0&&K(v)),le!==s)for(;le!==s;)U.push(le),le=e.charAt(y),Ue.test(le)?y++:(le=s,$===0&&K(v));else U=s;U!==s?(B=[B,U],C=B):(y=C,C=s)}else y=C,C=s;return C!==s?(B=e.charAt(y),Kt.test(B)?y++:(B=s,$===0&&K(w)),B===s&&(B=null),C=[C,B],S=C):(y=S,S=s),S!==s?m=e.substring(m,y):m=S,$--,m===s&&(S=s,$===0&&K(j)),m}function $a(){var m,S,C;for($++,m=y,S=[],C=e.charAt(y),Pt.test(C)?y++:(C=s,$===0&&K(T));C!==s;)S.push(C),S.length>=2?C=s:(C=e.charAt(y),Pt.test(C)?y++:(C=s,$===0&&K(T)));return S.length<1?(y=m,m=s):m=S,$--,m===s&&(S=s,$===0&&K(E)),m}function Ai(){var m,S,C,B,U;if($++,m=y,De(),e.charCodeAt(y)===36?(S=b,y++):(S=s,$===0&&K(A)),S!==s){if(C=y,B=[],U=e.charAt(y),fe.test(U)?y++:(U=s,$===0&&K(dt)),U!==s)for(;U!==s;)B.push(U),U=e.charAt(y),fe.test(U)?y++:(U=s,$===0&&K(dt));else B=s;B!==s?C=e.substring(C,y):C=B,C!==s?m=ya(C):(y=m,m=s)}else y=m,m=s;return $--,m===s&&$===0&&K(P),m}function nr(){var m;return m=Na(),m===s&&(m=Ra()),m}function Na(){var m,S,C,B,U;if($++,m=y,e.charCodeAt(y)===123?(S=k,y++):(S=s,$===0&&K(F)),S!==s){for(C=y,B=[],U=e.charAt(y),ns.test(U)?y++:(U=s,$===0&&K(M));U!==s;)B.push(U),U=e.charAt(y),ns.test(U)?y++:(U=s,$===0&&K(M));C=e.substring(C,y),e.charCodeAt(y)===125?(B=R,y++):(B=s,$===0&&K(q)),B!==s?m=wa(C):(y=m,m=s)}else y=m,m=s;return $--,m===s&&(S=s,$===0&&K(x)),m}function Ra(){var m,S,C,B,U;if($++,m=y,e.charCodeAt(y)===59?(S=D,y++):(S=s,$===0&&K(ee)),S!==s){for(C=y,B=[],U=e.charAt(y),be.test(U)?y++:(U=s,$===0&&K(ne));U!==s;)B.push(U),U=e.charAt(y),be.test(U)?y++:(U=s,$===0&&K(ne));C=e.substring(C,y),m=Sa(C)}else y=m,m=s;return $--,m===s&&(S=s,$===0&&K(H)),m}function Ti(){var m,S,C,B;return $++,m=y,De(),e.charCodeAt(y)===40?(S=O,y++):(S=s,$===0&&K(Te)),S!==s?(C=xi(),C!==s?(De(),e.charCodeAt(y)===41?(B=G,y++):(B=s,$===0&&K(Me)),B!==s?m=Ca(C):(y=m,m=s)):(y=m,m=s)):(y=m,m=s),$--,m===s&&$===0&&K(re),m}function La(){var m,S,C;return $++,m=y,e.substr(y,3)===L?(S=L,y+=3):(S=s,$===0&&K(st)),S===s&&(e.substr(y,3)===Z?(S=Z,y+=3):(S=s,$===0&&K(is)),S===s&&(e.substr(y,7)===_e?(S=_e,y+=7):(S=s,$===0&&K(dn)),S===s&&(e.charCodeAt(y)===42?(S=te,y++):(S=s,$===0&&K(qe))))),S!==s?(De(),C=nr(),C===s&&(C=null),m=ka(S,C)):(y=m,m=s),$--,m===s&&(S=s,$===0&&K(tt)),m}function De(){var m,S;for($++,m=[],S=e.charAt(y),ae.test(S)?y++:(S=s,$===0&&K(Is));S!==s;)m.push(S),S=e.charAt(y),ae.test(S)?y++:(S=s,$===0&&K(Is));return $--,S=s,$===0&&K(nt),m}if($s=i(),t.peg$library)return{peg$result:$s,peg$currPos:y,peg$FAILED:s,peg$maxFailExpected:gn,peg$maxFailPos:pt};if($s!==s&&y===e.length)return $s;throw $s!==s&&y<e.length&&K(Ea()),xa(gn,pt<e.length?e.charAt(pt):null,pt<e.length?Ci(pt,pt+1):Ci(pt,pt))}const On=0xffffffffffffffffn;function Sr(e,t){return(e<<t|e>>64n-t)&0xffffffffffffffffn}function ko(e,t){return e*t&On}function sd(e){return function(){let t=BigInt(e&On),s=BigInt(e>>64n&On);const n=ko(Sr(ko(t,5n),7n),9n);return s^=t,t=(Sr(t,24n)^s^s<<16n)&On,s=Sr(s,37n),e=s<<64n|t,n}}const sr=sd(0xa187eb39cdcaed8f31c4b365b102e01en),nd=Array.from({length:2},()=>Array.from({length:6},()=>Array.from({length:128},()=>sr()))),rd=Array.from({length:8},()=>sr()),id=Array.from({length:16},()=>sr()),Cr=sr(),Ie="w",ze="b",ve="p",Vr="n",In="b",Hs="r",zt="q",we="k",kr="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class Sn{color;from;to;piece;captured;promotion;flags;san;lan;before;after;constructor(t,s){const{color:n,piece:r,from:i,to:o,flags:l,captured:a,promotion:c}=s,f=xe(i),d=xe(o);this.color=n,this.piece=r,this.from=f,this.to=d,this.san=t._moveToSan(s,t._moves({legal:!0})),this.lan=f+d,this.before=t.fen(),t._makeMove(s),this.after=t.fen(),t._undoMove(),this.flags="";for(const h in W)W[h]&l&&(this.flags+=cs[h]);a&&(this.captured=a),c&&(this.promotion=c,this.lan+=c)}isCapture(){return this.flags.indexOf(cs.CAPTURE)>-1}isPromotion(){return this.flags.indexOf(cs.PROMOTION)>-1}isEnPassant(){return this.flags.indexOf(cs.EP_CAPTURE)>-1}isKingsideCastle(){return this.flags.indexOf(cs.KSIDE_CASTLE)>-1}isQueensideCastle(){return this.flags.indexOf(cs.QSIDE_CASTLE)>-1}isBigPawn(){return this.flags.indexOf(cs.BIG_PAWN)>-1}}const Pe=-1,cs={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q",NULL_MOVE:"-"},W={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64,NULL_MOVE:128},Wr={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},od={WhiteTitle:null,BlackTitle:null,WhiteElo:null,BlackElo:null,WhiteUSCF:null,BlackUSCF:null,WhiteNA:null,BlackNA:null,WhiteType:null,BlackType:null,EventDate:null,EventSponsor:null,Section:null,Stage:null,Board:null,Opening:null,Variation:null,SubVariation:null,ECO:null,NIC:null,Time:null,UTCTime:null,UTCDate:null,TimeControl:null,SetUp:null,FEN:null,Termination:null,Annotator:null,Mode:null,PlyCount:null},ld={...Wr,...od},V={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},Er={b:[16,32,17,15],w:[-16,-32,-17,-15]},Eo={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},ad=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],cd=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],fd={p:1,n:2,b:4,r:8,q:16,k:32},ud="pnbrqkPNBRQK",xo=[Vr,In,Hs,zt],hd=7,dd=6,pd=1,gd=0,Cn={[we]:W.KSIDE_CASTLE,[zt]:W.QSIDE_CASTLE},Ht={w:[{square:V.a1,flag:W.QSIDE_CASTLE},{square:V.h1,flag:W.KSIDE_CASTLE}],b:[{square:V.a8,flag:W.QSIDE_CASTLE},{square:V.h8,flag:W.KSIDE_CASTLE}]},md={b:pd,w:dd},xr="--";function gs(e){return e>>4}function ln(e){return e&15}function pa(e){return"0123456789".indexOf(e)!==-1}function xe(e){const t=ln(e),s=gs(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(s,s+1)}function Ds(e){return e===Ie?ze:Ie}function bd(e){const t=e.split(/\s+/);if(t.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const s=parseInt(t[5],10);if(isNaN(s)||s<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const n=parseInt(t[4],10);if(isNaN(n)||n<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const r=t[0].split("/");if(r.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let o=0;o<r.length;o++){let l=0,a=!1;for(let c=0;c<r[o].length;c++)if(pa(r[o][c])){if(a)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};l+=parseInt(r[o][c],10),a=!0}else{if(!/^[prnbqkPRNBQK]$/.test(r[o][c]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};l+=1,a=!1}if(l!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(t[3][1]=="3"&&t[1]=="w"||t[3][1]=="6"&&t[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const i=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:o,regex:l}of i){if(!l.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${o} king`};if((t[0].match(l)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${o} kings`}}return Array.from(r[0]+r[7]).some(o=>o.toUpperCase()==="P")?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}function _d(e,t){const s=e.from,n=e.to,r=e.piece;let i=0,o=0,l=0;for(let a=0,c=t.length;a<c;a++){const f=t[a].from,d=t[a].to,h=t[a].piece;r===h&&s!==f&&n===d&&(i++,gs(s)===gs(f)&&o++,ln(s)===ln(f)&&l++)}return i>0?o>0&&l>0?xe(s):l>0?xe(s).charAt(1):xe(s).charAt(0):""}function Ut(e,t,s,n,r,i=void 0,o=W.NORMAL){const l=gs(n);if(r===ve&&(l===hd||l===gd))for(let a=0;a<xo.length;a++){const c=xo[a];e.push({color:t,from:s,to:n,piece:r,captured:i,promotion:c,flags:o|W.PROMOTION})}else e.push({color:t,from:s,to:n,piece:r,captured:i,flags:o})}function Po(e){let t=e.charAt(0);return t>="a"&&t<="h"?e.match(/[a-h]\d.*[a-h]\d/)?void 0:ve:(t=t.toLowerCase(),t==="o"?we:t)}function Pr(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class kn{_board=new Array(128);_turn=Ie;_header={};_kings={w:Pe,b:Pe};_epSquare=-1;_halfMoves=0;_moveNumber=0;_history=[];_comments={};_castling={w:0,b:0};_hash=0n;_positionCount=new Map;constructor(t=kr,{skipValidation:s=!1}={}){this.load(t,{skipValidation:s})}clear({preserveHeaders:t=!1}={}){this._board=new Array(128),this._kings={w:Pe,b:Pe},this._turn=Ie,this._castling={w:0,b:0},this._epSquare=Pe,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=t?this._header:{...ld},this._hash=this._computeHash(),this._positionCount=new Map,this._header.SetUp=null,this._header.FEN=null}load(t,{skipValidation:s=!1,preserveHeaders:n=!1}={}){let r=t.split(/\s+/);if(r.length>=2&&r.length<6){const l=["-","-","0","1"];t=r.concat(l.slice(-(6-r.length))).join(" ")}if(r=t.split(/\s+/),!s){const{ok:l,error:a}=bd(t);if(!l)throw new Error(a)}const i=r[0];let o=0;this.clear({preserveHeaders:n});for(let l=0;l<i.length;l++){const a=i.charAt(l);if(a==="/")o+=8;else if(pa(a))o+=parseInt(a,10);else{const c=a<"a"?Ie:ze;this._put({type:a.toLowerCase(),color:c},xe(o)),o++}}this._turn=r[1],r[2].indexOf("K")>-1&&(this._castling.w|=W.KSIDE_CASTLE),r[2].indexOf("Q")>-1&&(this._castling.w|=W.QSIDE_CASTLE),r[2].indexOf("k")>-1&&(this._castling.b|=W.KSIDE_CASTLE),r[2].indexOf("q")>-1&&(this._castling.b|=W.QSIDE_CASTLE),this._epSquare=r[3]==="-"?Pe:V[r[3]],this._halfMoves=parseInt(r[4],10),this._moveNumber=parseInt(r[5],10),this._hash=this._computeHash(),this._updateSetup(t),this._incPositionCount()}fen({forceEnpassantSquare:t=!1}={}){let s=0,n="";for(let o=V.a8;o<=V.h1;o++){if(this._board[o]){s>0&&(n+=s,s=0);const{color:l,type:a}=this._board[o];n+=l===Ie?a.toUpperCase():a.toLowerCase()}else s++;o+1&136&&(s>0&&(n+=s),o!==V.h1&&(n+="/"),s=0,o+=8)}let r="";this._castling[Ie]&W.KSIDE_CASTLE&&(r+="K"),this._castling[Ie]&W.QSIDE_CASTLE&&(r+="Q"),this._castling[ze]&W.KSIDE_CASTLE&&(r+="k"),this._castling[ze]&W.QSIDE_CASTLE&&(r+="q"),r=r||"-";let i="-";if(this._epSquare!==Pe)if(t)i=xe(this._epSquare);else{const o=this._epSquare+(this._turn===Ie?16:-16),l=[o+1,o-1];for(const a of l){if(a&136)continue;const c=this._turn;if(this._board[a]?.color===c&&this._board[a]?.type===ve){this._makeMove({color:c,from:a,to:this._epSquare,piece:ve,captured:ve,flags:W.EP_CAPTURE});const f=!this._isKingAttacked(c);if(this._undoMove(),f){i=xe(this._epSquare);break}}}}return[n,this._turn,r,i,this._halfMoves,this._moveNumber].join(" ")}_pieceKey(t){if(!this._board[t])return 0n;const{color:s,type:n}=this._board[t],r={w:0,b:1}[s],i={p:0,n:1,b:2,r:3,q:4,k:5}[n];return nd[r][i][t]}_epKey(){return this._epSquare===Pe?0n:rd[this._epSquare&7]}_castlingKey(){const t=this._castling.w>>5|this._castling.b>>3;return id[t]}_computeHash(){let t=0n;for(let s=V.a8;s<=V.h1;s++){if(s&136){s+=7;continue}this._board[s]&&(t^=this._pieceKey(s))}return t^=this._epKey(),t^=this._castlingKey(),this._turn==="b"&&(t^=Cr),t}_updateSetup(t){this._history.length>0||(t!==kr?(this._header.SetUp="1",this._header.FEN=t):(this._header.SetUp=null,this._header.FEN=null))}reset(){this.load(kr)}get(t){return this._board[V[t]]}findPiece(t){const s=[];for(let n=V.a8;n<=V.h1;n++){if(n&136){n+=7;continue}!this._board[n]||this._board[n]?.color!==t.color||this._board[n].color===t.color&&this._board[n].type===t.type&&s.push(xe(n))}return s}put({type:t,color:s},n){return this._put({type:t,color:s},n)?(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0):!1}_set(t,s){this._hash^=this._pieceKey(t),this._board[t]=s,this._hash^=this._pieceKey(t)}_put({type:t,color:s},n){if(ud.indexOf(t.toLowerCase())===-1||!(n in V))return!1;const r=V[n];if(t==we&&!(this._kings[s]==Pe||this._kings[s]==r))return!1;const i=this._board[r];return i&&i.type===we&&(this._kings[i.color]=Pe),this._set(r,{type:t,color:s}),t===we&&(this._kings[s]=r),!0}_clear(t){this._hash^=this._pieceKey(t),delete this._board[t]}remove(t){const s=this.get(t);return this._clear(V[t]),s&&s.type===we&&(this._kings[s.color]=Pe),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),s}_updateCastlingRights(){this._hash^=this._castlingKey();const t=this._board[V.e1]?.type===we&&this._board[V.e1]?.color===Ie,s=this._board[V.e8]?.type===we&&this._board[V.e8]?.color===ze;(!t||this._board[V.a1]?.type!==Hs||this._board[V.a1]?.color!==Ie)&&(this._castling.w&=-65),(!t||this._board[V.h1]?.type!==Hs||this._board[V.h1]?.color!==Ie)&&(this._castling.w&=-33),(!s||this._board[V.a8]?.type!==Hs||this._board[V.a8]?.color!==ze)&&(this._castling.b&=-65),(!s||this._board[V.h8]?.type!==Hs||this._board[V.h8]?.color!==ze)&&(this._castling.b&=-33),this._hash^=this._castlingKey()}_updateEnPassantSquare(){if(this._epSquare===Pe)return;const t=this._epSquare+(this._turn===Ie?-16:16),s=this._epSquare+(this._turn===Ie?16:-16),n=[s+1,s-1];if(this._board[t]!==null||this._board[this._epSquare]!==null||this._board[s]?.color!==Ds(this._turn)||this._board[s]?.type!==ve){this._hash^=this._epKey(),this._epSquare=Pe;return}const r=i=>!(i&136)&&this._board[i]?.color===this._turn&&this._board[i]?.type===ve;n.some(r)||(this._hash^=this._epKey(),this._epSquare=Pe)}_attacked(t,s,n){const r=[];for(let i=V.a8;i<=V.h1;i++){if(i&136){i+=7;continue}if(this._board[i]===void 0||this._board[i].color!==t)continue;const o=this._board[i],l=i-s;if(l===0)continue;const a=l+119;if(ad[a]&fd[o.type]){if(o.type===ve){if(l>0&&o.color===Ie||l<=0&&o.color===ze)if(n)r.push(xe(i));else return!0;continue}if(o.type==="n"||o.type==="k")if(n){r.push(xe(i));continue}else return!0;const c=cd[a];let f=i+c,d=!1;for(;f!==s;){if(this._board[f]!=null){d=!0;break}f+=c}if(!d)if(n){r.push(xe(i));continue}else return!0}}return n?r:!1}attackers(t,s){return s?this._attacked(s,V[t],!0):this._attacked(this._turn,V[t],!0)}_isKingAttacked(t){const s=this._kings[t];return s===-1?!1:this._attacked(Ds(t),s)}hash(){return this._hash.toString(16)}isAttacked(t,s){return this._attacked(s,V[t])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const t={b:0,n:0,r:0,q:0,k:0,p:0},s=[];let n=0,r=0;for(let i=V.a8;i<=V.h1;i++){if(r=(r+1)%2,i&136){i+=7;continue}const o=this._board[i];o&&(t[o.type]=o.type in t?t[o.type]+1:1,o.type===In&&s.push(r),n++)}if(n===2)return!0;if(n===3&&(t[In]===1||t[Vr]===1))return!0;if(n===t[In]+2){let i=0;const o=s.length;for(let l=0;l<o;l++)i+=s[l];if(i===0||i===o)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this._hash)>=3}isDrawByFiftyMoves(){return this._halfMoves>=100}isDraw(){return this.isDrawByFiftyMoves()||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isDraw()}moves({verbose:t=!1,square:s=void 0,piece:n=void 0}={}){const r=this._moves({square:s,piece:n});return t?r.map(i=>new Sn(this,i)):r.map(i=>this._moveToSan(i,r))}_moves({legal:t=!0,piece:s=void 0,square:n=void 0}={}){const r=n?n.toLowerCase():void 0,i=s?.toLowerCase(),o=[],l=this._turn,a=Ds(l);let c=V.a8,f=V.h1,d=!1;if(r)if(r in V)c=f=V[r],d=!0;else return[];for(let g=c;g<=f;g++){if(g&136){g+=7;continue}if(!this._board[g]||this._board[g].color===a)continue;const{type:b}=this._board[g];let k;if(b===ve){if(i&&i!==b)continue;k=g+Er[l][0],this._board[k]||(Ut(o,l,g,k,ve),k=g+Er[l][1],md[l]===gs(g)&&!this._board[k]&&Ut(o,l,g,k,ve,void 0,W.BIG_PAWN));for(let R=2;R<4;R++)k=g+Er[l][R],!(k&136)&&(this._board[k]?.color===a?Ut(o,l,g,k,ve,this._board[k].type,W.CAPTURE):k===this._epSquare&&Ut(o,l,g,k,ve,ve,W.EP_CAPTURE))}else{if(i&&i!==b)continue;for(let R=0,D=Eo[b].length;R<D;R++){const O=Eo[b][R];for(k=g;k+=O,!(k&136);){if(!this._board[k])Ut(o,l,g,k,b);else{if(this._board[k].color===l)break;Ut(o,l,g,k,b,this._board[k].type,W.CAPTURE);break}if(b===Vr||b===we)break}}}}if((i===void 0||i===we)&&(!d||f===this._kings[l])){if(this._castling[l]&W.KSIDE_CASTLE){const g=this._kings[l],b=g+2;!this._board[g+1]&&!this._board[b]&&!this._attacked(a,this._kings[l])&&!this._attacked(a,g+1)&&!this._attacked(a,b)&&Ut(o,l,this._kings[l],b,we,void 0,W.KSIDE_CASTLE)}if(this._castling[l]&W.QSIDE_CASTLE){const g=this._kings[l],b=g-2;!this._board[g-1]&&!this._board[g-2]&&!this._board[g-3]&&!this._attacked(a,this._kings[l])&&!this._attacked(a,g-1)&&!this._attacked(a,b)&&Ut(o,l,this._kings[l],b,we,void 0,W.QSIDE_CASTLE)}}if(!t||this._kings[l]===-1)return o;const h=[];for(let g=0,b=o.length;g<b;g++)this._makeMove(o[g]),this._isKingAttacked(l)||h.push(o[g]),this._undoMove();return h}move(t,{strict:s=!1}={}){let n=null;if(typeof t=="string")n=this._moveFromSan(t,s);else if(t===null)n=this._moveFromSan(xr,s);else if(typeof t=="object"){const i=this._moves();for(let o=0,l=i.length;o<l;o++)if(t.from===xe(i[o].from)&&t.to===xe(i[o].to)&&(!("promotion"in i[o])||t.promotion===i[o].promotion)){n=i[o];break}}if(!n)throw typeof t=="string"?new Error(`Invalid move: ${t}`):new Error(`Invalid move: ${JSON.stringify(t)}`);if(this.isCheck()&&n.flags&W.NULL_MOVE)throw new Error("Null move not allowed when in check");const r=new Sn(this,n);return this._makeMove(n),this._incPositionCount(),r}_push(t){this._history.push({move:t,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_movePiece(t,s){this._hash^=this._pieceKey(t),this._board[s]=this._board[t],delete this._board[t],this._hash^=this._pieceKey(s)}_makeMove(t){const s=this._turn,n=Ds(s);if(this._push(t),t.flags&W.NULL_MOVE){s===ze&&this._moveNumber++,this._halfMoves++,this._turn=n,this._epSquare=Pe;return}if(this._hash^=this._epKey(),this._hash^=this._castlingKey(),t.captured&&(this._hash^=this._pieceKey(t.to)),this._movePiece(t.from,t.to),t.flags&W.EP_CAPTURE&&(this._turn===ze?this._clear(t.to-16):this._clear(t.to+16)),t.promotion&&(this._clear(t.to),this._set(t.to,{type:t.promotion,color:s})),this._board[t.to].type===we){if(this._kings[s]=t.to,t.flags&W.KSIDE_CASTLE){const r=t.to-1,i=t.to+1;this._movePiece(i,r)}else if(t.flags&W.QSIDE_CASTLE){const r=t.to+1,i=t.to-2;this._movePiece(i,r)}this._castling[s]=0}if(this._castling[s]){for(let r=0,i=Ht[s].length;r<i;r++)if(t.from===Ht[s][r].square&&this._castling[s]&Ht[s][r].flag){this._castling[s]^=Ht[s][r].flag;break}}if(this._castling[n]){for(let r=0,i=Ht[n].length;r<i;r++)if(t.to===Ht[n][r].square&&this._castling[n]&Ht[n][r].flag){this._castling[n]^=Ht[n][r].flag;break}}if(this._hash^=this._castlingKey(),t.flags&W.BIG_PAWN){let r;s===ze?r=t.to-16:r=t.to+16,!(t.to-1&136)&&this._board[t.to-1]?.type===ve&&this._board[t.to-1]?.color===n||!(t.to+1&136)&&this._board[t.to+1]?.type===ve&&this._board[t.to+1]?.color===n?(this._epSquare=r,this._hash^=this._epKey()):this._epSquare=Pe}else this._epSquare=Pe;t.piece===ve?this._halfMoves=0:t.flags&(W.CAPTURE|W.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,s===ze&&this._moveNumber++,this._turn=n,this._hash^=Cr}undo(){const t=this._hash,s=this._undoMove();if(s){const n=new Sn(this,s);return this._decPositionCount(t),n}return null}_undoMove(){const t=this._history.pop();if(t===void 0)return null;this._hash^=this._epKey(),this._hash^=this._castlingKey();const s=t.move;this._kings=t.kings,this._turn=t.turn,this._castling=t.castling,this._epSquare=t.epSquare,this._halfMoves=t.halfMoves,this._moveNumber=t.moveNumber,this._hash^=this._epKey(),this._hash^=this._castlingKey(),this._hash^=Cr;const n=this._turn,r=Ds(n);if(s.flags&W.NULL_MOVE)return s;if(this._movePiece(s.to,s.from),s.piece&&(this._clear(s.from),this._set(s.from,{type:s.piece,color:n})),s.captured)if(s.flags&W.EP_CAPTURE){let i;n===ze?i=s.to-16:i=s.to+16,this._set(i,{type:ve,color:r})}else this._set(s.to,{type:s.captured,color:r});if(s.flags&(W.KSIDE_CASTLE|W.QSIDE_CASTLE)){let i,o;s.flags&W.KSIDE_CASTLE?(i=s.to+1,o=s.to-1):(i=s.to-2,o=s.to+1),this._movePiece(o,i)}return s}pgn({newline:t=`
`,maxWidth:s=0}={}){const n=[];let r=!1;for(const h in this._header)this._header[h]&&n.push(`[${h} "${this._header[h]}"]`+t),r=!0;r&&this._history.length&&n.push(t);const i=h=>{const g=this._comments[this.fen()];if(typeof g<"u"){const b=h.length>0?" ":"";h=`${h}${b}{${g}}`}return h},o=[];for(;this._history.length>0;)o.push(this._undoMove());const l=[];let a="";for(o.length===0&&l.push(i(""));o.length>0;){a=i(a);const h=o.pop();if(!h)break;if(!this._history.length&&h.color==="b"){const g=`${this._moveNumber}. ...`;a=a?`${a} ${g}`:g}else h.color==="w"&&(a.length&&l.push(a),a=this._moveNumber+".");a=a+" "+this._moveToSan(h,this._moves({legal:!0})),this._makeMove(h)}if(a.length&&l.push(i(a)),l.push(this._header.Result||"*"),s===0)return n.join("")+l.join(" ");const c=function(){return n.length>0&&n[n.length-1]===" "?(n.pop(),!0):!1},f=function(h,g){for(const b of g.split(" "))if(b){if(h+b.length>s){for(;c();)h--;n.push(t),h=0}n.push(b),h+=b.length,n.push(" "),h++}return c()&&h--,h};let d=0;for(let h=0;h<l.length;h++){if(d+l[h].length>s&&l[h].includes("{")){d=f(d,l[h]);continue}d+l[h].length>s&&h!==0?(n[n.length-1]===" "&&n.pop(),n.push(t),d=0):h!==0&&(n.push(" "),d++),n.push(l[h]),d+=l[h].length}return n.join("")}header(...t){for(let s=0;s<t.length;s+=2)typeof t[s]=="string"&&typeof t[s+1]=="string"&&(this._header[t[s]]=t[s+1]);return this._header}setHeader(t,s){return this._header[t]=s??Wr[t]??null,this.getHeaders()}removeHeader(t){return t in this._header?(this._header[t]=Wr[t]||null,!0):!1}getHeaders(){const t={};for(const[s,n]of Object.entries(this._header))n!==null&&(t[s]=n);return t}loadPgn(t,{strict:s=!1,newlineChar:n=`\r?
`}={}){n!==`\r?
`&&(t=t.replace(new RegExp(n,"g"),`
`));const r=td(t);this.reset();const i=r.headers;let o="";for(const c in i)c.toLowerCase()==="fen"&&(o=i[c]),this.header(c,i[c]);if(!s)o&&this.load(o,{preserveHeaders:!0});else if(i.SetUp==="1"){if(!("FEN"in i))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(i.FEN,{preserveHeaders:!0})}let l=r.root;for(;l;){if(l.move){const c=this._moveFromSan(l.move,s);if(c==null)throw new Error(`Invalid move in PGN: ${l.move}`);this._makeMove(c),this._incPositionCount()}l.comment!==void 0&&(this._comments[this.fen()]=l.comment),l=l.variations[0]}const a=r.result;a&&Object.keys(this._header).length&&this._header.Result!==a&&this.setHeader("Result",a)}_moveToSan(t,s){let n="";if(t.flags&W.KSIDE_CASTLE)n="O-O";else if(t.flags&W.QSIDE_CASTLE)n="O-O-O";else{if(t.flags&W.NULL_MOVE)return xr;if(t.piece!==ve){const r=_d(t,s);n+=t.piece.toUpperCase()+r}t.flags&(W.CAPTURE|W.EP_CAPTURE)&&(t.piece===ve&&(n+=xe(t.from)[0]),n+="x"),n+=xe(t.to),t.promotion&&(n+="="+t.promotion.toUpperCase())}return this._makeMove(t),this.isCheck()&&(this.isCheckmate()?n+="#":n+="+"),this._undoMove(),n}_moveFromSan(t,s=!1){let n=Pr(t);if(s||(n==="0-0"?n="O-O":n==="0-0-0"&&(n="O-O-O")),n==xr)return{color:this._turn,from:0,to:0,piece:"k",flags:W.NULL_MOVE};let r=Po(n),i=this._moves({legal:!0,piece:r});for(let h=0,g=i.length;h<g;h++)if(n===Pr(this._moveToSan(i[h],i)))return i[h];if(s)return null;let o,l,a,c,f,d=!1;if(l=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),l?(o=l[1],a=l[2],c=l[3],f=l[4],a.length==1&&(d=!0)):(l=n.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),l&&(o=l[1],a=l[2],c=l[3],f=l[4],a.length==1&&(d=!0))),r=Po(n),i=this._moves({legal:!0,piece:o||r}),!c)return null;for(let h=0,g=i.length;h<g;h++)if(a){if((!o||o.toLowerCase()==i[h].piece)&&V[a]==i[h].from&&V[c]==i[h].to&&(!f||f.toLowerCase()==i[h].promotion))return i[h];if(d){const b=xe(i[h].from);if((!o||o.toLowerCase()==i[h].piece)&&V[c]==i[h].to&&(a==b[0]||a==b[1])&&(!f||f.toLowerCase()==i[h].promotion))return i[h]}}else if(n===Pr(this._moveToSan(i[h],i)).replace("x",""))return i[h];return null}ascii(){let t=`   +------------------------+
`;for(let s=V.a8;s<=V.h1;s++){if(ln(s)===0&&(t+=" "+"87654321"[gs(s)]+" |"),this._board[s]){const n=this._board[s].type,i=this._board[s].color===Ie?n.toUpperCase():n.toLowerCase();t+=" "+i+" "}else t+=" . ";s+1&136&&(t+=`|
`,s+=8)}return t+=`   +------------------------+
`,t+="     a  b  c  d  e  f  g  h",t}perft(t){const s=this._moves({legal:!1});let n=0;const r=this._turn;for(let i=0,o=s.length;i<o;i++)this._makeMove(s[i]),this._isKingAttacked(r)||(t-1>0?n+=this.perft(t-1):n++),this._undoMove();return n}setTurn(t){return this._turn==t?!1:(this.move("--"),!0)}turn(){return this._turn}board(){const t=[];let s=[];for(let n=V.a8;n<=V.h1;n++)this._board[n]==null?s.push(null):s.push({square:xe(n),type:this._board[n].type,color:this._board[n].color}),n+1&136&&(t.push(s),s=[],n+=8);return t}squareColor(t){if(t in V){const s=V[t];return(gs(s)+ln(s))%2===0?"light":"dark"}return null}history({verbose:t=!1}={}){const s=[],n=[];for(;this._history.length>0;)s.push(this._undoMove());for(;;){const r=s.pop();if(!r)break;t?n.push(new Sn(this,r)):n.push(this._moveToSan(r,this._moves())),this._makeMove(r)}return n}_getPositionCount(t){return this._positionCount.get(t)??0}_incPositionCount(){this._positionCount.set(this._hash,(this._positionCount.get(this._hash)??0)+1)}_decPositionCount(t){const s=this._positionCount.get(t)??0;s===1?this._positionCount.delete(t):this._positionCount.set(t,s-1)}_pruneComments(){const t=[],s={},n=r=>{r in this._comments&&(s[r]=this._comments[r])};for(;this._history.length>0;)t.push(this._undoMove());for(n(this.fen());;){const r=t.pop();if(!r)break;this._makeMove(r),n(this.fen())}this._comments=s}getComment(){return this._comments[this.fen()]}setComment(t){this._comments[this.fen()]=t.replace("{","[").replace("}","]")}deleteComment(){return this.removeComment()}removeComment(){const t=this._comments[this.fen()];return delete this._comments[this.fen()],t}getComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>({fen:t,comment:this._comments[t]}))}deleteComments(){return this.removeComments()}removeComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>{const s=this._comments[t];return delete this._comments[t],{fen:t,comment:s}})}setCastlingRights(t,s){for(const r of[we,zt])s[r]!==void 0&&(s[r]?this._castling[t]|=Cn[r]:this._castling[t]&=~Cn[r]);this._updateCastlingRights();const n=this.getCastlingRights(t);return(s[we]===void 0||s[we]===n[we])&&(s[zt]===void 0||s[zt]===n[zt])}getCastlingRights(t){return{[we]:(this._castling[t]&Cn[we])!==0,[zt]:(this._castling[t]&Cn[zt])!==0}}moveNumber(){return this._moveNumber}}const vd=(e,t)=>{const s=e.__vccOpts||e;for(const[n,r]of t)s[n]=r;return s},yd={class:"app"},wd={class:"app-main"},Sd={class:"controls"},Cd={key:0,class:"controls-row"},kd=["disabled"],Ed=["value"],xd={key:1,class:"controls-row"},Pd={class:"hint"},Ad={key:2,class:"hint"},Td={key:3,class:"hint"},Md={key:4,class:"hint"},Od={class:"messages"},Id={key:0,class:"info"},$d={key:1,class:"error"},Nd={class:"board-wrapper"},Rd={__name:"App",setup(e){const t=Ye(null),s=Ye(null),n=Ye(""),r=Ye("w"),i=Ye(""),o=Ye(""),l=[{value:"k",label:"King"},{value:"q",label:"Queen"},{value:"r",label:"Rook"},{value:"b",label:"Bishop"},{value:"n",label:"Knight"},{value:"p",label:"Pawn"}];function a(N){return N[Math.floor(Math.random()*N.length)]}const c=["a","b","c","d","e","f","g","h"],f=["1","2"],d=["7","8"],h=Ye(""),g=Ye(""),b=Jt({}),k=Ye(1),R=Ye(!0),D=An(()=>k.value%2===1?"white":"black"),O=An(()=>{const I=(k.value-1)%4;return I===0||I===1}),G=An(()=>{if(!R.value)return"Placement phase finished. Standard chess game has started.";const N=D.value==="white"?"White":"Black";return O.value?`${N} must place a pawn.`:`${N} must place a piece (non-pawn).`}),L=Jt({fen:"4k3/8/8/8/8/8/8/4K3 w - - 0 1",coordinates:!0,viewOnly:!1,movable:{free:!1,color:"white",showDests:!1},selectable:{enabled:!0},draggable:{enabled:!1},highlight:{lastMove:!0,check:!0},events:{select:rs}}),Z=Jt({fen:"start",coordinates:!0,viewOnly:!1,movable:{free:!1,color:"white",showDests:!0},selectable:{enabled:!0},draggable:{enabled:!0},highlight:{lastMove:!0,check:!0},events:{}});function _e(N){t.value=N,_t()}function te(N){return/^[a-h][1-8]$/.test(N)?{file:N[0],rank:parseInt(N[1],10)}:null}function J(N){const I=te(N);if(!I)return null;const j=I.file.charCodeAt(0)-97,ue=I.rank-1;return(j+ue)%2===0?"dark":"light"}function Ae(N){const I=te(N);if(!I)return[];const j=[],ue=I.file.charCodeAt(0)-97,u=I.rank;for(let p=-1;p<=1;p+=1)for(let _=-1;_<=1;_+=1){const v=ue+p,w=u+_;if(v<0||v>7||w<1||w>8)continue;const E=String.fromCharCode(97+v);j.push(`${E}${w}`)}return j}const fe=Ye([]),me=Ye([]);function Ue(N,I){return I==="white"?me.value.includes(N):I==="black"?fe.value.includes(N):!1}function Kt(N,I){return Object.entries(b).filter(([j,ue])=>ue.color!==N||ue.role!=="bishop"?!1:J(j)===I).length}function Pt(N,I){return Object.values(b).filter(j=>j.color===N&&j.role===I).length}function ns(N){return Pt(N,"pawn")}const be={pawn:8,rook:2,bishop:2,knight:2,queen:1,king:1};function ae(N){const I=N==="p",j=!I,ue=O.value;return!(ue&&!I||!ue&&!j)}function se(N){const I=[],j={};for(const u of c)j[u]=Object.entries(b).some(([p,_])=>{if(_.color!==N||_.role!=="pawn")return!1;const v=te(p);return v?v.file===u:!1});let ue=!1;for(const u of c){if(j[u])continue;let p=!1;for(let _=1;_<=8;_+=1){const v=`${u}${_}`,w=te(v);if(w){if(N==="white"){if(w.rank<2||w.rank>5)continue}else if(w.rank<4||w.rank>7)continue;if(!b[v]){p=!0;break}}}if(p){ue=!0;break}}for(const u of c)for(let p=1;p<=8;p+=1){const _=`${u}${p}`,v=te(_);if(!v||b[_])continue;if(N==="white"){if(v.rank<2||v.rank>5)continue}else if(v.rank<4||v.rank>7)continue;if(!j[u]){I.push(_);continue}ue||I.push(_)}return I}function ut(N,I){const j=te(N);if(!j)return{ok:!1,reason:"Invalid square."};const{file:ue,rank:u}=j;if(I==="white"){if(u<2||u>5)return{ok:!1,reason:`White pawns may only be placed on ranks 25. Legal white pawn squares given the current position: ${se(I).join(", ")}`}}else if(I==="black"&&(u<4||u>7))return{ok:!1,reason:`Black pawns may only be placed on ranks 47. Legal black pawn squares given the current position: ${se(I).join(", ")}`};if(ns(I)>=be.pawn)return{ok:!1,reason:`You may not place more than ${be.pawn} pawns for ${I}.`};if(!Object.entries(b).some(([T,P])=>{if(P.color!==I||P.role!=="pawn")return!1;const A=te(T);return A?A.file===ue:!1}))return{ok:!0};let v=!1;for(const T of c){if(Object.entries(b).some(([x,F])=>{if(F.color!==I||F.role!=="pawn")return!1;const M=te(x);return M?M.file===T:!1}))continue;let A=!1;for(let x=1;x<=8;x+=1){const F=`${T}${x}`,M=te(F);if(M){if(I==="white"){if(M.rank<2||M.rank>5)continue}else if(M.rank<4||M.rank>7)continue;if(!b[F]){A=!0;break}}}if(A){v=!0;break}}if(!v)return{ok:!0};const E=se(I).join(", ");return{ok:!1,reason:`You may only have one pawn per file unless there are no pawnless files with legal pawn squares for this color. Currently available pawn squares for ${I}: ${E}`}}function At(N,I){const j=J(N);return j?Kt(I,j)>=1?{ok:!1,reason:`You may only have one ${j}-squared bishop for ${I}.`}:{ok:!0}:{ok:!1,reason:"Invalid square."}}function et(N,I){const j=be[N];return j==null?!0:Pt(I,N)>=j?{ok:!1,reason:`You may not place more than ${j} ${N}${j>1?"s":""} for ${I}.`}:{ok:!0}}function Fe(){if(!R.value)return"";const N=O.value,I=D.value;if(N)return"p";const j=["n","b","r","q"],ue={n:"knight",b:"bishop",r:"rook",q:"queen"};for(const u of j){const p=ue[u],_=et(p,I);if(_===!0||_.ok)return u}return"p"}function ht(N){const I=Array.from({length:8},()=>Array(8).fill(null)),j=v=>{if(!/^[a-h][1-8]$/.test(v))return null;const w=v.charCodeAt(0)-97;return[7-(parseInt(v[1],10)-1),w]},ue=v=>{if(!v)return null;const w={king:"k",queen:"q",rook:"r",bishop:"b",knight:"n",pawn:"p"}[v.role];return w?v.color==="white"?w.toUpperCase():w:null};Object.entries(N).forEach(([v,w])=>{const E=j(v);if(!E)return;const[T,P]=E,A=ue(w);A&&(I[T][P]=A)});const u=I.some(v=>v.includes("K")),p=I.some(v=>v.includes("k"));if(!u){const v=j("e1");if(v){const[w,E]=v;I[w][E]||(I[w][E]="K")}}if(!p){const v=j("e8");if(v){const[w,E]=v;I[w][E]||(I[w][E]="k")}}return`${I.map(v=>{let w="",E=0;for(let T=0;T<8;T+=1){const P=v[T];P?(E>0&&(w+=String(E),E=0),w+=P):E+=1}return E>0&&(w+=String(E)),w||"8"}).join("/")} w - - 0 1`}function Os(N,I,j){const ue=ht(b),u=new kn(ue),p={king:"k",queen:"q",rook:"r",bishop:"b",knight:"n",pawn:"p"}[j];if(!p)return!1;const _=te(N);if(!_)return!1;const v=u.board(),w=N.charCodeAt(0)-97,T=7-(_.rank-1);v[T][w]={type:p,color:I==="white"?"w":"b"};let P="";for(let M=0;M<8;M+=1){let q=0;for(let H=0;H<8;H+=1){const ee=v[M][H];if(!ee)q+=1;else{q>0&&(P+=String(q),q=0);const ne=ee.type;P+=ee.color==="w"?ne.toUpperCase():ne}}q>0&&(P+=String(q)),M<7&&(P+="/")}const x=`${P} ${I==="white"?"b":"w"} - - 0 1`,F=new kn(x);return typeof F.inCheck=="function"?F.inCheck():!1}function rs(N){if(!R.value||(i.value="",o.value="",!t.value))return;if(!n.value){i.value="Please select a piece first.";return}if(!N||typeof N!="string")return;const I=D.value,j=I==="white"?"w":"b";if(r.value=j,b[N]){i.value=`Square ${N} is already occupied. Please choose an empty square.`;return}const u={k:"king",q:"queen",r:"rook",b:"bishop",n:"knight",p:"pawn"}[n.value];if(!u)return;const p=I;if(!ae(n.value)){i.value=O.value?"This move must be a pawn placement.":"This move must be a piece (non-pawn) placement.";return}if(u!=="king"){const v=et(u,p);if(!v.ok){i.value=v.reason;return}}if(Ue(N,p)){i.value="You may not place a piece on the 33 safe zone around the opponent king.";return}if(u==="pawn"){const v=ut(N,p);if(!v.ok){i.value=v.reason;return}}if(u==="bishop"){const v=At(N,p);if(!v.ok){i.value=v.reason;return}}if(Os(N,p,u)){i.value="You may not place a piece that puts the opponent in check.";return}b[N]={color:p,role:u};const _=ht(b);t.value.setPosition(_),k.value+=1}function _t(){Object.keys(b).forEach(I=>{delete b[I]}),h.value=a(c)+a(f),g.value=a(c)+a(d),b[h.value]={color:"white",role:"king"},b[g.value]={color:"black",role:"king"},fe.value=Ae(h.value),me.value=Ae(g.value),k.value=1,R.value=!0,n.value="",r.value="w",i.value="",o.value="Placement phase: White pawn, Black pawn, White piece, Black piece, then repeat.";const N=ht(b);L.fen=N,L.viewOnly=!1,L.movable.free=!1,L.events.select=rs,t.value&&t.value.setPosition(N),s.value=new kn(N),n.value=Fe()}function dt(){if(!R.value)return;const N=ht(b);s.value=new kn(N),Z.fen=N,Z.viewOnly=!1,R.value=!1,i.value="",o.value="Standard chess game started."}return zs(()=>k.value,()=>{R.value&&(n.value=Fe(),r.value=D.value==="white"?"w":"b")}),(N,I)=>($e(),ot("div",yd,[I[6]||(I[6]=pe("header",{class:"app-header"},[pe("h1",null,"Custom Chess Variant  Placement & Play"),pe("p",{class:"app-subtitle"},' Step 1.2: Place pieces according to the variant rules. Kings are pre-placed; safe zones, pawn limits, bishop limits, per-piece limits, alternating colors, and "no check" placement are enforced. Then play a standard chess game from the resulting position. ')],-1)),pe("main",wd,[pe("section",Sd,[pe("div",{class:"controls-row controls-row-buttons"},[pe("button",{type:"button",class:"primary-button",onClick:_t}," Reset game "),pe("button",{type:"button",class:"secondary-button",onClick:dt}," Start chess game ")]),R.value?($e(),ot("div",Cd,[I[3]||(I[3]=pe("label",{class:"control-label",for:"piece-select"},"Piece:",-1)),Ri(pe("select",{id:"piece-select","onUpdate:modelValue":I[0]||(I[0]=j=>n.value=j),class:"control-select",disabled:!R.value},[I[2]||(I[2]=pe("option",{disabled:"",value:""},"-- choose a piece --",-1)),($e(),ot(gt,null,fl(l,j=>pe("option",{key:j.value,value:j.value},Ks(j.label),9,Ed)),64))],8,kd),[[oo,n.value]])])):Cs("",!0),R.value?($e(),ot("div",xd,[I[5]||(I[5]=pe("label",{class:"control-label",for:"color-select"},"Side to place:",-1)),Ri(pe("select",{id:"color-select","onUpdate:modelValue":I[1]||(I[1]=j=>r.value=j),class:"control-select",disabled:""},[...I[4]||(I[4]=[pe("option",{value:"w"},"White",-1),pe("option",{value:"b"},"Black",-1)])],512),[[oo,r.value]])])):Cs("",!0),pe("p",Pd,Ks(G.value),1),R.value?($e(),ot("p",Ad," A recommended piece is auto-selected for you (Knight  Bishop  Rook  Queen on piece moves). You can still change the selection manually before clicking a square. ")):Cs("",!0),R.value?($e(),ot("p",Td," 1. Confirm or change the selected piece. 2. Click a legal square on the board to place that piece. 3. Illegal placements are rejected with a message below. ")):($e(),ot("p",Md," Standard chess phase: play normally from the custom starting position. All standard chess rules are enforced by the board. ")),pe("div",Od,[o.value?($e(),ot("p",Id,Ks(o.value),1)):Cs("",!0),i.value?($e(),ot("p",$d,Ks(i.value),1)):Cs("",!0)])]),pe("section",Nd,[R.value?($e(),qn($r(Co),{key:0,"board-config":L,"reactive-config":"",onBoardCreated:_e},null,8,["board-config"])):($e(),qn($r(Co),{key:1,"board-config":Z,"reactive-config":""},null,8,["board-config"]))])])]))}},Ld=vd(Rd,[["__scopeId","data-v-911de275"]]);su(Ld).mount("#app");
